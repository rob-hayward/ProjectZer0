import{w as a}from"./index.DspQOGsj.js";function l(){const{subscribe:t,set:e,update:h}=a(null);return{subscribe:t,setToken:o=>e(o),clearToken:()=>e(null),getToken:()=>{let o=null;return t(s=>{o=s})(),o}}}const c=l(),r=a(null),n="http://localhost:3000/api";function u(){window.location.href=`${n}/auth/login`}function g(){c.clearToken(),r.set(null),window.location.href=`${n}/auth/logout`}async function i(){try{console.log("Fetching user data from backend...");const t=await fetch(`${n}/auth/profile`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!t.ok){if(t.status===401)return console.log("User is not authenticated. Redirecting to login..."),u(),null;throw new Error(`Failed to fetch user data: ${t.statusText}`)}const e=await t.json();return console.log("User data received:",e),r.set(e),e}catch(t){return console.error("Error getting user data:",t),null}}async function f(){await i()}export{u as a,i as g,f as h,c as j,g as l,r as u};
