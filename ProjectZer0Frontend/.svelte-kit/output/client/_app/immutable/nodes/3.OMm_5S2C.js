var gs=Object.defineProperty;var ps=(e,t,n)=>t in e?gs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Re=(e,t,n)=>ps(e,typeof t!="symbol"?t+"":t,n);import{R as _s,g as mt}from"../chunks/entry.DQxgZDBP.js";import{j as ms,C as W,u as wn,a as vs,h as ws,g as ys,l as wr}from"../chunks/colors.rXsD7TVj.js";import{n as xe,A as Wt,s as Ne,Q as E,p as Te,R as N,b as w,f as g,v as f,i as z,h as _,S as tt,r as en,T as er,U as Oi,l as $t,u as Zt,m as Kt,o as Qt,e as ee,c as te,y as st,w as re,P as Ee,k as Ut,t as P,a as de,d as L,g as ge,j as ce,V as Fe,W as he,E as tr,X as _n,O as yt,G as bs,Y as yr,Z as Es,_ as Mo,$ as Ns,a0 as Is,a1 as Ss}from"../chunks/scheduler.B-0CXS5p.js";import{a as H,t as X,S as Ie,i as Se,g as bt,c as Et,b as se,d as ae,m as le,e as ue,f as mn}from"../chunks/index.Cd9iFXld.js";import{p as Rs}from"../chunks/stores.DOSMrAjX.js";import{w as Do}from"../chunks/index.BLBD6f_K.js";const xs=!0,ko=typeof window<"u";let br=ko?()=>window.performance.now():()=>Date.now(),Co=ko?e=>requestAnimationFrame(e):xe;const An=new Set;function Po(e){An.forEach(t=>{t.c(e)||(An.delete(t),t.f())}),An.size!==0&&Co(Po)}function As(e){let t;return An.size===0&&Co(Po),{promise:new Promise(n=>{An.add(t={c:e,f:n})}),abort(){An.delete(t)}}}const Ts=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Tt(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Os(e,t){H(e,1,1,()=>{t.delete(e.key)})}function Ms(e,t,n,i,r,o,s,l,a,u,c,p){let d=e.length,h=o.length,m=d;const v={};for(;m--;)v[e[m].key]=m;const I=[],y=new Map,b=new Map,x=[];for(m=h;m--;){const D=p(r,o,m),F=n(D);let q=s.get(F);q?x.push(()=>q.p(D,t)):(q=u(F,D),q.c()),y.set(F,I[m]=q),F in v&&b.set(F,Math.abs(m-v[F]))}const R=new Set,A=new Set;function S(D){X(D,1),D.m(l,c),s.set(D.key,D),c=D.first,h--}for(;d&&h;){const D=I[h-1],F=e[d-1],q=D.key,U=F.key;D===F?(c=D.first,d--,h--):y.has(U)?!s.has(q)||R.has(q)?S(D):A.has(U)?d--:b.get(q)>b.get(U)?(A.add(q),S(D)):(R.add(U),d--):(a(F,s),d--)}for(;d--;){const D=e[d];y.has(D.key)||a(D,s)}for(;h;)S(I[h-1]);return Wt(x),I}function Ds(e,t){const n={},i={},r={$$scope:1};let o=e.length;for(;o--;){const s=e[o],l=t[o];if(l){for(const a in s)a in l||(i[a]=1);for(const a in l)r[a]||(n[a]=l[a],r[a]=1);e[o]=l}else for(const a in s)r[a]=1}for(const s in i)s in n||(n[s]=void 0);return n}function ks(e){return typeof e=="object"&&e!==null?e:{}}const Er=xs;function Fi(e,t){throw new _s(e,t.toString())}new TextEncoder;const Cs="http://localhost:3000/api";async function Xe(e,t={}){const n=ms.getToken(),i={"Content-Type":"application/json",...t.headers};n&&(i.Authorization=`Bearer ${n}`);try{console.log(`Fetching ${e} with options:`,t);const r=await fetch(`${Cs}${e}`,{...t,headers:i,credentials:"include"});if(console.log("Fetch response:",r),!r.ok){const s=await r.text();throw console.error("Error response body:",s),new Error(`API call failed: ${r.status} ${r.statusText}, body: ${s}`)}const o=r.headers.get("content-type");if(o&&o.includes("application/json")){const s=await r.json();return console.log("JSON response:",s),s}else{const s=await r.text();return console.log("Text response:",s),s}}catch(r){throw console.error("Fetch error:",r),r}}async function Lo(e){try{if(!e)return console.warn("getWordData called with empty word"),null;console.log(`Fetching word data for: ${e}`);const t=encodeURIComponent(e.toLowerCase()),n=await Xe(`/nodes/word/${t}`);return console.log("Word data received:",n),n}catch(t){throw console.error("Error fetching word data:",t),t}}const Ps=!1,Ls=async({params:e,url:t})=>{console.log("=== PAGE LOAD START ==="),console.log("Raw params:",e),console.log("Raw URL:",t.toString()),console.log("URL params:",Object.fromEntries(t.searchParams)),console.log("View param:",e.view);const n=["dashboard","word","create-node","edit-profile","network","statement"],i=e.view;if(!i||!n.includes(i))throw console.log("View validation failed:",{view:i,isValid:n.includes(i),validViews:n}),console.log("Redirecting to dashboard..."),Fi(307,"/graph/dashboard");console.log("View validation passed:",i);let r=null;if(i==="word"){const s=t.searchParams.get("word");if(console.log("Processing word view:",{wordParam:s,view:i}),!s)throw console.warn("No word parameter found, redirecting to dashboard"),Fi(307,"/graph/dashboard");try{if(console.log("Loading word data for:",s),r=await Lo(s),!r)throw console.error("No word data found for:",s),new Error("No word data found");console.log("Word data loaded successfully:",r)}catch(l){throw console.error("Error loading word data:",l),Fi(307,"/graph/dashboard")}}const o={view:i,viewType:i,wordData:r};return console.log("=== PAGE LOAD COMPLETE ==="),console.log("Returning page data:",o),o},Dd=Object.freeze(Object.defineProperty({__proto__:null,load:Ls,ssr:Ps},Symbol.toStringTag,{value:"Module"}));async function Fs(){try{console.log("Fetching user activity...");const e=await Xe("/users/activity");return console.log("Received activity data:",e),e}catch(e){return console.error("Error fetching user activity:",e),{nodesCreated:0,votesCast:0,commentsMade:0}}}const Nr=290,B={SIZES:{DASHBOARD:{size:600},WORD:{preview:135,detail:600},DEFINITION:{live:{preview:320,detail:600},alternative:{preview:320,detail:600}}},STROKE:{preview:{normal:3,hover:6},detail:{normal:2,hover:3}},PADDING:{preview:10,detail:40},LINE_HEIGHT:{preview:16,detail:24},EFFECTS:{glow:{normal:{blur:5,strength:.6,spread:2},hover:{blur:8,strength:.8,spread:3}}},COLORS:{DASHBOARD:{background:`${W.PRIMARY.BLUE}33`,border:`${W.PRIMARY.BLUE}FF`,text:`${W.PRIMARY.BLUE}FF`,hover:`${W.PRIMARY.BLUE}FF`,gradient:{start:`${W.PRIMARY.BLUE}66`,end:`${W.PRIMARY.BLUE}33`}},WORD:{background:`${W.PRIMARY.BLUE}33`,border:`${W.PRIMARY.BLUE}FF`,text:`${W.PRIMARY.BLUE}FF`,hover:`${W.PRIMARY.BLUE}FF`,gradient:{start:`${W.PRIMARY.BLUE}66`,end:`${W.PRIMARY.BLUE}33`}},DEFINITION:{live:{background:`${W.PRIMARY.BLUE}33`,border:`${W.PRIMARY.BLUE}FF`,text:`${W.PRIMARY.BLUE}FF`,hover:`${W.PRIMARY.BLUE}FF`,gradient:{start:`${W.PRIMARY.BLUE}66`,end:`${W.PRIMARY.BLUE}33`}},alternative:{background:`${W.PRIMARY.PURPLE}33`,border:`${W.PRIMARY.PURPLE}FF`,text:`${W.PRIMARY.PURPLE}FF`,hover:`${W.PRIMARY.PURPLE}FF`,gradient:{start:`${W.PRIMARY.PURPLE}66`,end:`${W.PRIMARY.PURPLE}33`}}}},FONTS:{title:{family:"Orbitron",size:"12px",weight:"500"},value:{family:"Orbitron",size:"14px",weight:"300"},hover:{family:"Orbitron",size:"10px",weight:"400"},word:{family:"Orbitron",size:"14px",weight:"500"}},SVG:{filters:{glow:{deviation:3,strength:.5},hover:{deviation:5,strength:.7}},animation:{duration:"0.3s",easing:"ease-out"}}};var Vs={value:()=>{}};function Mi(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new vi(n)}function vi(e){this._=e}function zs(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}vi.prototype=Mi.prototype={constructor:vi,on:function(e,t){var n=this._,i=zs(e+"",n),r,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(e=i[o]).type)&&(r=Us(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(r=(e=i[o]).type)n[r]=Ir(n[r],e.name,t);else if(t==null)for(r in n)n[r]=Ir(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new vi(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],i=0,r=o.length;i<r;++i)o[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};function Us(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function Ir(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=Vs,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var Yi="http://www.w3.org/1999/xhtml";const Sr={svg:"http://www.w3.org/2000/svg",xhtml:Yi,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Di(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Sr.hasOwnProperty(t)?{space:Sr[t],local:e}:e}function Gs(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Yi&&t.documentElement.namespaceURI===Yi?t.createElement(e):t.createElementNS(n,e)}}function Ws(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Fo(e){var t=Di(e);return(t.local?Ws:Gs)(t)}function Bs(){}function nr(e){return e==null?Bs:function(){return this.querySelector(e)}}function Ys(e){typeof e!="function"&&(e=nr(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o=t[r],s=o.length,l=i[r]=new Array(s),a,u,c=0;c<s;++c)(a=o[c])&&(u=e.call(a,a.__data__,c,o))&&("__data__"in a&&(u.__data__=a.__data__),l[c]=u);return new et(i,this._parents)}function Xs(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Hs(){return[]}function Vo(e){return e==null?Hs:function(){return this.querySelectorAll(e)}}function js(e){return function(){return Xs(e.apply(this,arguments))}}function qs(e){typeof e=="function"?e=js(e):e=Vo(e);for(var t=this._groups,n=t.length,i=[],r=[],o=0;o<n;++o)for(var s=t[o],l=s.length,a,u=0;u<l;++u)(a=s[u])&&(i.push(e.call(a,a.__data__,u,s)),r.push(a));return new et(i,r)}function zo(e){return function(){return this.matches(e)}}function Uo(e){return function(t){return t.matches(e)}}var $s=Array.prototype.find;function Zs(e){return function(){return $s.call(this.children,e)}}function Ks(){return this.firstElementChild}function Qs(e){return this.select(e==null?Ks:Zs(typeof e=="function"?e:Uo(e)))}var Js=Array.prototype.filter;function ea(){return Array.from(this.children)}function ta(e){return function(){return Js.call(this.children,e)}}function na(e){return this.selectAll(e==null?ea:ta(typeof e=="function"?e:Uo(e)))}function ia(e){typeof e!="function"&&(e=zo(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o=t[r],s=o.length,l=i[r]=[],a,u=0;u<s;++u)(a=o[u])&&e.call(a,a.__data__,u,o)&&l.push(a);return new et(i,this._parents)}function Go(e){return new Array(e.length)}function ra(){return new et(this._enter||this._groups.map(Go),this._parents)}function Ei(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ei.prototype={constructor:Ei,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function oa(e){return function(){return e}}function sa(e,t,n,i,r,o){for(var s=0,l,a=t.length,u=o.length;s<u;++s)(l=t[s])?(l.__data__=o[s],i[s]=l):n[s]=new Ei(e,o[s]);for(;s<a;++s)(l=t[s])&&(r[s]=l)}function aa(e,t,n,i,r,o,s){var l,a,u=new Map,c=t.length,p=o.length,d=new Array(c),h;for(l=0;l<c;++l)(a=t[l])&&(d[l]=h=s.call(a,a.__data__,l,t)+"",u.has(h)?r[l]=a:u.set(h,a));for(l=0;l<p;++l)h=s.call(e,o[l],l,o)+"",(a=u.get(h))?(i[l]=a,a.__data__=o[l],u.delete(h)):n[l]=new Ei(e,o[l]);for(l=0;l<c;++l)(a=t[l])&&u.get(d[l])===a&&(r[l]=a)}function la(e){return e.__data__}function ua(e,t){if(!arguments.length)return Array.from(this,la);var n=t?aa:sa,i=this._parents,r=this._groups;typeof e!="function"&&(e=oa(e));for(var o=r.length,s=new Array(o),l=new Array(o),a=new Array(o),u=0;u<o;++u){var c=i[u],p=r[u],d=p.length,h=fa(e.call(c,c&&c.__data__,u,i)),m=h.length,v=l[u]=new Array(m),I=s[u]=new Array(m),y=a[u]=new Array(d);n(c,p,v,I,y,h,t);for(var b=0,x=0,R,A;b<m;++b)if(R=v[b]){for(b>=x&&(x=b+1);!(A=I[x])&&++x<m;);R._next=A||null}}return s=new et(s,i),s._enter=l,s._exit=a,s}function fa(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ca(){return new et(this._exit||this._groups.map(Go),this._parents)}function ha(e,t,n){var i=this.enter(),r=this,o=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?o.remove():n(o),i&&r?i.merge(r).order():r}function da(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,r=n.length,o=i.length,s=Math.min(r,o),l=new Array(r),a=0;a<s;++a)for(var u=n[a],c=i[a],p=u.length,d=l[a]=new Array(p),h,m=0;m<p;++m)(h=u[m]||c[m])&&(d[m]=h);for(;a<r;++a)l[a]=n[a];return new et(l,this._parents)}function ga(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i=e[t],r=i.length-1,o=i[r],s;--r>=0;)(s=i[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function pa(e){e||(e=_a);function t(p,d){return p&&d?e(p.__data__,d.__data__):!p-!d}for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s=n[o],l=s.length,a=r[o]=new Array(l),u,c=0;c<l;++c)(u=s[c])&&(a[c]=u);a.sort(t)}return new et(r,this._parents).order()}function _a(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ma(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function va(){return Array.from(this)}function wa(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null}function ya(){let e=0;for(const t of this)++e;return e}function ba(){return!this.node()}function Ea(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var r=t[n],o=0,s=r.length,l;o<s;++o)(l=r[o])&&e.call(l,l.__data__,o,r);return this}function Na(e){return function(){this.removeAttribute(e)}}function Ia(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Sa(e,t){return function(){this.setAttribute(e,t)}}function Ra(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function xa(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Aa(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Ta(e,t){var n=Di(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((t==null?n.local?Ia:Na:typeof t=="function"?n.local?Aa:xa:n.local?Ra:Sa)(n,t))}function Wo(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Oa(e){return function(){this.style.removeProperty(e)}}function Ma(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Da(e,t,n){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function ka(e,t,n){return arguments.length>1?this.each((t==null?Oa:typeof t=="function"?Da:Ma)(e,t,n??"")):On(this.node(),e)}function On(e,t){return e.style.getPropertyValue(t)||Wo(e).getComputedStyle(e,null).getPropertyValue(t)}function Ca(e){return function(){delete this[e]}}function Pa(e,t){return function(){this[e]=t}}function La(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Fa(e,t){return arguments.length>1?this.each((t==null?Ca:typeof t=="function"?La:Pa)(e,t)):this.node()[e]}function Bo(e){return e.trim().split(/^|\s+/)}function ir(e){return e.classList||new Yo(e)}function Yo(e){this._node=e,this._names=Bo(e.getAttribute("class")||"")}Yo.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Xo(e,t){for(var n=ir(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function Ho(e,t){for(var n=ir(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function Va(e){return function(){Xo(this,e)}}function za(e){return function(){Ho(this,e)}}function Ua(e,t){return function(){(t.apply(this,arguments)?Xo:Ho)(this,e)}}function Ga(e,t){var n=Bo(e+"");if(arguments.length<2){for(var i=ir(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?Ua:t?Va:za)(n,t))}function Wa(){this.textContent=""}function Ba(e){return function(){this.textContent=e}}function Ya(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Xa(e){return arguments.length?this.each(e==null?Wa:(typeof e=="function"?Ya:Ba)(e)):this.node().textContent}function Ha(){this.innerHTML=""}function ja(e){return function(){this.innerHTML=e}}function qa(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function $a(e){return arguments.length?this.each(e==null?Ha:(typeof e=="function"?qa:ja)(e)):this.node().innerHTML}function Za(){this.nextSibling&&this.parentNode.appendChild(this)}function Ka(){return this.each(Za)}function Qa(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ja(){return this.each(Qa)}function el(e){var t=typeof e=="function"?e:Fo(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function tl(){return null}function nl(e,t){var n=typeof e=="function"?e:Fo(e),i=t==null?tl:typeof t=="function"?t:nr(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function il(){var e=this.parentNode;e&&e.removeChild(this)}function rl(){return this.each(il)}function ol(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function sl(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function al(e){return this.select(e?sl:ol)}function ll(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ul(e){return function(t){e.call(this,t,this.__data__)}}function fl(e){return e.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");return i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),{type:t,name:n}})}function cl(e){return function(){var t=this.__on;if(t){for(var n=0,i=-1,r=t.length,o;n<r;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++i]=o;++i?t.length=i:delete this.__on}}}function hl(e,t,n){return function(){var i=this.__on,r,o=ul(t);if(i){for(var s=0,l=i.length;s<l;++s)if((r=i[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=t;return}}this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function dl(e,t,n){var i=fl(e+""),r,o=i.length,s;if(arguments.length<2){var l=this.node().__on;if(l){for(var a=0,u=l.length,c;a<u;++a)for(r=0,c=l[a];r<o;++r)if((s=i[r]).type===c.type&&s.name===c.name)return c.value}return}for(l=t?hl:cl,r=0;r<o;++r)this.each(l(i[r],t,n));return this}function jo(e,t,n){var i=Wo(e),r=i.CustomEvent;typeof r=="function"?r=new r(t,n):(r=i.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function gl(e,t){return function(){return jo(this,e,t)}}function pl(e,t){return function(){return jo(this,e,t.apply(this,arguments))}}function _l(e,t){return this.each((typeof t=="function"?pl:gl)(e,t))}function*ml(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length,s;r<o;++r)(s=i[r])&&(yield s)}var qo=[null];function et(e,t){this._groups=e,this._parents=t}function oi(){return new et([[document.documentElement]],qo)}function vl(){return this}et.prototype=oi.prototype={constructor:et,select:Ys,selectAll:qs,selectChild:Qs,selectChildren:na,filter:ia,data:ua,enter:ra,exit:ca,join:ha,merge:da,selection:vl,order:ga,sort:pa,call:ma,nodes:va,node:wa,size:ya,empty:ba,each:Ea,attr:Ta,style:ka,property:Fa,classed:Ga,text:Xa,html:$a,raise:Ka,lower:Ja,append:el,insert:nl,remove:rl,clone:al,datum:ll,on:dl,dispatch:_l,[Symbol.iterator]:ml};function vt(e){return typeof e=="string"?new et([[document.querySelector(e)]],[document.documentElement]):new et([[e]],qo)}function wl(e){let t;for(;t=e.sourceEvent;)e=t;return e}function gn(e,t){if(e=wl(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const Xi={capture:!0,passive:!1};function Hi(e){e.preventDefault(),e.stopImmediatePropagation()}function yl(e){var t=e.document.documentElement,n=vt(e).on("dragstart.drag",Hi,Xi);"onselectstart"in t?n.on("selectstart.drag",Hi,Xi):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function bl(e,t){var n=e.document.documentElement,i=vt(e).on("dragstart.drag",null);t&&(i.on("click.drag",Hi,Xi),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function rr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function $o(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function si(){}var ei=.7,Ni=1/ei,Tn="\\s*([+-]?\\d+)\\s*",ti="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",At="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",El=/^#([0-9a-f]{3,8})$/,Nl=new RegExp(`^rgb\\(${Tn},${Tn},${Tn}\\)$`),Il=new RegExp(`^rgb\\(${At},${At},${At}\\)$`),Sl=new RegExp(`^rgba\\(${Tn},${Tn},${Tn},${ti}\\)$`),Rl=new RegExp(`^rgba\\(${At},${At},${At},${ti}\\)$`),xl=new RegExp(`^hsl\\(${ti},${At},${At}\\)$`),Al=new RegExp(`^hsla\\(${ti},${At},${At},${ti}\\)$`),Rr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};rr(si,ni,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:xr,formatHex:xr,formatHex8:Tl,formatHsl:Ol,formatRgb:Ar,toString:Ar});function xr(){return this.rgb().formatHex()}function Tl(){return this.rgb().formatHex8()}function Ol(){return Zo(this).formatHsl()}function Ar(){return this.rgb().formatRgb()}function ni(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=El.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Tr(t):n===3?new je(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ci(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ci(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Nl.exec(e))?new je(t[1],t[2],t[3],1):(t=Il.exec(e))?new je(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Sl.exec(e))?ci(t[1],t[2],t[3],t[4]):(t=Rl.exec(e))?ci(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=xl.exec(e))?Dr(t[1],t[2]/100,t[3]/100,1):(t=Al.exec(e))?Dr(t[1],t[2]/100,t[3]/100,t[4]):Rr.hasOwnProperty(e)?Tr(Rr[e]):e==="transparent"?new je(NaN,NaN,NaN,0):null}function Tr(e){return new je(e>>16&255,e>>8&255,e&255,1)}function ci(e,t,n,i){return i<=0&&(e=t=n=NaN),new je(e,t,n,i)}function Ml(e){return e instanceof si||(e=ni(e)),e?(e=e.rgb(),new je(e.r,e.g,e.b,e.opacity)):new je}function ji(e,t,n,i){return arguments.length===1?Ml(e):new je(e,t,n,i??1)}function je(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}rr(je,ji,$o(si,{brighter(e){return e=e==null?Ni:Math.pow(Ni,e),new je(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ei:Math.pow(ei,e),new je(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new je(vn(this.r),vn(this.g),vn(this.b),Ii(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Or,formatHex:Or,formatHex8:Dl,formatRgb:Mr,toString:Mr}));function Or(){return`#${pn(this.r)}${pn(this.g)}${pn(this.b)}`}function Dl(){return`#${pn(this.r)}${pn(this.g)}${pn(this.b)}${pn((isNaN(this.opacity)?1:this.opacity)*255)}`}function Mr(){const e=Ii(this.opacity);return`${e===1?"rgb(":"rgba("}${vn(this.r)}, ${vn(this.g)}, ${vn(this.b)}${e===1?")":`, ${e})`}`}function Ii(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function pn(e){return e=vn(e),(e<16?"0":"")+e.toString(16)}function Dr(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new wt(e,t,n,i)}function Zo(e){if(e instanceof wt)return new wt(e.h,e.s,e.l,e.opacity);if(e instanceof si||(e=ni(e)),!e)return new wt;if(e instanceof wt)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,l=o-r,a=(o+r)/2;return l?(t===o?s=(n-i)/l+(n<i)*6:n===o?s=(i-t)/l+2:s=(t-n)/l+4,l/=a<.5?o+r:2-o-r,s*=60):l=a>0&&a<1?0:s,new wt(s,l,a,e.opacity)}function kl(e,t,n,i){return arguments.length===1?Zo(e):new wt(e,t,n,i??1)}function wt(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}rr(wt,kl,$o(si,{brighter(e){return e=e==null?Ni:Math.pow(Ni,e),new wt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ei:Math.pow(ei,e),new wt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new je(Vi(e>=240?e-240:e+120,r,i),Vi(e,r,i),Vi(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new wt(kr(this.h),hi(this.s),hi(this.l),Ii(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ii(this.opacity);return`${e===1?"hsl(":"hsla("}${kr(this.h)}, ${hi(this.s)*100}%, ${hi(this.l)*100}%${e===1?")":`, ${e})`}`}}));function kr(e){return e=(e||0)%360,e<0?e+360:e}function hi(e){return Math.max(0,Math.min(1,e||0))}function Vi(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Ko=e=>()=>e;function Cl(e,t){return function(n){return e+n*t}}function Pl(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function Ll(e){return(e=+e)==1?Qo:function(t,n){return n-t?Pl(t,n,e):Ko(isNaN(t)?n:t)}}function Qo(e,t){var n=t-e;return n?Cl(e,n):Ko(isNaN(e)?t:e)}const Cr=function e(t){var n=Ll(t);function i(r,o){var s=n((r=ji(r)).r,(o=ji(o)).r),l=n(r.g,o.g),a=n(r.b,o.b),u=Qo(r.opacity,o.opacity);return function(c){return r.r=s(c),r.g=l(c),r.b=a(c),r.opacity=u(c),r+""}}return i.gamma=e,i}(1);function qt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var qi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zi=new RegExp(qi.source,"g");function Fl(e){return function(){return e}}function Vl(e){return function(t){return e(t)+""}}function zl(e,t){var n=qi.lastIndex=zi.lastIndex=0,i,r,o,s=-1,l=[],a=[];for(e=e+"",t=t+"";(i=qi.exec(e))&&(r=zi.exec(t));)(o=r.index)>n&&(o=t.slice(n,o),l[s]?l[s]+=o:l[++s]=o),(i=i[0])===(r=r[0])?l[s]?l[s]+=r:l[++s]=r:(l[++s]=null,a.push({i:s,x:qt(i,r)})),n=zi.lastIndex;return n<t.length&&(o=t.slice(n),l[s]?l[s]+=o:l[++s]=o),l.length<2?a[0]?Vl(a[0].x):Fl(t):(t=a.length,function(u){for(var c=0,p;c<t;++c)l[(p=a[c]).i]=p.x(u);return l.join("")})}var Pr=180/Math.PI,$i={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Jo(e,t,n,i,r,o){var s,l,a;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(a=e*n+t*i)&&(n-=e*a,i-=t*a),(l=Math.sqrt(n*n+i*i))&&(n/=l,i/=l,a/=l),e*i<t*n&&(e=-e,t=-t,a=-a,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*Pr,skewX:Math.atan(a)*Pr,scaleX:s,scaleY:l}}var di;function Ul(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?$i:Jo(t.a,t.b,t.c,t.d,t.e,t.f)}function Gl(e){return e==null||(di||(di=document.createElementNS("http://www.w3.org/2000/svg","g")),di.setAttribute("transform",e),!(e=di.transform.baseVal.consolidate()))?$i:(e=e.matrix,Jo(e.a,e.b,e.c,e.d,e.e,e.f))}function es(e,t,n,i){function r(u){return u.length?u.pop()+" ":""}function o(u,c,p,d,h,m){if(u!==p||c!==d){var v=h.push("translate(",null,t,null,n);m.push({i:v-4,x:qt(u,p)},{i:v-2,x:qt(c,d)})}else(p||d)&&h.push("translate("+p+t+d+n)}function s(u,c,p,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:p.push(r(p)+"rotate(",null,i)-2,x:qt(u,c)})):c&&p.push(r(p)+"rotate("+c+i)}function l(u,c,p,d){u!==c?d.push({i:p.push(r(p)+"skewX(",null,i)-2,x:qt(u,c)}):c&&p.push(r(p)+"skewX("+c+i)}function a(u,c,p,d,h,m){if(u!==p||c!==d){var v=h.push(r(h)+"scale(",null,",",null,")");m.push({i:v-4,x:qt(u,p)},{i:v-2,x:qt(c,d)})}else(p!==1||d!==1)&&h.push(r(h)+"scale("+p+","+d+")")}return function(u,c){var p=[],d=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,p,d),s(u.rotate,c.rotate,p,d),l(u.skewX,c.skewX,p,d),a(u.scaleX,u.scaleY,c.scaleX,c.scaleY,p,d),u=c=null,function(h){for(var m=-1,v=d.length,I;++m<v;)p[(I=d[m]).i]=I.x(h);return p.join("")}}}var Wl=es(Ul,"px, ","px)","deg)"),Bl=es(Gl,", ",")",")"),Yl=1e-12;function Lr(e){return((e=Math.exp(e))+1/e)/2}function Xl(e){return((e=Math.exp(e))-1/e)/2}function Hl(e){return((e=Math.exp(2*e))-1)/(e+1)}const jl=function e(t,n,i){function r(o,s){var l=o[0],a=o[1],u=o[2],c=s[0],p=s[1],d=s[2],h=c-l,m=p-a,v=h*h+m*m,I,y;if(v<Yl)y=Math.log(d/u)/t,I=function(D){return[l+D*h,a+D*m,u*Math.exp(t*D*y)]};else{var b=Math.sqrt(v),x=(d*d-u*u+i*v)/(2*u*n*b),R=(d*d-u*u-i*v)/(2*d*n*b),A=Math.log(Math.sqrt(x*x+1)-x),S=Math.log(Math.sqrt(R*R+1)-R);y=(S-A)/t,I=function(D){var F=D*y,q=Lr(A),U=u/(n*b)*(q*Hl(t*F+A)-Xl(A));return[l+U*h,a+U*m,u*q/Lr(t*F+A)]}}return I.duration=y*1e3*t/Math.SQRT2,I}return r.rho=function(o){var s=Math.max(.001,+o),l=s*s,a=l*l;return e(s,l,a)},r}(Math.SQRT2,2,4);var Mn=0,Qn=0,Zn=0,ts=1e3,Si,Jn,Ri=0,yn=0,ki=0,ii=typeof performance=="object"&&performance.now?performance:Date,ns=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function or(){return yn||(ns(ql),yn=ii.now()+ki)}function ql(){yn=0}function xi(){this._call=this._time=this._next=null}xi.prototype=sr.prototype={constructor:xi,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?or():+n)+(t==null?0:+t),!this._next&&Jn!==this&&(Jn?Jn._next=this:Si=this,Jn=this),this._call=e,this._time=n,Zi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Zi())}};function sr(e,t,n){var i=new xi;return i.restart(e,t,n),i}function $l(){or(),++Mn;for(var e=Si,t;e;)(t=yn-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Mn}function Fr(){yn=(Ri=ii.now())+ki,Mn=Qn=0;try{$l()}finally{Mn=0,Kl(),yn=0}}function Zl(){var e=ii.now(),t=e-Ri;t>ts&&(ki-=t,Ri=e)}function Kl(){for(var e,t=Si,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Si=n);Jn=e,Zi(i)}function Zi(e){if(!Mn){Qn&&(Qn=clearTimeout(Qn));var t=e-yn;t>24?(e<1/0&&(Qn=setTimeout(Fr,e-ii.now()-ki)),Zn&&(Zn=clearInterval(Zn))):(Zn||(Ri=ii.now(),Zn=setInterval(Zl,ts)),Mn=1,ns(Fr))}}function Vr(e,t,n){var i=new xi;return t=t==null?0:+t,i.restart(r=>{i.stop(),e(r+t)},t,n),i}var Ql=Mi("start","end","cancel","interrupt"),Jl=[],is=0,zr=1,Ki=2,wi=3,Ur=4,Qi=5,yi=6;function Ci(e,t,n,i,r,o){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;eu(e,n,{name:t,index:i,group:r,on:Ql,tween:Jl,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:is})}function ar(e,t){var n=Nt(e,t);if(n.state>is)throw new Error("too late; already scheduled");return n}function Ot(e,t){var n=Nt(e,t);if(n.state>wi)throw new Error("too late; already running");return n}function Nt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function eu(e,t,n){var i=e.__transition,r;i[t]=n,n.timer=sr(o,0,n.time);function o(u){n.state=zr,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var c,p,d,h;if(n.state!==zr)return a();for(c in i)if(h=i[c],h.name===n.name){if(h.state===wi)return Vr(s);h.state===Ur?(h.state=yi,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete i[c]):+c<t&&(h.state=yi,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete i[c])}if(Vr(function(){n.state===wi&&(n.state=Ur,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=Ki,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Ki){for(n.state=wi,r=new Array(d=n.tween.length),c=0,p=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++p]=h);r.length=p+1}}function l(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(a),n.state=Qi,1),p=-1,d=r.length;++p<d;)r[p].call(e,c);n.state===Qi&&(n.on.call("end",e,e.__data__,n.index,n.group),a())}function a(){n.state=yi,n.timer.stop(),delete i[t];for(var u in i)return;delete e.__transition}}function bi(e,t){var n=e.__transition,i,r,o=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((i=n[s]).name!==t){o=!1;continue}r=i.state>Ki&&i.state<Qi,i.state=yi,i.timer.stop(),i.on.call(r?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete n[s]}o&&delete e.__transition}}function tu(e){return this.each(function(){bi(this,e)})}function nu(e,t){var n,i;return function(){var r=Ot(this,e),o=r.tween;if(o!==n){i=n=o;for(var s=0,l=i.length;s<l;++s)if(i[s].name===t){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function iu(e,t,n){var i,r;if(typeof n!="function")throw new Error;return function(){var o=Ot(this,e),s=o.tween;if(s!==i){r=(i=s).slice();for(var l={name:t,value:n},a=0,u=r.length;a<u;++a)if(r[a].name===t){r[a]=l;break}a===u&&r.push(l)}o.tween=r}}function ru(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i=Nt(this.node(),n).tween,r=0,o=i.length,s;r<o;++r)if((s=i[r]).name===e)return s.value;return null}return this.each((t==null?nu:iu)(n,e,t))}function lr(e,t,n){var i=e._id;return e.each(function(){var r=Ot(this,i);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return Nt(r,i).value[t]}}function rs(e,t){var n;return(typeof t=="number"?qt:t instanceof ni?Cr:(n=ni(t))?(t=n,Cr):zl)(e,t)}function ou(e){return function(){this.removeAttribute(e)}}function su(e){return function(){this.removeAttributeNS(e.space,e.local)}}function au(e,t,n){var i,r=n+"",o;return function(){var s=this.getAttribute(e);return s===r?null:s===i?o:o=t(i=s,n)}}function lu(e,t,n){var i,r=n+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===i?o:o=t(i=s,n)}}function uu(e,t,n){var i,r,o;return function(){var s,l=n(this),a;return l==null?void this.removeAttribute(e):(s=this.getAttribute(e),a=l+"",s===a?null:s===i&&a===r?o:(r=a,o=t(i=s,l)))}}function fu(e,t,n){var i,r,o;return function(){var s,l=n(this),a;return l==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),a=l+"",s===a?null:s===i&&a===r?o:(r=a,o=t(i=s,l)))}}function cu(e,t){var n=Di(e),i=n==="transform"?Bl:rs;return this.attrTween(e,typeof t=="function"?(n.local?fu:uu)(n,i,lr(this,"attr."+e,t)):t==null?(n.local?su:ou)(n):(n.local?lu:au)(n,i,t))}function hu(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function du(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function gu(e,t){var n,i;function r(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&du(e,o)),n}return r._value=t,r}function pu(e,t){var n,i;function r(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&hu(e,o)),n}return r._value=t,r}function _u(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var i=Di(e);return this.tween(n,(i.local?gu:pu)(i,t))}function mu(e,t){return function(){ar(this,e).delay=+t.apply(this,arguments)}}function vu(e,t){return t=+t,function(){ar(this,e).delay=t}}function wu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?mu:vu)(t,e)):Nt(this.node(),t).delay}function yu(e,t){return function(){Ot(this,e).duration=+t.apply(this,arguments)}}function bu(e,t){return t=+t,function(){Ot(this,e).duration=t}}function Eu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?yu:bu)(t,e)):Nt(this.node(),t).duration}function Nu(e,t){if(typeof t!="function")throw new Error;return function(){Ot(this,e).ease=t}}function Iu(e){var t=this._id;return arguments.length?this.each(Nu(t,e)):Nt(this.node(),t).ease}function Su(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ot(this,e).ease=n}}function Ru(e){if(typeof e!="function")throw new Error;return this.each(Su(this._id,e))}function xu(e){typeof e!="function"&&(e=zo(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o=t[r],s=o.length,l=i[r]=[],a,u=0;u<s;++u)(a=o[u])&&e.call(a,a.__data__,u,o)&&l.push(a);return new Gt(i,this._parents,this._name,this._id)}function Au(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,i=t.length,r=n.length,o=Math.min(i,r),s=new Array(i),l=0;l<o;++l)for(var a=t[l],u=n[l],c=a.length,p=s[l]=new Array(c),d,h=0;h<c;++h)(d=a[h]||u[h])&&(p[h]=d);for(;l<i;++l)s[l]=t[l];return new Gt(s,this._parents,this._name,this._id)}function Tu(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Ou(e,t,n){var i,r,o=Tu(t)?ar:Ot;return function(){var s=o(this,e),l=s.on;l!==i&&(r=(i=l).copy()).on(t,n),s.on=r}}function Mu(e,t){var n=this._id;return arguments.length<2?Nt(this.node(),n).on.on(e):this.each(Ou(n,e,t))}function Du(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function ku(){return this.on("end.remove",Du(this._id))}function Cu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=nr(e));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var l=i[s],a=l.length,u=o[s]=new Array(a),c,p,d=0;d<a;++d)(c=l[d])&&(p=e.call(c,c.__data__,d,l))&&("__data__"in c&&(p.__data__=c.__data__),u[d]=p,Ci(u[d],t,n,d,u,Nt(c,n)));return new Gt(o,this._parents,t,n)}function Pu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Vo(e));for(var i=this._groups,r=i.length,o=[],s=[],l=0;l<r;++l)for(var a=i[l],u=a.length,c,p=0;p<u;++p)if(c=a[p]){for(var d=e.call(c,c.__data__,p,a),h,m=Nt(c,n),v=0,I=d.length;v<I;++v)(h=d[v])&&Ci(h,t,n,v,d,m);o.push(d),s.push(c)}return new Gt(o,s,t,n)}var Lu=oi.prototype.constructor;function Fu(){return new Lu(this._groups,this._parents)}function Vu(e,t){var n,i,r;return function(){var o=On(this,e),s=(this.style.removeProperty(e),On(this,e));return o===s?null:o===n&&s===i?r:r=t(n=o,i=s)}}function os(e){return function(){this.style.removeProperty(e)}}function zu(e,t,n){var i,r=n+"",o;return function(){var s=On(this,e);return s===r?null:s===i?o:o=t(i=s,n)}}function Uu(e,t,n){var i,r,o;return function(){var s=On(this,e),l=n(this),a=l+"";return l==null&&(a=l=(this.style.removeProperty(e),On(this,e))),s===a?null:s===i&&a===r?o:(r=a,o=t(i=s,l))}}function Gu(e,t){var n,i,r,o="style."+t,s="end."+o,l;return function(){var a=Ot(this,e),u=a.on,c=a.value[o]==null?l||(l=os(t)):void 0;(u!==n||r!==c)&&(i=(n=u).copy()).on(s,r=c),a.on=i}}function Wu(e,t,n){var i=(e+="")=="transform"?Wl:rs;return t==null?this.styleTween(e,Vu(e,i)).on("end.style."+e,os(e)):typeof t=="function"?this.styleTween(e,Uu(e,i,lr(this,"style."+e,t))).each(Gu(this._id,e)):this.styleTween(e,zu(e,i,t),n).on("end.style."+e,null)}function Bu(e,t,n){return function(i){this.style.setProperty(e,t.call(this,i),n)}}function Yu(e,t,n){var i,r;function o(){var s=t.apply(this,arguments);return s!==r&&(i=(r=s)&&Bu(e,s,n)),i}return o._value=t,o}function Xu(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,Yu(e,t,n??""))}function Hu(e){return function(){this.textContent=e}}function ju(e){return function(){var t=e(this);this.textContent=t??""}}function qu(e){return this.tween("text",typeof e=="function"?ju(lr(this,"text",e)):Hu(e==null?"":e+""))}function $u(e){return function(t){this.textContent=e.call(this,t)}}function Zu(e){var t,n;function i(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&$u(r)),t}return i._value=e,i}function Ku(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Zu(e))}function Qu(){for(var e=this._name,t=this._id,n=ss(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],l=s.length,a,u=0;u<l;++u)if(a=s[u]){var c=Nt(a,t);Ci(a,e,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Gt(i,this._parents,e,n)}function Ju(){var e,t,n=this,i=n._id,r=n.size();return new Promise(function(o,s){var l={value:s},a={value:function(){--r===0&&o()}};n.each(function(){var u=Ot(this,i),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(a)),u.on=t}),r===0&&o()})}var ef=0;function Gt(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function ss(){return++ef}var Lt=oi.prototype;Gt.prototype={constructor:Gt,select:Cu,selectAll:Pu,selectChild:Lt.selectChild,selectChildren:Lt.selectChildren,filter:xu,merge:Au,selection:Fu,transition:Qu,call:Lt.call,nodes:Lt.nodes,node:Lt.node,size:Lt.size,empty:Lt.empty,each:Lt.each,on:Mu,attr:cu,attrTween:_u,style:Wu,styleTween:Xu,text:qu,textTween:Ku,remove:ku,tween:ru,delay:wu,duration:Eu,ease:Iu,easeVarying:Ru,end:Ju,[Symbol.iterator]:Lt[Symbol.iterator]};function tf(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var nf={time:null,delay:0,duration:250,ease:tf};function rf(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function of(e){var t,n;e instanceof Gt?(t=e._id,e=e._name):(t=ss(),(n=nf).time=or(),e=e==null?null:e+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],l=s.length,a,u=0;u<l;++u)(a=s[u])&&Ci(a,e,t,u,s,n||rf(a,t));return new Gt(i,this._parents,e,t)}oi.prototype.interrupt=tu;oi.prototype.transition=of;function sf(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return as(this.cover(t,n),t,n,e)}function as(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,o=e._root,s={data:i},l=e._x0,a=e._y0,u=e._x1,c=e._y1,p,d,h,m,v,I,y,b;if(!o)return e._root=s,e;for(;o.length;)if((v=t>=(p=(l+u)/2))?l=p:u=p,(I=n>=(d=(a+c)/2))?a=d:c=d,r=o,!(o=o[y=I<<1|v]))return r[y]=s,e;if(h=+e._x.call(null,o.data),m=+e._y.call(null,o.data),t===h&&n===m)return s.next=o,r?r[y]=s:e._root=s,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(v=t>=(p=(l+u)/2))?l=p:u=p,(I=n>=(d=(a+c)/2))?a=d:c=d;while((y=I<<1|v)===(b=(m>=d)<<1|h>=p));return r[b]=o,r[y]=s,e}function af(e){var t,n,i=e.length,r,o,s=new Array(i),l=new Array(i),a=1/0,u=1/0,c=-1/0,p=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=r,l[n]=o,r<a&&(a=r),r>c&&(c=r),o<u&&(u=o),o>p&&(p=o));if(a>c||u>p)return this;for(this.cover(a,u).cover(c,p),n=0;n<i;++n)as(this,s[n],l[n],e[n]);return this}function lf(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1;else{for(var s=r-n||1,l=this._root,a,u;n>e||e>=r||i>t||t>=o;)switch(u=(t<i)<<1|e<n,a=new Array(4),a[u]=l,l=a,s*=2,u){case 0:r=n+s,o=i+s;break;case 1:n=r-s,o=i+s;break;case 2:r=n+s,i=o-s;break;case 3:n=r-s,i=o-s;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this}function uf(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function ff(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Ye(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function cf(e,t,n){var i,r=this._x0,o=this._y0,s,l,a,u,c=this._x1,p=this._y1,d=[],h=this._root,m,v;for(h&&d.push(new Ye(h,r,o,c,p)),n==null?n=1/0:(r=e-n,o=t-n,c=e+n,p=t+n,n*=n);m=d.pop();)if(!(!(h=m.node)||(s=m.x0)>c||(l=m.y0)>p||(a=m.x1)<r||(u=m.y1)<o))if(h.length){var I=(s+a)/2,y=(l+u)/2;d.push(new Ye(h[3],I,y,a,u),new Ye(h[2],s,y,I,u),new Ye(h[1],I,l,a,y),new Ye(h[0],s,l,I,y)),(v=(t>=y)<<1|e>=I)&&(m=d[d.length-1],d[d.length-1]=d[d.length-1-v],d[d.length-1-v]=m)}else{var b=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),R=b*b+x*x;if(R<n){var A=Math.sqrt(n=R);r=e-A,o=t-A,c=e+A,p=t+A,i=h.data}}return i}function hf(e){if(isNaN(c=+this._x.call(null,e))||isNaN(p=+this._y.call(null,e)))return this;var t,n=this._root,i,r,o,s=this._x0,l=this._y0,a=this._x1,u=this._y1,c,p,d,h,m,v,I,y;if(!n)return this;if(n.length)for(;;){if((m=c>=(d=(s+a)/2))?s=d:a=d,(v=p>=(h=(l+u)/2))?l=h:u=h,t=n,!(n=n[I=v<<1|m]))return this;if(!n.length)break;(t[I+1&3]||t[I+2&3]||t[I+3&3])&&(i=t,y=I)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,r?(o?r.next=o:delete r.next,this):t?(o?t[I]=o:delete t[I],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=o,this)}function df(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function gf(){return this._root}function pf(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function _f(e){var t=[],n,i=this._root,r,o,s,l,a;for(i&&t.push(new Ye(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,o=n.x0,s=n.y0,l=n.x1,a=n.y1)&&i.length){var u=(o+l)/2,c=(s+a)/2;(r=i[3])&&t.push(new Ye(r,u,c,l,a)),(r=i[2])&&t.push(new Ye(r,o,c,u,a)),(r=i[1])&&t.push(new Ye(r,u,s,l,c)),(r=i[0])&&t.push(new Ye(r,o,s,u,c))}return this}function mf(e){var t=[],n=[],i;for(this._root&&t.push(new Ye(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var o,s=i.x0,l=i.y0,a=i.x1,u=i.y1,c=(s+a)/2,p=(l+u)/2;(o=r[0])&&t.push(new Ye(o,s,l,c,p)),(o=r[1])&&t.push(new Ye(o,c,l,a,p)),(o=r[2])&&t.push(new Ye(o,s,p,c,u)),(o=r[3])&&t.push(new Ye(o,c,p,a,u))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function vf(e){return e[0]}function wf(e){return arguments.length?(this._x=e,this):this._x}function yf(e){return e[1]}function bf(e){return arguments.length?(this._y=e,this):this._y}function ur(e,t,n){var i=new fr(t??vf,n??yf,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function fr(e,t,n,i,r,o){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function Gr(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var He=ur.prototype=fr.prototype;He.copy=function(){var e=new fr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=Gr(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=Gr(i));return e};He.add=sf;He.addAll=af;He.cover=lf;He.data=uf;He.extent=ff;He.find=cf;He.remove=hf;He.removeAll=df;He.root=gf;He.size=pf;He.visit=_f;He.visitAfter=mf;He.x=wf;He.y=bf;function Jt(e){return function(){return e}}function xn(e){return(e()-.5)*1e-6}function Ef(e){return e.x+e.vx}function Nf(e){return e.y+e.vy}function If(e){var t,n,i,r=1,o=1;typeof e!="function"&&(e=Jt(e==null?1:+e));function s(){for(var u,c=t.length,p,d,h,m,v,I,y=0;y<o;++y)for(p=ur(t,Ef,Nf).visitAfter(l),u=0;u<c;++u)d=t[u],v=n[d.index],I=v*v,h=d.x+d.vx,m=d.y+d.vy,p.visit(b);function b(x,R,A,S,D){var F=x.data,q=x.r,U=v+q;if(F){if(F.index>d.index){var $=h-F.x-F.vx,V=m-F.y-F.vy,j=$*$+V*V;j<U*U&&($===0&&($=xn(i),j+=$*$),V===0&&(V=xn(i),j+=V*V),j=(U-(j=Math.sqrt(j)))/j*r,d.vx+=($*=j)*(U=(q*=q)/(I+q)),d.vy+=(V*=j)*U,F.vx-=$*(U=1-U),F.vy-=V*U)}return}return R>h+U||S<h-U||A>m+U||D<m-U}}function l(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function a(){if(t){var u,c=t.length,p;for(n=new Array(c),u=0;u<c;++u)p=t[u],n[p.index]=+e(p,u,t)}}return s.initialize=function(u,c){t=u,i=c,a()},s.iterations=function(u){return arguments.length?(o=+u,s):o},s.strength=function(u){return arguments.length?(r=+u,s):r},s.radius=function(u){return arguments.length?(e=typeof u=="function"?u:Jt(+u),a(),s):e},s}const Sf=1664525,Rf=1013904223,Wr=4294967296;function xf(){let e=1;return()=>(e=(Sf*e+Rf)%Wr)/Wr}function Af(e){return e.x}function Tf(e){return e.y}var Of=10,Mf=Math.PI*(3-Math.sqrt(5));function Df(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,l=new Map,a=sr(p),u=Mi("tick","end"),c=xf();e==null&&(e=[]);function p(){d(),u.call("tick",t),n<i&&(a.stop(),u.call("end",t))}function d(v){var I,y=e.length,b;v===void 0&&(v=1);for(var x=0;x<v;++x)for(n+=(o-n)*r,l.forEach(function(R){R(n)}),I=0;I<y;++I)b=e[I],b.fx==null?b.x+=b.vx*=s:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=s:(b.y=b.fy,b.vy=0);return t}function h(){for(var v=0,I=e.length,y;v<I;++v){if(y=e[v],y.index=v,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var b=Of*Math.sqrt(.5+v),x=v*Mf;y.x=b*Math.cos(x),y.y=b*Math.sin(x)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function m(v){return v.initialize&&v.initialize(e,c),v}return h(),t={tick:d,restart:function(){return a.restart(p),t},stop:function(){return a.stop(),t},nodes:function(v){return arguments.length?(e=v,h(),l.forEach(m),t):e},alpha:function(v){return arguments.length?(n=+v,t):n},alphaMin:function(v){return arguments.length?(i=+v,t):i},alphaDecay:function(v){return arguments.length?(r=+v,t):+r},alphaTarget:function(v){return arguments.length?(o=+v,t):o},velocityDecay:function(v){return arguments.length?(s=1-v,t):1-s},randomSource:function(v){return arguments.length?(c=v,l.forEach(m),t):c},force:function(v,I){return arguments.length>1?(I==null?l.delete(v):l.set(v,m(I)),t):l.get(v)},find:function(v,I,y){var b=0,x=e.length,R,A,S,D,F;for(y==null?y=1/0:y*=y,b=0;b<x;++b)D=e[b],R=v-D.x,A=I-D.y,S=R*R+A*A,S<y&&(F=D,y=S);return F},on:function(v,I){return arguments.length>1?(u.on(v,I),t):u.on(v)}}}function kf(){var e,t,n,i,r=Jt(-30),o,s=1,l=1/0,a=.81;function u(h){var m,v=e.length,I=ur(e,Af,Tf).visitAfter(p);for(i=h,m=0;m<v;++m)t=e[m],I.visit(d)}function c(){if(e){var h,m=e.length,v;for(o=new Array(m),h=0;h<m;++h)v=e[h],o[v.index]=+r(v,h,e)}}function p(h){var m=0,v,I,y=0,b,x,R;if(h.length){for(b=x=R=0;R<4;++R)(v=h[R])&&(I=Math.abs(v.value))&&(m+=v.value,y+=I,b+=I*v.x,x+=I*v.y);h.x=b/y,h.y=x/y}else{v=h,v.x=v.data.x,v.y=v.data.y;do m+=o[v.data.index];while(v=v.next)}h.value=m}function d(h,m,v,I){if(!h.value)return!0;var y=h.x-t.x,b=h.y-t.y,x=I-m,R=y*y+b*b;if(x*x/a<R)return R<l&&(y===0&&(y=xn(n),R+=y*y),b===0&&(b=xn(n),R+=b*b),R<s&&(R=Math.sqrt(s*R)),t.vx+=y*h.value*i/R,t.vy+=b*h.value*i/R),!0;if(h.length||R>=l)return;(h.data!==t||h.next)&&(y===0&&(y=xn(n),R+=y*y),b===0&&(b=xn(n),R+=b*b),R<s&&(R=Math.sqrt(s*R)));do h.data!==t&&(x=o[h.data.index]*i/R,t.vx+=y*x,t.vy+=b*x);while(h=h.next)}return u.initialize=function(h,m){e=h,n=m,c()},u.strength=function(h){return arguments.length?(r=typeof h=="function"?h:Jt(+h),c(),u):r},u.distanceMin=function(h){return arguments.length?(s=h*h,u):Math.sqrt(s)},u.distanceMax=function(h){return arguments.length?(l=h*h,u):Math.sqrt(l)},u.theta=function(h){return arguments.length?(a=h*h,u):Math.sqrt(a)},u}function Cf(e,t,n){var i,r=Jt(.1),o,s;typeof e!="function"&&(e=Jt(+e)),t==null&&(t=0),n==null&&(n=0);function l(u){for(var c=0,p=i.length;c<p;++c){var d=i[c],h=d.x-t||1e-6,m=d.y-n||1e-6,v=Math.sqrt(h*h+m*m),I=(s[c]-v)*o[c]*u/v;d.vx+=h*I,d.vy+=m*I}}function a(){if(i){var u,c=i.length;for(o=new Array(c),s=new Array(c),u=0;u<c;++u)s[u]=+e(i[u],u,i),o[u]=isNaN(s[u])?0:+r(i[u],u,i)}}return l.initialize=function(u){i=u,a()},l.strength=function(u){return arguments.length?(r=typeof u=="function"?u:Jt(+u),a(),l):r},l.radius=function(u){return arguments.length?(e=typeof u=="function"?u:Jt(+u),a(),l):e},l.x=function(u){return arguments.length?(t=+u,l):t},l.y=function(u){return arguments.length?(n=+u,l):n},l}const gi=e=>()=>e;function Pf(e,{sourceEvent:t,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function zt(e,t,n){this.k=e,this.x=t,this.y=n}zt.prototype={constructor:zt,scale:function(e){return e===1?this:new zt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new zt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ai=new zt(1,0,0);zt.prototype;function Ui(e){e.stopImmediatePropagation()}function Kn(e){e.preventDefault(),e.stopImmediatePropagation()}function Lf(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Ff(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Br(){return this.__zoom||Ai}function Vf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function zf(){return navigator.maxTouchPoints||"ontouchstart"in this}function Uf(e,t,n){var i=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function Gf(){var e=Lf,t=Ff,n=Uf,i=Vf,r=zf,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],l=250,a=jl,u=Mi("start","zoom","end"),c,p,d,h=500,m=150,v=0,I=10;function y(T){T.property("__zoom",Br).on("wheel.zoom",F,{passive:!1}).on("mousedown.zoom",q).on("dblclick.zoom",U).filter(r).on("touchstart.zoom",$).on("touchmove.zoom",V).on("touchend.zoom touchcancel.zoom",j).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(T,C,M,O){var k=T.selection?T.selection():T;k.property("__zoom",Br),T!==k?A(T,C,M,O):k.interrupt().each(function(){S(this,arguments).event(O).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},y.scaleBy=function(T,C,M,O){y.scaleTo(T,function(){var k=this.__zoom.k,G=typeof C=="function"?C.apply(this,arguments):C;return k*G},M,O)},y.scaleTo=function(T,C,M,O){y.transform(T,function(){var k=t.apply(this,arguments),G=this.__zoom,Y=M==null?R(k):typeof M=="function"?M.apply(this,arguments):M,K=G.invert(Y),ne=typeof C=="function"?C.apply(this,arguments):C;return n(x(b(G,ne),Y,K),k,s)},M,O)},y.translateBy=function(T,C,M,O){y.transform(T,function(){return n(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof M=="function"?M.apply(this,arguments):M),t.apply(this,arguments),s)},null,O)},y.translateTo=function(T,C,M,O,k){y.transform(T,function(){var G=t.apply(this,arguments),Y=this.__zoom,K=O==null?R(G):typeof O=="function"?O.apply(this,arguments):O;return n(Ai.translate(K[0],K[1]).scale(Y.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof M=="function"?-M.apply(this,arguments):-M),G,s)},O,k)};function b(T,C){return C=Math.max(o[0],Math.min(o[1],C)),C===T.k?T:new zt(C,T.x,T.y)}function x(T,C,M){var O=C[0]-M[0]*T.k,k=C[1]-M[1]*T.k;return O===T.x&&k===T.y?T:new zt(T.k,O,k)}function R(T){return[(+T[0][0]+ +T[1][0])/2,(+T[0][1]+ +T[1][1])/2]}function A(T,C,M,O){T.on("start.zoom",function(){S(this,arguments).event(O).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(O).end()}).tween("zoom",function(){var k=this,G=arguments,Y=S(k,G).event(O),K=t.apply(k,G),ne=M==null?R(K):typeof M=="function"?M.apply(k,G):M,pe=Math.max(K[1][0]-K[0][0],K[1][1]-K[0][1]),_e=k.__zoom,we=typeof C=="function"?C.apply(k,G):C,me=a(_e.invert(ne).concat(pe/_e.k),we.invert(ne).concat(pe/we.k));return function(ve){if(ve===1)ve=we;else{var Me=me(ve),Oe=pe/Me[2];ve=new zt(Oe,ne[0]-Me[0]*Oe,ne[1]-Me[1]*Oe)}Y.zoom(null,ve)}})}function S(T,C,M){return!M&&T.__zooming||new D(T,C)}function D(T,C){this.that=T,this.args=C,this.active=0,this.sourceEvent=null,this.extent=t.apply(T,C),this.taps=0}D.prototype={event:function(T){return T&&(this.sourceEvent=T),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(T,C){return this.mouse&&T!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&T!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&T!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(T){var C=vt(this.that).datum();u.call(T,this.that,new Pf(T,{sourceEvent:this.sourceEvent,target:y,type:T,transform:this.that.__zoom,dispatch:u}),C)}};function F(T,...C){if(!e.apply(this,arguments))return;var M=S(this,C).event(T),O=this.__zoom,k=Math.max(o[0],Math.min(o[1],O.k*Math.pow(2,i.apply(this,arguments)))),G=gn(T);if(M.wheel)(M.mouse[0][0]!==G[0]||M.mouse[0][1]!==G[1])&&(M.mouse[1]=O.invert(M.mouse[0]=G)),clearTimeout(M.wheel);else{if(O.k===k)return;M.mouse=[G,O.invert(G)],bi(this),M.start()}Kn(T),M.wheel=setTimeout(Y,m),M.zoom("mouse",n(x(b(O,k),M.mouse[0],M.mouse[1]),M.extent,s));function Y(){M.wheel=null,M.end()}}function q(T,...C){if(d||!e.apply(this,arguments))return;var M=T.currentTarget,O=S(this,C,!0).event(T),k=vt(T.view).on("mousemove.zoom",ne,!0).on("mouseup.zoom",pe,!0),G=gn(T,M),Y=T.clientX,K=T.clientY;yl(T.view),Ui(T),O.mouse=[G,this.__zoom.invert(G)],bi(this),O.start();function ne(_e){if(Kn(_e),!O.moved){var we=_e.clientX-Y,me=_e.clientY-K;O.moved=we*we+me*me>v}O.event(_e).zoom("mouse",n(x(O.that.__zoom,O.mouse[0]=gn(_e,M),O.mouse[1]),O.extent,s))}function pe(_e){k.on("mousemove.zoom mouseup.zoom",null),bl(_e.view,O.moved),Kn(_e),O.event(_e).end()}}function U(T,...C){if(e.apply(this,arguments)){var M=this.__zoom,O=gn(T.changedTouches?T.changedTouches[0]:T,this),k=M.invert(O),G=M.k*(T.shiftKey?.5:2),Y=n(x(b(M,G),O,k),t.apply(this,C),s);Kn(T),l>0?vt(this).transition().duration(l).call(A,Y,O,T):vt(this).call(y.transform,Y,O,T)}}function $(T,...C){if(e.apply(this,arguments)){var M=T.touches,O=M.length,k=S(this,C,T.changedTouches.length===O).event(T),G,Y,K,ne;for(Ui(T),Y=0;Y<O;++Y)K=M[Y],ne=gn(K,this),ne=[ne,this.__zoom.invert(ne),K.identifier],k.touch0?!k.touch1&&k.touch0[2]!==ne[2]&&(k.touch1=ne,k.taps=0):(k.touch0=ne,G=!0,k.taps=1+!!c);c&&(c=clearTimeout(c)),G&&(k.taps<2&&(p=ne[0],c=setTimeout(function(){c=null},h)),bi(this),k.start())}}function V(T,...C){if(this.__zooming){var M=S(this,C).event(T),O=T.changedTouches,k=O.length,G,Y,K,ne;for(Kn(T),G=0;G<k;++G)Y=O[G],K=gn(Y,this),M.touch0&&M.touch0[2]===Y.identifier?M.touch0[0]=K:M.touch1&&M.touch1[2]===Y.identifier&&(M.touch1[0]=K);if(Y=M.that.__zoom,M.touch1){var pe=M.touch0[0],_e=M.touch0[1],we=M.touch1[0],me=M.touch1[1],ve=(ve=we[0]-pe[0])*ve+(ve=we[1]-pe[1])*ve,Me=(Me=me[0]-_e[0])*Me+(Me=me[1]-_e[1])*Me;Y=b(Y,Math.sqrt(ve/Me)),K=[(pe[0]+we[0])/2,(pe[1]+we[1])/2],ne=[(_e[0]+me[0])/2,(_e[1]+me[1])/2]}else if(M.touch0)K=M.touch0[0],ne=M.touch0[1];else return;M.zoom("touch",n(x(Y,K,ne),M.extent,s))}}function j(T,...C){if(this.__zooming){var M=S(this,C).event(T),O=T.changedTouches,k=O.length,G,Y;for(Ui(T),d&&clearTimeout(d),d=setTimeout(function(){d=null},h),G=0;G<k;++G)Y=O[G],M.touch0&&M.touch0[2]===Y.identifier?delete M.touch0:M.touch1&&M.touch1[2]===Y.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(Y=gn(Y,this),Math.hypot(p[0]-Y[0],p[1]-Y[1])<I)){var K=vt(this).on("dblclick.zoom");K&&K.apply(this,arguments)}}}return y.wheelDelta=function(T){return arguments.length?(i=typeof T=="function"?T:gi(+T),y):i},y.filter=function(T){return arguments.length?(e=typeof T=="function"?T:gi(!!T),y):e},y.touchable=function(T){return arguments.length?(r=typeof T=="function"?T:gi(!!T),y):r},y.extent=function(T){return arguments.length?(t=typeof T=="function"?T:gi([[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]]),y):t},y.scaleExtent=function(T){return arguments.length?(o[0]=+T[0],o[1]=+T[1],y):[o[0],o[1]]},y.translateExtent=function(T){return arguments.length?(s[0][0]=+T[0][0],s[1][0]=+T[1][0],s[0][1]=+T[0][1],s[1][1]=+T[1][1],y):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},y.constrain=function(T){return arguments.length?(n=T,y):n},y.duration=function(T){return arguments.length?(l=+T,y):l},y.interpolate=function(T){return arguments.length?(a=T,y):a},y.on=function(){var T=u.on.apply(u,arguments);return T===u?y:T},y.clickDistance=function(T){return arguments.length?(v=(T=+T)*T,y):Math.sqrt(v)},y.tapDistance=function(T){return arguments.length?(I=+T,y):I},y}const Ft={RADIUS:3,GLOW_RADIUS:5,GLOW_OPACITY:.25},pi={BASE_VELOCITY:.15,VELOCITY_SCALE:.5,DRIFT_FORCE:.008,MAX_SPEED:.25},ls={nodeCount:35,viewportScale:1.5,minConnections:2,maxConnections:4,viewport:{origin:{x:-.5,y:-.5},scale:1,preserveAspectRatio:"xMidYMid meet"},animation:{baseVelocity:pi.BASE_VELOCITY,velocityScale:pi.VELOCITY_SCALE,driftForce:pi.DRIFT_FORCE,maxSpeed:pi.MAX_SPEED},nodeStyles:[{mainRadius:Ft.RADIUS,glowRadius:Ft.GLOW_RADIUS,mainColor:W.PRIMARY.BLUE,glowColor:W.PRIMARY.BLUE,glowOpacity:Ft.GLOW_OPACITY},{mainRadius:Ft.RADIUS,glowRadius:Ft.GLOW_RADIUS,mainColor:W.PRIMARY.PURPLE,glowColor:W.PRIMARY.PURPLE,glowOpacity:Ft.GLOW_OPACITY},{mainRadius:Ft.RADIUS,glowRadius:Ft.GLOW_RADIUS,mainColor:W.PRIMARY.GREEN,glowColor:W.PRIMARY.GREEN,glowOpacity:Ft.GLOW_OPACITY}],edgeStyle:{width:1.2,color:W.GRAPH.EDGE.DEFAULT,glowColor:W.UI.TEXT.TERTIARY,glowWidth:1,opacity:.08}};class Wf{constructor(t,n,i,r={}){Re(this,"nodes");Re(this,"width");Re(this,"height");Re(this,"config");Re(this,"nodesGroup");Re(this,"edgesGroup");Re(this,"defs");Re(this,"gradientIds",[]);Re(this,"animationFrameId",null);this.config={...ls,...r};const o=vt(t);this.width=n*this.config.viewportScale,this.height=i*this.config.viewportScale;const s=this.width/2,l=this.height/2;o.attr("viewBox",`${-s} ${-l} ${this.width} ${this.height}`).attr("preserveAspectRatio",this.config.viewport.preserveAspectRatio),this.defs=o.append("defs"),this.edgesGroup=o.append("g").attr("class","edges"),this.nodesGroup=o.append("g").attr("class","nodes"),this.createGlowFilter(),this.createGradients(),this.nodes=this.createInitialNodes(),this.initializeNodes()}createGlowFilter(){const t=this.defs.append("filter").attr("id","nodeGlow").attr("width","300%").attr("height","300%").attr("x","-100%").attr("y","-100%");t.append("feGaussianBlur").attr("in","SourceGraphic").attr("stdDeviation","3").attr("result","blur"),t.append("feColorMatrix").attr("in","blur").attr("type","matrix").attr("values","1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7")}createGradients(){this.gradientIds=this.config.nodeStyles.map((t,n)=>{const i=`edge-gradient-${n}`,{r,g:o,b:s}=this.hexToRgb(t.mainColor),l=this.defs.append("linearGradient").attr("id",i).attr("gradientUnits","userSpaceOnUse");return l.append("stop").attr("offset","0%").attr("stop-color",`rgba(${r}, ${o}, ${s}, ${this.config.edgeStyle.opacity})`),l.append("stop").attr("offset","50%").attr("stop-color",`rgba(255, 255, 255, ${this.config.edgeStyle.opacity/2})`),l.append("stop").attr("offset","100%").attr("stop-color",`rgba(${r}, ${o}, ${s}, ${this.config.edgeStyle.opacity})`),i})}createInitialNodes(){return Array.from({length:this.config.nodeCount},(t,n)=>({id:`node-${n}`,x:(Math.random()-.5)*this.width,y:(Math.random()-.5)*this.height,vx:(Math.random()-.5)*this.config.animation.baseVelocity,vy:(Math.random()-.5)*this.config.animation.baseVelocity,connections:this.generateConnections(n),styleIndex:Math.floor(Math.random()*this.config.nodeStyles.length)}))}generateConnections(t){const n=this.config.minConnections+Math.floor(Math.random()*(this.config.maxConnections-this.config.minConnections+1));return Array.from({length:n},()=>{let i;do i=Math.floor(Math.random()*this.config.nodeCount);while(i===t);return`node-${i}`})}initializeNodes(){this.updateNodes(),this.updateEdges()}tick(){this.updateNodePositions(),this.updateNodes(),this.updateEdges(),this.animationFrameId=requestAnimationFrame(()=>this.tick())}updateNodePositions(){const t=this.width/2,n=this.height/2,i=this.config.animation;this.nodes.forEach(r=>{r.vx+=(Math.random()-.5)*i.driftForce,r.vy+=(Math.random()-.5)*i.driftForce,r.x+=r.vx*i.velocityScale,r.y+=r.vy*i.velocityScale;const o=Math.sqrt(r.vx*r.vx+r.vy*r.vy);o>i.maxSpeed&&(r.vx=r.vx/o*i.maxSpeed,r.vy=r.vy/o*i.maxSpeed),r.x<-t-100&&(r.x=t+98),r.x>t+100&&(r.x=-t-98),r.y<-n-100&&(r.y=n+98),r.y>n+100&&(r.y=-n-98)})}updateEdges(){const t=this.edgesGroup.selectAll("path").data(this.createEdgeData());t.enter().append("path").merge(t).attr("d",n=>`M${n.source.x},${n.source.y}L${n.target.x},${n.target.y}`).attr("stroke",n=>`url(#${this.gradientIds[n.source.styleIndex]})`).attr("stroke-width",this.config.edgeStyle.width).attr("fill","none"),t.exit().remove()}updateNodes(){const t=this.nodesGroup.selectAll("g.node").data(this.nodes),n=t.enter().append("g").attr("class","node");n.append("circle").attr("r",r=>this.config.nodeStyles[r.styleIndex].glowRadius).attr("filter","url(#nodeGlow)"),n.append("circle").attr("r",r=>this.config.nodeStyles[r.styleIndex].mainRadius),n.merge(t).attr("transform",r=>`translate(${r.x},${r.y})`).selectAll("circle").attr("fill",r=>{const o=this.config.nodeStyles[r.styleIndex],{r:s,g:l,b:a}=this.hexToRgb(o.mainColor);return`rgba(${s}, ${l}, ${a}, ${o.glowOpacity})`}),t.exit().remove()}createEdgeData(){const t=[];return this.nodes.forEach(n=>{n.connections.forEach(i=>{const r=this.nodes.find(o=>o.id===i);r&&t.push({source:n,target:r})})}),t}hexToRgb(t){const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:{r:0,g:0,b:0}}resize(t,n){var s;this.width=t*this.config.viewportScale,this.height=n*this.config.viewportScale;const i=this.width/2,r=this.height/2,o=(s=this.nodesGroup.node())==null?void 0:s.parentElement;o&&vt(o).attr("viewBox",`${-i} ${-r} ${this.width} ${this.height}`)}start(){this.animationFrameId||this.tick()}stop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}destroy(){this.stop(),this.edgesGroup.remove(),this.nodesGroup.remove(),this.defs.remove()}}const Ae={SIMULATION:{ALPHA_DECAY:.02,VELOCITY_DECAY:.4,ALPHA_TARGET:0,ALPHA_MIN:.001},WORD_VIEW:{CENTRAL:{CHARGE:-2e3,BASE_RADIUS:e=>(e?B.SIZES.WORD.detail:B.SIZES.WORD.preview)/2,COLLISION_PADDING:200},DEFINITION:{LIVE:{CHARGE:-1500,BASE_RADIUS:e=>e?1e3:600,COLLISION_PADDING:200,RADIAL_STRENGTH:1,LINK_STRENGTH:.3},ALTERNATIVE:{CHARGE:-1500,BASE_RADIUS:e=>e?1300:900,COLLISION_PADDING:200,RADIAL_STRENGTH:1,LINK_STRENGTH:.3},VOTE_DISTANCE_FACTOR:15,MAX_VOTE_ADJUSTMENT:150}},NAVIGATION:{RADIUS:180,CHARGE:-300,COLLISION_RADIUS:80,RADIAL_STRENGTH:.8,LINK_STRENGTH:.2},COLLISION:{ITERATIONS:50,STRENGTH:1.5},calculateDefinitionRadius:(e,t,n)=>{const i=t?Ae.WORD_VIEW.DEFINITION.LIVE.BASE_RADIUS(n):Ae.WORD_VIEW.DEFINITION.ALTERNATIVE.BASE_RADIUS(n),r=Math.min(Math.abs(e)*Ae.WORD_VIEW.DEFINITION.VOTE_DISTANCE_FACTOR,Ae.WORD_VIEW.DEFINITION.MAX_VOTE_ADJUSTMENT);return i-r},getNodeBaseRadius:(e,t,n)=>{switch(e==="dashboard"||e==="edit-profile"||e==="create-node"?"central":e){case"word":case"central":return n?B.SIZES.WORD.detail/2:B.SIZES.WORD.preview/2;case"definition":return t?n?B.SIZES.DEFINITION.live.detail/2:B.SIZES.DEFINITION.live.preview/2:n?B.SIZES.DEFINITION.alternative.detail/2:B.SIZES.DEFINITION.alternative.preview/2;case"navigation":return Ae.NAVIGATION.COLLISION_RADIUS;default:return 150}},getCollisionRadius:(e,t,n)=>{const i=Ae.getNodeBaseRadius(e,t,n);switch(e){case"word":case"central":return i+Ae.WORD_VIEW.CENTRAL.COLLISION_PADDING;case"definition":return t?i+Ae.WORD_VIEW.DEFINITION.LIVE.COLLISION_PADDING:i+Ae.WORD_VIEW.DEFINITION.ALTERNATIVE.COLLISION_PADDING;default:return i}},getLinkStrength:(e,t)=>e==="definition"?t?Ae.WORD_VIEW.DEFINITION.LIVE.LINK_STRENGTH:Ae.WORD_VIEW.DEFINITION.ALTERNATIVE.LINK_STRENGTH:Ae.NAVIGATION.LINK_STRENGTH};class Bf{constructor(t,n,i){Re(this,"simulation");Re(this,"viewType");Re(this,"width");Re(this,"height");Re(this,"state");Re(this,"navigationNodes",[]);Re(this,"contentNodes",[]);this.width=t,this.height=n,this.viewType=i,this.state={centralNodeSize:B.SIZES.WORD.preview,navigationRadius:Ae.NAVIGATION.RADIUS,isTransitioning:!1},this.simulation=this.initializeSimulation()}getNavigationRadius(){const t=Ae.NAVIGATION.RADIUS,n=this.state.centralNodeSize/2;return t+n}categorizeNodes(t){this.navigationNodes=t.filter(n=>n.type==="navigation"),this.contentNodes=t.filter(n=>n.type!=="navigation"),console.log("Node categorization:",{navigationCount:this.navigationNodes.length,contentCount:this.contentNodes.length})}initializeSimulation(){console.log("Initializing force simulation");const t=Df().velocityDecay(Ae.SIMULATION.VELOCITY_DECAY).alphaDecay(Ae.SIMULATION.ALPHA_DECAY).alphaMin(Ae.SIMULATION.ALPHA_MIN);if(this.viewType==="word"){const n=If().radius(o=>{const s=this.getNodeRadius(o);return console.log("Collision radius calculated:",{nodeId:o.id,radius:s}),s}).strength(Ae.COLLISION.STRENGTH).iterations(Ae.COLLISION.ITERATIONS),i=Cf(o=>o.type==="navigation"?this.getNavigationRadius():0,0,0).strength(o=>o.type==="navigation"?1:0),r=kf().strength(o=>o.type==="navigation"?0:-this.getNodeRadius(o)*3).distanceMin(10).distanceMax(500);t.force("collision",n).force("navigation",i).force("charge",r),console.log("Forces initialized:",{collisionStrength:Ae.COLLISION.STRENGTH,navigationRadius:this.getNavigationRadius()})}return t}getNodeRadius(t){const n=t.metadata.isDetail;if(t.type==="navigation")return Ae.NAVIGATION.COLLISION_RADIUS;const i=Ae.getNodeBaseRadius(t.type,t.subtype==="live",n);return console.log("Node radius calculation:",{nodeId:t.id,type:t.type,isDetail:n,baseRadius:i}),i}updateData(t,n){console.log("Updating simulation data:",{nodeCount:t.length,linkCount:n.length}),this.categorizeNodes(t),t.forEach(i=>{i.metadata.fixed&&(i.fx=0,i.fy=0,this.state.centralNodeSize=this.getNodeRadius(i)*2,console.log("Central node size updated:",this.state.centralNodeSize))}),this.navigationNodes.forEach((i,r)=>{if(!i.x&&!i.y){const o=2*Math.PI*r/this.navigationNodes.length,s=this.getNavigationRadius();i.x=Math.cos(o)*s,i.y=Math.sin(o)*s,console.log("Navigation node positioned:",{nodeId:i.id,angle:o*(180/Math.PI),radius:s,x:i.x,y:i.y})}}),this.simulation.nodes(t),this.simulation.alpha(.3).restart(),console.log("Simulation updated and restarted")}stop(){this.simulation.stop(),console.log("Simulation stopped")}getSimulation(){return this.simulation}updateDimensions(t,n){this.width=t,this.height=n,this.simulation.alpha(.3).restart(),console.log("Dimensions updated:",{width:t,height:n})}resetForces(){console.log("Resetting forces"),this.simulation=this.initializeSimulation();const t=this.simulation.nodes();t.length>0&&this.updateData(t,[]),console.log("Forces reset complete")}}class Yf{constructor(t){Re(this,"simulation");Re(this,"_width");Re(this,"_height");Re(this,"_viewType");Re(this,"state");console.log("Initializing LayoutService:",t),this._width=t.width,this._height=t.height,this._viewType=t.viewType,this.state={isPreviewMode:t.isPreviewMode||!1,definitionModes:new Map,lastData:null},this.simulation=new Bf(t.width,t.height,t.viewType)}get width(){return this._width}get height(){return this._height}transformToLayoutFormat(t){console.log("Transforming data to layout format");const n=t.nodes.map(r=>{const o={id:r.id,type:r.type==="definition"?"definition":r.type==="word"?"word":r.type==="navigation"?"navigation":"central",subtype:r.type==="definition"?r.group==="live-definition"?"live":"alternative":void 0,metadata:{group:this.getLayoutGroup(r),fixed:r.group==="central",isDetail:this.state.definitionModes.get(r.id)==="detail",votes:r.type==="definition"?this.getNodeVotes(r):void 0}};return console.log("Created layout node:",{id:o.id,type:o.type,subtype:o.subtype,isDetail:o.metadata.isDetail}),o}),i=(t.links||[]).map(r=>{const o=r.type==="live"?"definition":"navigation";return{source:typeof r.source=="string"?r.source:r.source.id,target:typeof r.target=="string"?r.target:r.target.id,type:o,strength:o==="definition"?.7:.3}});return{nodes:n,links:i}}getLayoutGroup(t){return t.group==="central"?"central":t.group==="live-definition"||t.group==="alternative-definition"?"definition":t.type}getNodeVotes(t){if(t.type==="definition"&&"data"in t){const n=t.data,i=typeof n.positiveVotes=="number"?n.positiveVotes:0,r=typeof n.negativeVotes=="number"?n.negativeVotes:0;return i-r}return 0}hasDataChanged(t){return this.state.lastData?JSON.stringify(t)!==JSON.stringify(this.state.lastData):!0}updateLayout(t,n=[]){const i={nodes:t,links:n};if(!this.hasDataChanged(i))return console.log("Data unchanged, returning current positions"),this.getCurrentPositions();console.log("Updating layout with new data"),this.state.lastData=i;const r=this.transformToLayoutFormat(i);return this.simulation.updateData(r.nodes,r.links),this.getCurrentPositions()}getCurrentPositions(){const t=new Map;return this.simulation.getSimulation().nodes().forEach(i=>{const r=i.x??0,o=i.y??0;t.set(i.id,{x:r,y:o,scale:1,svgTransform:`translate(${r}, ${o})`})}),t}updatePreviewMode(t){this.state.isPreviewMode!==t&&(console.log("Preview mode changed:",{old:this.state.isPreviewMode,new:t}),this.state.isPreviewMode=t,this.simulation.resetForces())}updateDefinitionModes(t){Array.from(t.entries()).some(([i,r])=>this.state.definitionModes.get(i)!==r)&&(console.log("Definition modes changed:",{old:Object.fromEntries(this.state.definitionModes),new:Object.fromEntries(t)}),this.state.definitionModes=new Map(t),this.simulation.resetForces())}resize(t,n){console.log("Resizing layout:",{width:t,height:n}),this._width=t,this._height=n,this.simulation.updateDimensions(t,n)}stop(){console.log("Stopping layout service"),this.simulation.stop()}getSimulation(){return this.simulation}}class Xf{constructor(t,n,i,r=!1){Re(this,"layoutService");Re(this,"definitionNodeModes");const o={width:t,height:n,viewType:i,isPreviewMode:r};this.layoutService=new Yf(o),this.definitionNodeModes=new Map}get width(){return this.layoutService.width}get height(){return this.layoutService.height}updateLayout(t){return this.layoutService.updateLayout(t.nodes,t.links)}updatePreviewMode(t){this.layoutService.updatePreviewMode(t)}updateDefinitionModes(t){this.definitionNodeModes=new Map(t),this.layoutService.updateDefinitionModes(t)}resize(t,n){this.layoutService.resize(t,n)}stop(){this.layoutService.stop()}getSimulation(){return this.layoutService}}const{Map:Hf}=Ts;function Yr(e,t,n){const i=e.slice();i[18]=t[n];const r=i[1].get(i[18].id);return i[19]=r,i}const jf=e=>({node:e&1,transform:e&3}),Xr=e=>({node:e[18],transform:e[19].svgTransform});function Hr(e,t,n){const i=e.slice();i[22]=t[n];const r=i[1].get(typeof i[22].source=="string"?i[22].source:i[22].source.id);i[23]=r;const o=i[1].get(typeof i[22].target=="string"?i[22].target:i[22].target.id);return i[24]=o,i}function jr(e){let t,n=Tt(e[0].links),i=[];for(let r=0;r<n.length;r+=1)i[r]=$r(Hr(e,n,r));return{c(){t=E("g");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){t=N(r,"g",{class:!0,"aria-hidden":!0});var o=w(t);for(let s=0;s<i.length;s+=1)i[s].l(o);o.forEach(g),this.h()},h(){f(t,"class","edges svelte-hgk02u"),f(t,"aria-hidden","true")},m(r,o){z(r,t,o);for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(t,null)},p(r,o){if(o&3){n=Tt(r[0].links);let s;for(s=0;s<n.length;s+=1){const l=Hr(r,n,s);i[s]?i[s].p(l,o):(i[s]=$r(l),i[s].c(),i[s].m(t,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},d(r){r&&g(t),Oi(i,r)}}}function qr(e){let t,n,i;return{c(){t=E("path"),this.h()},l(r){t=N(r,"path",{class:!0,d:!0}),w(t).forEach(g),this.h()},h(){f(t,"class",n="edge "+e[22].type+" svelte-hgk02u"),f(t,"d",i="M"+e[23].x+","+e[23].y+"L"+e[24].x+","+e[24].y)},m(r,o){z(r,t,o)},p(r,o){o&1&&n!==(n="edge "+r[22].type+" svelte-hgk02u")&&f(t,"class",n),o&3&&i!==(i="M"+r[23].x+","+r[23].y+"L"+r[24].x+","+r[24].y)&&f(t,"d",i)},d(r){r&&g(t)}}}function $r(e){let t,n=e[23]&&e[24]&&qr(e);return{c(){n&&n.c(),t=Te()},l(i){n&&n.l(i),t=Te()},m(i,r){n&&n.m(i,r),z(i,t,r)},p(i,r){i[23]&&i[24]?n?n.p(i,r):(n=qr(i),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(i){i&&g(t),n&&n.d(i)}}}function Zr(e){let t,n=[],i=new Hf,r,o=Tt(e[0].nodes);const s=l=>l[18].id;for(let l=0;l<o.length;l+=1){let a=Yr(e,o,l),u=s(a);i.set(u,n[l]=Qr(u,a))}return{c(){t=E("g");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){t=N(l,"g",{class:!0});var a=w(t);for(let u=0;u<n.length;u+=1)n[u].l(a);a.forEach(g),this.h()},h(){f(t,"class","nodes svelte-hgk02u")},m(l,a){z(l,t,a);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(t,null);r=!0},p(l,a){a&259&&(o=Tt(l[0].nodes),bt(),n=Ms(n,a,s,1,l,o,i,t,Os,Qr,null,Yr),Et())},i(l){if(!r){for(let a=0;a<o.length;a+=1)X(n[a]);r=!0}},o(l){for(let a=0;a<n.length;a+=1)H(n[a]);r=!1},d(l){l&&g(t);for(let a=0;a<n.length;a+=1)n[a].d()}}}function Kr(e){let t,n,i,r;const o=e[9].default,s=$t(o,e,e[8],Xr);return{c(){t=E("g"),s&&s.c(),this.h()},l(l){t=N(l,"g",{class:!0,transform:!0});var a=w(t);s&&s.l(a),a.forEach(g),this.h()},h(){f(t,"class",n="node "+e[18].type+" "+e[18].group+" svelte-hgk02u"),f(t,"transform",i=e[19].svgTransform)},m(l,a){z(l,t,a),s&&s.m(t,null),r=!0},p(l,a){s&&s.p&&(!r||a&259)&&Zt(s,o,l,l[8],r?Qt(o,l[8],a,jf):Kt(l[8]),Xr),(!r||a&1&&n!==(n="node "+l[18].type+" "+l[18].group+" svelte-hgk02u"))&&f(t,"class",n),(!r||a&3&&i!==(i=l[19].svgTransform))&&f(t,"transform",i)},i(l){r||(X(s,l),r=!0)},o(l){H(s,l),r=!1},d(l){l&&g(t),s&&s.d(l)}}}function Qr(e,t){let n,i,r,o=t[19]&&Kr(t);return{key:e,first:null,c(){n=Te(),o&&o.c(),i=Te(),this.h()},l(s){n=Te(),o&&o.l(s),i=Te(),this.h()},h(){this.first=n},m(s,l){z(s,n,l),o&&o.m(s,l),z(s,i,l),r=!0},p(s,l){t=s,t[19]?o?(o.p(t,l),l&3&&X(o,1)):(o=Kr(t),o.c(),X(o,1),o.m(i.parentNode,i)):o&&(bt(),H(o,1,1,()=>{o=null}),Et())},i(s){r||(X(o),r=!0)},o(s){H(o),r=!1},d(s){s&&(g(n),g(i)),o&&o.d(s)}}}function qf(e){let t,n,i,r=e[0].links&&e[0].links.length>0&&jr(e),o=e[0].nodes&&e[0].nodes.length>0&&Zr(e);return{c(){t=E("g"),r&&r.c(),n=Te(),o&&o.c(),this.h()},l(s){t=N(s,"g",{class:!0});var l=w(t);r&&r.l(l),n=Te(),o&&o.l(l),l.forEach(g),this.h()},h(){f(t,"class","graph-layout svelte-hgk02u")},m(s,l){z(s,t,l),r&&r.m(t,null),_(t,n),o&&o.m(t,null),i=!0},p(s,[l]){s[0].links&&s[0].links.length>0?r?r.p(s,l):(r=jr(s),r.c(),r.m(t,n)):r&&(r.d(1),r=null),s[0].nodes&&s[0].nodes.length>0?o?(o.p(s,l),l&1&&X(o,1)):(o=Zr(s),o.c(),X(o,1),o.m(t,null)):o&&(bt(),H(o,1,1,()=>{o=null}),Et())},i(s){i||(X(o),i=!0)},o(s){H(o),i=!1},d(s){s&&g(t),r&&r.d(),o&&o.d()}}}function $f(e,t,n){let{$$slots:i={},$$scope:r}=t;tt();let{data:o}=t,{width:s}=t,{height:l}=t,{viewType:a}=t,{isPreviewMode:u=!1}=t,c,p=new Map,d=new Map,h=!1,m=Date.now(),v=0;function I(){console.log("Initializing layout:",{width:s,height:l,viewType:a,isPreviewMode:u}),n(6,c=new Xf(s,l,a,u)),c.updateDefinitionModes(d),requestAnimationFrame(()=>y(!0))}function y(b=!1){var A;if(!c||!o)return;const x=Date.now(),R=x-m;if(!(!b&&R<16)&&(console.log("Updating layout:",{updateCount:++v,nodeCount:o.nodes.length,linkCount:((A=o.links)==null?void 0:A.length)||0,timeSinceLastUpdate:R}),n(1,p=c.updateLayout(o)),m=x,p.size>0)){const S=Array.from(p.entries())[0];console.log("Sample position:",{nodeId:S[0],position:S[1]})}}return en(()=>{console.log("GraphLayout mounting"),n(7,h=!0),I()}),er(()=>{console.log("GraphLayout destroying"),c&&c.stop()}),e.$$set=b=>{"data"in b&&n(0,o=b.data),"width"in b&&n(2,s=b.width),"height"in b&&n(3,l=b.height),"viewType"in b&&n(4,a=b.viewType),"isPreviewMode"in b&&n(5,u=b.isPreviewMode),"$$scope"in b&&n(8,r=b.$$scope)},e.$$.update=()=>{e.$$.dirty&224&&h&&c&&u!==void 0&&(console.log("Preview mode changed:",u),c.updatePreviewMode(u),requestAnimationFrame(()=>y(!0))),e.$$.dirty&193&&h&&c&&o&&requestAnimationFrame(()=>y()),e.$$.dirty&76&&s&&l&&c&&(console.log("Dimensions changed:",{width:s,height:l}),c.resize(s,l))},[o,p,s,l,a,u,c,h,r,i]}class Zf extends Ie{constructor(t){super(),Se(this,t,$f,qf,Ne,{data:0,width:2,height:3,viewType:4,isPreviewMode:5})}}const Kf=e=>({node:e&33554432,transform:e&1024}),Jr=e=>({node:e[25],transform:e[10]});function Qf(e){let t;const n=e[13].default,i=$t(n,e,e[18],Jr);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,o){i&&i.m(r,o),t=!0},p(r,o){i&&i.p&&(!t||o&33817600)&&Zt(i,n,r,r[18],t?Qt(n,r[18],o,Kf):Kt(r[18]),Jr)},i(r){t||(X(i,r),t=!0)},o(r){H(i,r),t=!1},d(r){i&&i.d(r)}}}function Jf(e){let t,n,i,r,o,s,l,a,u;return a=new Zf({props:{data:e[2],width:e[0],height:e[1],viewType:e[3],isPreviewMode:e[4],$$slots:{default:[Qf,({node:c,transform:p})=>({25:c,10:p}),({node:c,transform:p})=>(c?33554432:0)|(p?1024:0)]},$$scope:{ctx:e}}}),{c(){t=ee("div"),n=E("svg"),i=E("defs"),r=E("g"),o=E("svg"),s=E("g"),l=E("g"),se(a.$$.fragment),this.h()},l(c){t=te(c,"DIV",{class:!0});var p=w(t);n=N(p,"svg",{width:!0,height:!0,viewBox:!0,preserveAspectRatio:!0,class:!0});var d=w(n);i=N(d,"defs",{});var h=w(i);h.forEach(g),r=N(d,"g",{class:!0});var m=w(r);o=N(m,"svg",{width:!0,height:!0,overflow:!0});var v=w(o);s=N(v,"g",{}),w(s).forEach(g),v.forEach(g),m.forEach(g),l=N(d,"g",{class:!0});var I=w(l);ae(a.$$.fragment,I),I.forEach(g),d.forEach(g),p.forEach(g),this.h()},h(){f(o,"width","100%"),f(o,"height","100%"),f(o,"overflow","visible"),f(r,"class","background-layer svelte-1gyns6w"),f(l,"class","content-layer svelte-1gyns6w"),f(n,"width",e[0]),f(n,"height",e[1]),f(n,"viewBox",e[9]),f(n,"preserveAspectRatio","xMidYMid meet"),f(n,"class","graph-svg svelte-1gyns6w"),f(t,"class","graph-container svelte-1gyns6w")},m(c,p){z(c,t,p),_(t,n),_(n,i),_(n,r),_(r,o),_(o,s),e[14](s),_(n,l),le(a,l,null),e[15](l),e[16](n),e[17](t),u=!0},p(c,[p]){const d={};p&4&&(d.data=c[2]),p&1&&(d.width=c[0]),p&2&&(d.height=c[1]),p&8&&(d.viewType=c[3]),p&16&&(d.isPreviewMode=c[4]),p&33817600&&(d.$$scope={dirty:p,ctx:c}),a.$set(d),(!u||p&1)&&f(n,"width",c[0]),(!u||p&2)&&f(n,"height",c[1]),(!u||p&512)&&f(n,"viewBox",c[9])},i(c){u||(X(a.$$.fragment,c),u=!0)},o(c){H(a.$$.fragment,c),u=!1},d(c){c&&g(t),e[14](null),ue(a),e[15](null),e[16](null),e[17](null)}}}function ec(e,t,n){let{$$slots:i={},$$scope:r}=t,{data:o}=t,{width:s=6e3}=t,{height:l=4800}=t,{viewType:a}=t,{backgroundConfig:u={}}=t,{isPreviewMode:c=!1}=t,p=!1,d,h,m,v,I=null,y=Ai,b="0 0 3000 2400";const x={...ls,...u};function R(){if(!d)return;const V=d.getBoundingClientRect(),j=Math.max(V.width,1e3),T=Math.max(V.height,800);n(0,s=j),n(1,l=T),I&&I.resize(s,l),console.log("Dimensions updated:",{width:s,height:l}),D()}function A(){if(!m){console.log("No background group found");return}console.log("Creating background with config:",x),I&&I.destroy();try{I=new Wf(m,s,l,x),console.log("Background created:",I),I.start()}catch(V){console.error("Error initializing background:",V)}}function S(){if(!h||!v)return;const V=Gf().scaleExtent([.1,4]).on("zoom",j=>{n(10,y=j.transform),vt(v).attr("transform",y.toString())});vt(h).call(V).call(V.transform,Ai).on("contextmenu",j=>j.preventDefault())}function D(){if(!s||!l){console.log("Skipping viewBox update - no dimensions");return}const V=-Math.round(s/2),j=-Math.round(l/2),T=Math.round(s),C=Math.round(l);n(9,b=`${V} ${j} ${T} ${C}`),console.log("ViewBox updated:",{originX:V,originY:j,scaledWidth:T,scaledHeight:C,viewBox:b})}en(()=>{console.log("Graph mounting with data:",o),n(12,p=!0),R(),typeof window<"u"&&(window.addEventListener("resize",R),s&&l&&(console.log("Initializing graph with dimensions:",{width:s,height:l}),A(),S()))}),er(()=>{typeof window<"u"&&window.removeEventListener("resize",R),I&&I.destroy()});function F(V){st[V?"unshift":"push"](()=>{m=V,n(7,m)})}function q(V){st[V?"unshift":"push"](()=>{v=V,n(8,v)})}function U(V){st[V?"unshift":"push"](()=>{h=V,n(6,h)})}function $(V){st[V?"unshift":"push"](()=>{d=V,n(5,d)})}return e.$$set=V=>{"data"in V&&n(2,o=V.data),"width"in V&&n(0,s=V.width),"height"in V&&n(1,l=V.height),"viewType"in V&&n(3,a=V.viewType),"backgroundConfig"in V&&n(11,u=V.backgroundConfig),"isPreviewMode"in V&&n(4,c=V.isPreviewMode),"$$scope"in V&&n(18,r=V.$$scope)},e.$$.update=()=>{e.$$.dirty&4&&o&&console.log("Graph data updated:",o),e.$$.dirty&4099&&p&&s&&l&&R()},[s,l,o,a,c,d,h,m,v,b,y,u,p,i,F,q,U,$,r]}class tc extends Ie{constructor(t){super(),Se(this,t,ec,Jf,Ne,{data:2,width:0,height:1,viewType:3,backgroundConfig:11,isPreviewMode:4})}}function eo(e){return Object.prototype.toString.call(e)==="[object Date]"}function Ji(e,t,n,i){if(typeof n=="number"||eo(n)){const r=i-n,o=(n-t)/(e.dt||1/60),s=e.opts.stiffness*r,l=e.opts.damping*o,a=(s-l)*e.inv_mass,u=(o+a)*e.dt;return Math.abs(u)<e.opts.precision&&Math.abs(r)<e.opts.precision?i:(e.settled=!1,eo(n)?new Date(n.getTime()+u):n+u)}else{if(Array.isArray(n))return n.map((r,o)=>Ji(e,t[o],n[o],i[o]));if(typeof n=="object"){const r={};for(const o in n)r[o]=Ji(e,t[o],n[o],i[o]);return r}else throw new Error(`Cannot spring ${typeof n} values`)}}function us(e,t={}){const n=Do(e),{stiffness:i=.15,damping:r=.8,precision:o=.01}=t;let s,l,a,u=e,c=e,p=1,d=0,h=!1;function m(I,y={}){c=I;const b=a={};return e==null||y.hard||v.stiffness>=1&&v.damping>=1?(h=!0,s=br(),u=I,n.set(e=c),Promise.resolve()):(y.soft&&(d=1/((y.soft===!0?.5:+y.soft)*60),p=0),l||(s=br(),h=!1,l=As(x=>{if(h)return h=!1,l=null,!1;p=Math.min(p+d,1);const R={inv_mass:p,opts:v,settled:!0,dt:(x-s)*60/1e3},A=Ji(R,u,e,c);return s=x,u=e,n.set(e=A),R.settled&&(l=null),!R.settled})),new Promise(x=>{l.promise.then(()=>{b===a&&x()})}))}const v={set:m,update:(I,y)=>m(I(c,e),y),subscribe:n.subscribe,stiffness:i,damping:r,precision:o};return v}const nc=e=>({}),to=e=>({radius:e[2]});function ic(e){let t,n,i,r,o,s,l,a,u,c,p,d,h,m,v,I,y,b,x,R,A,S,D,F,q,U,$,V,j,T;const C=e[8].default,M=$t(C,e,e[7],to);return{c(){t=E("g"),n=E("defs"),i=E("filter"),r=E("feGaussianBlur"),o=E("feFlood"),s=E("feComposite"),l=E("feGaussianBlur"),a=E("feFlood"),u=E("feComposite"),c=E("feGaussianBlur"),p=E("feFlood"),d=E("feComposite"),h=E("feMerge"),m=E("feMergeNode"),v=E("feMergeNode"),I=E("feMergeNode"),y=E("feMergeNode"),b=E("radialGradient"),x=E("stop"),R=E("stop"),A=E("stop"),S=E("circle"),D=E("circle"),F=E("circle"),q=E("circle"),U=E("circle"),$=E("circle"),M&&M.c(),this.h()},l(O){t=N(O,"g",{class:!0,transform:!0});var k=w(t);n=N(k,"defs",{});var G=w(n);i=N(G,"filter",{id:!0,x:!0,y:!0,width:!0,height:!0});var Y=w(i);r=N(Y,"feGaussianBlur",{in:!0,stdDeviation:!0,result:!0}),w(r).forEach(g),o=N(Y,"feFlood",{"flood-color":!0,"flood-opacity":!0,result:!0}),w(o).forEach(g),s=N(Y,"feComposite",{in:!0,in2:!0,operator:!0,result:!0}),w(s).forEach(g),l=N(Y,"feGaussianBlur",{in:!0,stdDeviation:!0,result:!0}),w(l).forEach(g),a=N(Y,"feFlood",{"flood-color":!0,"flood-opacity":!0,result:!0}),w(a).forEach(g),u=N(Y,"feComposite",{in:!0,in2:!0,operator:!0,result:!0}),w(u).forEach(g),c=N(Y,"feGaussianBlur",{in:!0,stdDeviation:!0,result:!0}),w(c).forEach(g),p=N(Y,"feFlood",{"flood-color":!0,"flood-opacity":!0,result:!0}),w(p).forEach(g),d=N(Y,"feComposite",{in:!0,in2:!0,operator:!0,result:!0}),w(d).forEach(g),h=N(Y,"feMerge",{});var K=w(h);m=N(K,"feMergeNode",{in:!0}),w(m).forEach(g),v=N(K,"feMergeNode",{in:!0}),w(v).forEach(g),I=N(K,"feMergeNode",{in:!0}),w(I).forEach(g),y=N(K,"feMergeNode",{in:!0}),w(y).forEach(g),K.forEach(g),Y.forEach(g),b=N(G,"radialGradient",{id:!0});var ne=w(b);x=N(ne,"stop",{offset:!0,"stop-color":!0}),w(x).forEach(g),R=N(ne,"stop",{offset:!0,"stop-color":!0,"stop-opacity":!0}),w(R).forEach(g),A=N(ne,"stop",{offset:!0,"stop-color":!0,"stop-opacity":!0}),w(A).forEach(g),ne.forEach(g),G.forEach(g),S=N(k,"circle",{r:!0,class:!0}),w(S).forEach(g),D=N(k,"circle",{r:!0,class:!0}),w(D).forEach(g),F=N(k,"circle",{r:!0,class:!0}),w(F).forEach(g),q=N(k,"circle",{r:!0,class:!0}),w(q).forEach(g),U=N(k,"circle",{r:!0,class:!0,filter:!0}),w(U).forEach(g),$=N(k,"circle",{r:!0,class:!0}),w($).forEach(g),M&&M.l(k),k.forEach(g),this.h()},h(){f(r,"in","SourceAlpha"),f(r,"stdDeviation","8"),f(r,"result","blur1"),f(o,"flood-color",e[1]),f(o,"flood-opacity","0.6"),f(o,"result","color1"),f(s,"in","color1"),f(s,"in2","blur1"),f(s,"operator","in"),f(s,"result","shadow1"),f(l,"in","SourceAlpha"),f(l,"stdDeviation","4"),f(l,"result","blur2"),f(a,"flood-color",e[1]),f(a,"flood-opacity","0.8"),f(a,"result","color2"),f(u,"in","color2"),f(u,"in2","blur2"),f(u,"operator","in"),f(u,"result","shadow2"),f(c,"in","SourceAlpha"),f(c,"stdDeviation","1"),f(c,"result","blur3"),f(p,"flood-color",e[1]),f(p,"flood-opacity","1"),f(p,"result","color3"),f(d,"in","color3"),f(d,"in2","blur3"),f(d,"operator","in"),f(d,"result","shadow3"),f(m,"in","shadow1"),f(v,"in","shadow2"),f(I,"in","shadow3"),f(y,"in","SourceGraphic"),f(i,"id",e[3]),f(i,"x","-100%"),f(i,"y","-100%"),f(i,"width","300%"),f(i,"height","300%"),f(x,"offset","0%"),f(x,"stop-color","rgba(0,0,0,0)"),f(R,"offset","85%"),f(R,"stop-color",e[1]),f(R,"stop-opacity","0.5"),f(A,"offset","100%"),f(A,"stop-color",e[1]),f(A,"stop-opacity","0.1"),f(b,"id",e[4]),f(S,"r",e[2]),f(S,"class","background-layer-1 svelte-23hgqn"),f(D,"r",e[2]-4),f(D,"class","background-layer-2 svelte-23hgqn"),f(F,"r",e[2]-8),f(F,"class","background-layer-3 svelte-23hgqn"),f(q,"r",e[2]-12),f(q,"class","content-background svelte-23hgqn"),f(U,"r",e[2]),f(U,"class","outer-ring svelte-23hgqn"),f(U,"filter",`url(#${e[3]})`),re(U,"stroke",e[1]),re(U,"stroke-opacity","5.5"),f($,"r",e[2]),f($,"class","middle-ring svelte-23hgqn"),f(t,"class","base-node svelte-23hgqn"),f(t,"transform",e[0])},m(O,k){z(O,t,k),_(t,n),_(n,i),_(i,r),_(i,o),_(i,s),_(i,l),_(i,a),_(i,u),_(i,c),_(i,p),_(i,d),_(i,h),_(h,m),_(h,v),_(h,I),_(h,y),_(n,b),_(b,x),_(b,R),_(b,A),_(t,S),_(t,D),_(t,F),_(t,q),_(t,U),_(t,$),M&&M.m(t,null),V=!0,j||(T=Ee(t,"click",e[5]),j=!0)},p(O,[k]){(!V||k&2)&&f(o,"flood-color",O[1]),(!V||k&2)&&f(a,"flood-color",O[1]),(!V||k&2)&&f(p,"flood-color",O[1]),(!V||k&2)&&f(R,"stop-color",O[1]),(!V||k&2)&&f(A,"stop-color",O[1]),k&2&&re(U,"stroke",O[1]),M&&M.p&&(!V||k&128)&&Zt(M,C,O,O[7],V?Qt(C,O[7],k,nc):Kt(O[7]),to),(!V||k&1)&&f(t,"transform",O[0])},i(O){V||(X(M,O),V=!0)},o(O){H(M,O),V=!1},d(O){O&&g(t),M&&M.d(O),j=!1,T()}}}function rc(e,t,n){let i,{$$slots:r={},$$scope:o}=t,{transform:s}=t,{style:l}=t;const a=l.previewSize/2,u=`glow-${Math.random().toString(36).slice(2)}`,c=`gradient-${Math.random().toString(36).slice(2)}`,p=tt();function d(){p("click")}return e.$$set=h=>{"transform"in h&&n(0,s=h.transform),"style"in h&&n(6,l=h.style),"$$scope"in h&&n(7,o=h.$$scope)},e.$$.update=()=>{e.$$.dirty&64&&n(1,i=l.highlightColor||"#FFFFFF")},[s,i,a,u,c,d,l,o,r]}class fs extends Ie{constructor(t){super(),Se(this,t,rc,ic,Ne,{transform:0,style:6})}}const oc=e=>({radius:e&1}),no=e=>({radius:e[0]});function sc(e){let t;const n=e[5].default,i=$t(n,e,e[6],no);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,o){i&&i.m(r,o),t=!0},p(r,o){i&&i.p&&(!t||o&65)&&Zt(i,n,r,r[6],t?Qt(n,r[6],o,oc):Kt(r[6]),no)},i(r){t||(X(i,r),t=!0)},o(r){H(i,r),t=!1},d(r){i&&i.d(r)}}}function ac(e){let t,n,i;return n=new fs({props:{transform:"",style:e[1],$$slots:{default:[sc]},$$scope:{ctx:e}}}),{c(){t=E("g"),se(n.$$.fragment),this.h()},l(r){t=N(r,"g",{class:!0});var o=w(t);ae(n.$$.fragment,o),o.forEach(g),this.h()},h(){f(t,"class","detail-node svelte-1ebasdh"),re(t,"opacity",e[2]),re(t,"transform-origin","center")},m(r,o){z(r,t,o),le(n,t,null),i=!0},p(r,[o]){const s={};o&2&&(s.style=r[1]),o&65&&(s.$$scope={dirty:o,ctx:r}),n.$set(s),o&4&&re(t,"opacity",r[2])},i(r){i||(X(n.$$.fragment,r),i=!0)},o(r){H(n.$$.fragment,r),i=!1},d(r){r&&g(t),ue(n)}}}function lc(e,t,n){let i,r,o,{$$slots:s={},$$scope:l}=t,{style:a}=t;const u=us(0,{stiffness:.3,damping:.8});return Ut(e,u,c=>n(2,o=c)),en(()=>{u.set(1)}),e.$$set=c=>{"style"in c&&n(4,a=c.style),"$$scope"in c&&n(6,l=c.$$scope)},e.$$.update=()=>{e.$$.dirty&16&&n(1,i={...a,previewSize:Nr*2})},n(0,r=Nr),[r,i,o,u,a,s,l]}class ai extends Ie{constructor(t){super(),Se(this,t,lc,ac,Ne,{style:4})}}function io(e,t,n){const i=e.slice();return i[7]=t[n],i[9]=n,i}function ro(e){let t,n=e[7].text+"",i,r,o;return{c(){t=E("text"),i=P(n),this.h()},l(s){t=N(s,"text",{x:!0,dy:!0,class:!0});var l=w(t);i=L(l,n),l.forEach(g),this.h()},h(){f(t,"x",r=e[7].x),f(t,"dy",o=25+e[7].dy),f(t,"class","value left-align svelte-1w67vw4")},m(s,l){z(s,t,l),_(t,i)},p(s,l){l&4&&n!==(n=s[7].text+"")&&ce(i,n),l&4&&r!==(r=s[7].x)&&f(t,"x",r),l&4&&o!==(o=25+s[7].dy)&&f(t,"dy",o)},d(s){s&&g(t)}}}function oo(e){let t,n,i,r,o,s,l,a,u,c=e[1].nodesCreated+"",p,d,h,m,v,I,y,b=e[1].votesCast+"",x,R;return{c(){t=E("g"),n=E("text"),i=P(`activity stats:
                `),r=E("g"),o=E("text"),s=P(`nodes created
                    `),l=E("text"),a=P(`=
                    `),u=E("text"),p=P(c),d=E("g"),h=E("text"),m=P(`votes cast
                    `),v=E("text"),I=P(`=
                    `),y=E("text"),x=P(b),this.h()},l(A){t=N(A,"g",{transform:!0});var S=w(t);n=N(S,"text",{x:!0,class:!0});var D=w(n);i=L(D,`activity stats:
                `),D.forEach(g),r=N(S,"g",{transform:!0});var F=w(r);o=N(F,"text",{x:!0,class:!0});var q=w(o);s=L(q,`nodes created
                    `),q.forEach(g),l=N(F,"text",{class:!0});var U=w(l);a=L(U,`=
                    `),U.forEach(g),u=N(F,"text",{x:!0,class:!0});var $=w(u);p=L($,c),$.forEach(g),F.forEach(g),d=N(S,"g",{transform:!0});var V=w(d);h=N(V,"text",{x:!0,class:!0});var j=w(h);m=L(j,`votes cast
                    `),j.forEach(g),v=N(V,"text",{class:!0});var T=w(v);I=L(T,`=
                    `),T.forEach(g),y=N(V,"text",{x:!0,class:!0});var C=w(y);x=L(C,b),C.forEach(g),V.forEach(g),S.forEach(g),this.h()},h(){f(n,"x",e[3].labelX),f(n,"class","label left-align svelte-1w67vw4"),f(o,"x",e[3].labelX),f(o,"class","value left-align svelte-1w67vw4"),f(l,"class","value svelte-1w67vw4"),f(u,"x",e[3].valueX),f(u,"class","value left-align svelte-1w67vw4"),f(r,"transform","translate(0, 30)"),f(h,"x",e[3].labelX),f(h,"class","value left-align svelte-1w67vw4"),f(v,"class","value svelte-1w67vw4"),f(y,"x",e[3].valueX),f(y,"class","value left-align svelte-1w67vw4"),f(d,"transform","translate(0, 60)"),f(t,"transform",R="translate(0, "+(-e[5]+390)+")")},m(A,S){z(A,t,S),_(t,n),_(n,i),_(t,r),_(r,o),_(o,s),_(r,l),_(l,a),_(r,u),_(u,p),_(t,d),_(d,h),_(h,m),_(d,v),_(v,I),_(d,y),_(y,x)},p(A,S){S&2&&c!==(c=A[1].nodesCreated+"")&&ce(p,c),S&2&&b!==(b=A[1].votesCast+"")&&ce(x,b),S&32&&R!==(R="translate(0, "+(-A[5]+390)+")")&&f(t,"transform",R)},d(A){A&&g(t)}}}function uc(e){let t,n,i,r,o,s,l,a,u=(e[0].preferred_username||e[0].name||e[0].nickname||"User")+"",c,p,d,h,m,v,I,y,b,x=Tt(e[2]),R=[];for(let S=0;S<x.length;S+=1)R[S]=ro(io(e,x,S));let A=e[1]&&oo(e);return{c(){t=E("text"),n=P("ProjectZer0"),r=de(),o=E("g"),s=E("text"),l=P(`name:
            `),a=E("text"),c=P(u),d=de(),h=E("g"),m=E("text"),v=P(`mission statement:
            `);for(let S=0;S<R.length;S+=1)R[S].c();y=de(),A&&A.c(),b=Te(),this.h()},l(S){t=N(S,"text",{dy:!0,class:!0});var D=w(t);n=L(D,"ProjectZer0"),D.forEach(g),r=ge(S),o=N(S,"g",{transform:!0});var F=w(o);s=N(F,"text",{x:!0,class:!0});var q=w(s);l=L(q,`name:
            `),q.forEach(g),a=N(F,"text",{x:!0,dy:!0,class:!0});var U=w(a);c=L(U,u),U.forEach(g),F.forEach(g),d=ge(S),h=N(S,"g",{transform:!0});var $=w(h);m=N($,"text",{x:!0,class:!0});var V=w(m);v=L(V,`mission statement:
            `),V.forEach(g);for(let j=0;j<R.length;j+=1)R[j].l($);$.forEach(g),y=ge(S),A&&A.l(S),b=Te(),this.h()},h(){f(t,"dy",i=-e[5]+120),f(t,"class","title svelte-1w67vw4"),f(s,"x",e[3].labelX),f(s,"class","label left-align svelte-1w67vw4"),f(a,"x",e[3].labelX),f(a,"dy","25"),f(a,"class","value left-align svelte-1w67vw4"),f(o,"transform",p="translate(0, "+(-e[5]+170)+")"),f(m,"x",e[3].labelX),f(m,"class","label left-align svelte-1w67vw4"),f(h,"transform",I="translate(0, "+(-e[5]+230)+")")},m(S,D){z(S,t,D),_(t,n),z(S,r,D),z(S,o,D),_(o,s),_(s,l),_(o,a),_(a,c),z(S,d,D),z(S,h,D),_(h,m),_(m,v);for(let F=0;F<R.length;F+=1)R[F]&&R[F].m(h,null);z(S,y,D),A&&A.m(S,D),z(S,b,D)},p(S,D){if(D&32&&i!==(i=-S[5]+120)&&f(t,"dy",i),D&1&&u!==(u=(S[0].preferred_username||S[0].name||S[0].nickname||"User")+"")&&ce(c,u),D&32&&p!==(p="translate(0, "+(-S[5]+170)+")")&&f(o,"transform",p),D&4){x=Tt(S[2]);let F;for(F=0;F<x.length;F+=1){const q=io(S,x,F);R[F]?R[F].p(q,D):(R[F]=ro(q),R[F].c(),R[F].m(h,null))}for(;F<R.length;F+=1)R[F].d(1);R.length=x.length}D&32&&I!==(I="translate(0, "+(-S[5]+230)+")")&&f(h,"transform",I),S[1]?A?A.p(S,D):(A=oo(S),A.c(),A.m(b.parentNode,b)):A&&(A.d(1),A=null)},d(S){S&&(g(t),g(r),g(o),g(d),g(h),g(y),g(b)),Oi(R,S),A&&A.d(S)}}}function fc(e){let t,n;return t=new ai({props:{style:e[4],$$slots:{default:[uc,({radius:i,isHovered:r})=>({5:i,6:r}),({radius:i,isHovered:r})=>(i?32:0)|(r?64:0)]},$$scope:{ctx:e}}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,[r]){const o={};r&1063&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function cc(e,t,n){const i=e.split(" "),r=[];let o="",s=0;const l=document.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("font-family","Orbitron"),l.setAttribute("font-size","14px"),l.setAttribute("x","-1000"),l.setAttribute("y","-1000");const a=document.querySelector("svg");return a&&(a.appendChild(l),i.forEach(u=>{const c=o+(o?" ":"")+u;l.textContent=c,l.getComputedTextLength()>t&&o!==""?(r.push({text:o,x:n,dy:s*20}),o=u,s++):o=c}),o&&r.push({text:o,x:n,dy:s*20}),a.removeChild(l)),r}function hc(e,t,n){let i,{node:r}=t,{userActivity:o}=t;const s={labelX:-200,equalsX:0,valueX:30},l={previewSize:B.SIZES.DASHBOARD.size,detailSize:B.SIZES.DASHBOARD.size,colors:B.COLORS.DASHBOARD,padding:B.PADDING,lineHeight:B.LINE_HEIGHT,stroke:B.STROKE};return e.$$set=a=>{"node"in a&&n(0,r=a.node),"userActivity"in a&&n(1,o=a.userActivity)},e.$$.update=()=>{e.$$.dirty&1&&n(2,i=cc(r.mission_statement||"no mission statement set.",420,s.labelX))},[r,o,i,s,l]}class dc extends Ie{constructor(t){super(),Se(this,t,hc,fc,Ne,{node:0,userActivity:1})}}async function gc(e){try{console.log("Updating user profile...");const t=await Xe("/users/update-profile",{method:"POST",body:JSON.stringify(e)});return console.log("User profile updated:",t),t}catch(t){return console.error("Error updating user profile:",t),null}}const Z={layout:{leftAlign:-200,fieldWidth:400,buttonWidth:150,verticalSpacing:{betweenFields:75,labelToInput:10}},inputs:{background:"rgba(0, 0, 0, 0.9)",border:{default:"2px solid rgba(255, 255, 255, 0.3)",focus:"3px solid rgba(255, 255, 255, 0.8)",error:"2px solid #ff4444"},text:"white",borderRadius:"4px",padding:"8px",font:{family:"Orbitron",size:"0.9rem"},shadow:{focus:"0 0 0 1px rgba(255, 255, 255, 0.3)"}},buttons:{save:{background:"rgba(74, 144, 226, 0.3)",border:"1px solid rgba(74, 144, 226, 0.4)",hoverBg:"rgba(74, 144, 226, 0.4)"}},text:{label:{size:"14px",color:"rgba(255, 255, 255, 0.7)"},characterCount:{size:"12px",color:"rgba(255, 255, 255, 0.6)",warning:"#ffd700",error:"#ff4444"}}};function pc(e){let t,n,i,r,o,s,l;return{c(){t=E("text"),n=P("Username:"),i=de(),r=E("foreignObject"),o=ee("input"),this.h()},l(a){t=N(a,"text",{x:!0,class:!0});var u=w(t);n=L(u,"Username:"),u.forEach(g),i=ge(a),r=N(a,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var c=w(r);o=te(c,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),c.forEach(g),this.h()},h(){f(t,"x",Z.layout.leftAlign),f(t,"class","label svelte-1n43n7y"),f(o,"type","text"),f(o,"id","username-input"),f(o,"placeholder","Enter username"),f(o,"class","input"),o.disabled=e[1],f(r,"x",Z.layout.leftAlign),f(r,"y",Z.layout.verticalSpacing.labelToInput),f(r,"width",Z.layout.fieldWidth),f(r,"height","40")},m(a,u){z(a,t,u),_(t,n),z(a,i,u),z(a,r,u),_(r,o),Fe(o,e[0]),s||(l=Ee(o,"input",e[2]),s=!0)},p(a,[u]){u&2&&(o.disabled=a[1]),u&1&&o.value!==a[0]&&Fe(o,a[0])},i:xe,o:xe,d(a){a&&(g(t),g(i),g(r)),s=!1,l()}}}function _c(e,t,n){let{username:i=""}=t,{disabled:r=!1}=t;function o(){i=this.value,n(0,i)}return e.$$set=s=>{"username"in s&&n(0,i=s.username),"disabled"in s&&n(1,r=s.disabled)},[i,r,o]}class mc extends Ie{constructor(t){super(),Se(this,t,_c,pc,Ne,{username:0,disabled:1})}}function vc(e){let t,n,i,r,o,s,l;return{c(){t=E("g"),n=E("text"),i=P(`Email:
    `),r=E("foreignObject"),o=ee("input"),this.h()},l(a){t=N(a,"g",{});var u=w(t);n=N(u,"text",{x:!0,y:!0,class:!0});var c=w(n);i=L(c,`Email:
    `),c.forEach(g),r=N(u,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var p=w(r);o=te(p,"INPUT",{type:!0,placeholder:!0,class:!0}),p.forEach(g),u.forEach(g),this.h()},h(){f(n,"x",Z.layout.leftAlign),f(n,"y",Z.layout.verticalSpacing.betweenFields),f(n,"class","label svelte-1jbaojg"),f(o,"type","email"),f(o,"placeholder","Enter email"),f(o,"class","input"),o.disabled=e[1],f(r,"x",Z.layout.leftAlign),f(r,"y",Z.layout.verticalSpacing.betweenFields+Z.layout.verticalSpacing.labelToInput),f(r,"width",Z.layout.fieldWidth),f(r,"height","40")},m(a,u){z(a,t,u),_(t,n),_(n,i),_(t,r),_(r,o),Fe(o,e[0]),s||(l=Ee(o,"input",e[2]),s=!0)},p(a,[u]){u&2&&(o.disabled=a[1]),u&1&&o.value!==a[0]&&Fe(o,a[0])},i:xe,o:xe,d(a){a&&g(t),s=!1,l()}}}function wc(e,t,n){let{email:i=""}=t,{disabled:r=!1}=t;function o(){i=this.value,n(0,i)}return e.$$set=s=>{"email"in s&&n(0,i=s.email),"disabled"in s&&n(1,r=s.disabled)},[i,r,o]}class yc extends Ie{constructor(t){super(),Se(this,t,wc,vc,Ne,{email:0,disabled:1})}}function bc(e){let t,n,i,r,o,s,l,a,u,c;return{c(){t=E("g"),n=E("text"),i=P(`Mission Statement:
    `),r=E("foreignObject"),o=ee("textarea"),s=E("text"),l=P(e[2]),a=P(" characters remaining"),this.h()},l(p){t=N(p,"g",{});var d=w(t);n=N(d,"text",{x:!0,y:!0,class:!0});var h=w(n);i=L(h,`Mission Statement:
    `),h.forEach(g),r=N(d,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var m=w(r);o=te(m,"TEXTAREA",{id:!0,placeholder:!0,class:!0,maxlength:!0}),w(o).forEach(g),m.forEach(g),s=N(d,"text",{x:!0,y:!0,class:!0});var v=w(s);l=L(v,e[2]),a=L(v," characters remaining"),v.forEach(g),d.forEach(g),this.h()},h(){f(n,"x",Z.layout.leftAlign),f(n,"y",Z.layout.verticalSpacing.betweenFields*2),f(n,"class","label svelte-34co8w"),f(o,"id","mission-statement-input"),f(o,"placeholder","Enter mission statement"),f(o,"class","textarea"),f(o,"maxlength",cs),o.disabled=e[1],f(r,"x",Z.layout.leftAlign),f(r,"y",Z.layout.verticalSpacing.betweenFields*2+Z.layout.verticalSpacing.labelToInput),f(r,"width",Z.layout.fieldWidth),f(r,"height","150"),f(s,"x",Z.layout.leftAlign+Z.layout.fieldWidth),f(s,"y",Z.layout.verticalSpacing.betweenFields*2+145),f(s,"class","character-count svelte-34co8w"),he(s,"near-limit",e[4]),he(s,"over-limit",e[3])},m(p,d){z(p,t,d),_(t,n),_(n,i),_(t,r),_(r,o),Fe(o,e[0]),_(t,s),_(s,l),_(s,a),u||(c=Ee(o,"input",e[5]),u=!0)},p(p,[d]){d&2&&(o.disabled=p[1]),d&1&&Fe(o,p[0]),d&4&&ce(l,p[2]),d&16&&he(s,"near-limit",p[4]),d&8&&he(s,"over-limit",p[3])},i:xe,o:xe,d(p){p&&g(t),u=!1,c()}}}const cs=280;function Ec(e,t,n){let i,r,o,{statement:s=""}=t,{disabled:l=!1}=t;function a(){s=this.value,n(0,s)}return e.$$set=u=>{"statement"in u&&n(0,s=u.statement),"disabled"in u&&n(1,l=u.disabled)},e.$$.update=()=>{e.$$.dirty&1&&n(2,i=cs-s.length),e.$$.dirty&4&&n(4,r=i<=20),e.$$.dirty&4&&n(3,o=i<0)},[s,l,i,o,r,a]}class Nc extends Ie{constructor(t){super(),Se(this,t,Ec,bc,Ne,{statement:0,disabled:1})}}function Ic(e){let t;return{c(){t=P("Save Changes")},l(n){t=L(n,"Save Changes")},m(n,i){z(n,t,i)},d(n){n&&g(t)}}}function Sc(e){let t;return{c(){t=P("Loading...")},l(n){t=L(n,"Loading...")},m(n,i){z(n,t,i)},d(n){n&&g(t)}}}function Rc(e){let t,n,i,r;function o(a,u){return a[0]?Sc:Ic}let s=o(e),l=s(e);return{c(){t=E("foreignObject"),n=ee("button"),l.c(),this.h()},l(a){t=N(a,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var u=w(t);n=te(u,"BUTTON",{class:!0});var c=w(n);l.l(c),c.forEach(g),u.forEach(g),this.h()},h(){f(n,"class","save-button"),n.disabled=e[1],f(t,"x",-Z.layout.buttonWidth/2),f(t,"y",Z.layout.verticalSpacing.betweenFields*2+190),f(t,"width",Z.layout.buttonWidth),f(t,"height","40")},m(a,u){z(a,t,u),_(t,n),l.m(n,null),i||(r=Ee(n,"click",function(){tr(e[2])&&e[2].apply(this,arguments)}),i=!0)},p(a,[u]){e=a,s!==(s=o(e))&&(l.d(1),l=s(e),l&&(l.c(),l.m(n,null))),u&2&&(n.disabled=e[1])},i:xe,o:xe,d(a){a&&g(t),l.d(),i=!1,r()}}}function xc(e,t,n){let{loading:i}=t,{disabled:r}=t,{onClick:o}=t;return e.$$set=s=>{"loading"in s&&n(0,i=s.loading),"disabled"in s&&n(1,r=s.disabled),"onClick"in s&&n(2,o=s.onClick)},[i,r,o]}class Ac extends Ie{constructor(t){super(),Se(this,t,xc,Rc,Ne,{loading:0,disabled:1,onClick:2})}}function so(e){let t,n;return{c(){t=E("text"),n=P("Profile updated successfully! Redirecting..."),this.h()},l(i){t=N(i,"text",{x:!0,y:!0,class:!0});var r=w(t);n=L(r,"Profile updated successfully! Redirecting..."),r.forEach(g),this.h()},h(){f(t,"x","0"),f(t,"y",Z.layout.verticalSpacing.betweenFields*2+190),f(t,"class","success svelte-f1lcoa")},m(i,r){z(i,t,r),_(t,n)},d(i){i&&g(t)}}}function Tc(e){let t,n,i,r,o,s,l,a,u,c,p,d,h,m;function v(S){e[8](S)}let I={disabled:e[4]};e[0]!==void 0&&(I.username=e[0]),s=new mc({props:I}),st.push(()=>mn(s,"username",v));function y(S){e[9](S)}let b={disabled:e[4]};e[1]!==void 0&&(b.email=e[1]),a=new yc({props:b}),st.push(()=>mn(a,"email",y));function x(S){e[10](S)}let R={disabled:e[4]};e[2]!==void 0&&(R.statement=e[2]),c=new Nc({props:R}),st.push(()=>mn(c,"statement",x)),d=new Ac({props:{loading:e[4],disabled:e[4],onClick:e[6]}});let A=e[3]&&so();return{c(){t=E("text"),n=P("Edit Profile"),r=de(),o=E("g"),se(s.$$.fragment),se(a.$$.fragment),se(c.$$.fragment),se(d.$$.fragment),A&&A.c(),this.h()},l(S){t=N(S,"text",{dy:!0,class:!0});var D=w(t);n=L(D,"Edit Profile"),D.forEach(g),r=ge(S),o=N(S,"g",{transform:!0});var F=w(o);ae(s.$$.fragment,F),ae(a.$$.fragment,F),ae(c.$$.fragment,F),ae(d.$$.fragment,F),A&&A.l(F),F.forEach(g),this.h()},h(){f(t,"dy",i=-e[11]+120),f(t,"class","title svelte-f1lcoa"),f(o,"transform",h="translate(0, "+(-e[11]+150)+")")},m(S,D){z(S,t,D),_(t,n),z(S,r,D),z(S,o,D),le(s,o,null),le(a,o,null),le(c,o,null),le(d,o,null),A&&A.m(o,null),m=!0},p(S,D){(!m||D&2048&&i!==(i=-S[11]+120))&&f(t,"dy",i);const F={};D&16&&(F.disabled=S[4]),!l&&D&1&&(l=!0,F.username=S[0],_n(()=>l=!1)),s.$set(F);const q={};D&16&&(q.disabled=S[4]),!u&&D&2&&(u=!0,q.email=S[1],_n(()=>u=!1)),a.$set(q);const U={};D&16&&(U.disabled=S[4]),!p&&D&4&&(p=!0,U.statement=S[2],_n(()=>p=!1)),c.$set(U);const $={};D&16&&($.loading=S[4]),D&16&&($.disabled=S[4]),d.$set($),S[3]?A||(A=so(),A.c(),A.m(o,null)):A&&(A.d(1),A=null),(!m||D&2048&&h!==(h="translate(0, "+(-S[11]+150)+")"))&&f(o,"transform",h)},i(S){m||(X(s.$$.fragment,S),X(a.$$.fragment,S),X(c.$$.fragment,S),X(d.$$.fragment,S),m=!0)},o(S){H(s.$$.fragment,S),H(a.$$.fragment,S),H(c.$$.fragment,S),H(d.$$.fragment,S),m=!1},d(S){S&&(g(t),g(r),g(o)),ue(s),ue(a),ue(c),ue(d),A&&A.d()}}}function Oc(e){let t,n;return t=new ai({props:{style:e[5],$$slots:{default:[Tc,({radius:i,isHovered:r})=>({11:i,12:r}),({radius:i,isHovered:r})=>(i?2048:0)|(r?4096:0)]},$$scope:{ctx:e}}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,[r]){const o={};r&10271&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function Mc(e,t,n){let{node:i}=t,r=i.preferred_username||"",o=i.email||"",s=i.mission_statement||"",l=!1,a=!1;const u={previewSize:B.SIZES.WORD.detail,detailSize:B.SIZES.WORD.detail,colors:B.COLORS.WORD,padding:B.PADDING,lineHeight:B.LINE_HEIGHT,stroke:B.STROKE};async function c(){n(4,a=!0);try{const m=await gc({sub:i.sub,preferred_username:r,email:o,mission_statement:s});m&&(wn.set(m),n(3,l=!0),setTimeout(()=>mt("/graph/dashboard"),2e3))}catch(m){console.error("Failed to update profile:",m)}finally{n(4,a=!1)}}function p(m){r=m,n(0,r)}function d(m){o=m,n(1,o)}function h(m){s=m,n(2,s)}return e.$$set=m=>{"node"in m&&n(7,i=m.node)},[r,o,s,l,a,u,c,i,p,d,h]}class Dc extends Ie{constructor(t){super(),Se(this,t,Mc,Oc,Ne,{node:7})}}function ao(e){let t,n,i,r,o,s,l;return{c(){t=E("foreignObject"),n=ee("div"),i=ee("button"),r=P(e[2]),o=de(),this.h()},l(a){t=N(a,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var u=w(t);n=te(u,"DIV",{class:!0});var c=w(n);i=te(c,"BUTTON",{class:!0});var p=w(i);r=L(p,e[2]),p.forEach(g),o=ge(c),c.forEach(g),u.forEach(g),this.h()},h(){f(i,"class","form-button"),i.disabled=e[4],f(n,"class","button-wrapper svelte-15go4qa"),f(t,"x","0"),f(t,"y","0"),f(t,"width",Z.layout.buttonWidth),f(t,"height","50")},m(a,u){z(a,t,u),_(t,n),_(n,i),_(i,r),_(n,o),s||(l=Ee(i,"click",function(){tr(e[0])&&e[0].apply(this,arguments)}),s=!0)},p(a,u){e=a,u&4&&ce(r,e[2]),u&16&&(i.disabled=e[4])},d(a){a&&g(t),s=!1,l()}}}function kc(e){let t;return{c(){t=P(e[3])},l(n){t=L(n,e[3])},m(n,i){z(n,t,i)},p(n,i){i&8&&ce(t,n[3])},d(n){n&&g(t)}}}function Cc(e){let t;return{c(){t=P("Loading...")},l(n){t=L(n,"Loading...")},m(n,i){z(n,t,i)},p:xe,d(n){n&&g(t)}}}function Pc(e){let t,n,i,r,o,s,l,a,u=e[6]&&ao(e);function c(h,m){return h[4]?Cc:kc}let p=c(e),d=p(e);return{c(){t=E("g"),u&&u.c(),n=E("foreignObject"),i=ee("div"),r=ee("button"),d.c(),this.h()},l(h){t=N(h,"g",{transform:!0});var m=w(t);u&&u.l(m),n=N(m,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var v=w(n);i=te(v,"DIV",{class:!0});var I=w(i);r=te(I,"BUTTON",{class:!0});var y=w(r);d.l(y),y.forEach(g),I.forEach(g),v.forEach(g),m.forEach(g),this.h()},h(){f(r,"class","form-button primary"),r.disabled=o=e[4]||e[5],f(i,"class","button-wrapper svelte-15go4qa"),f(n,"x",s=e[6]?Z.layout.fieldWidth-Z.layout.buttonWidth:Z.layout.fieldWidth/2-Z.layout.buttonWidth/2),f(n,"y","0"),f(n,"width",Z.layout.buttonWidth),f(n,"height","50"),f(t,"transform","translate("+Z.layout.leftAlign+", 0)")},m(h,m){z(h,t,m),u&&u.m(t,null),_(t,n),_(n,i),_(i,r),d.m(r,null),l||(a=Ee(r,"click",function(){tr(e[1])&&e[1].apply(this,arguments)}),l=!0)},p(h,[m]){e=h,e[6]?u?u.p(e,m):(u=ao(e),u.c(),u.m(t,n)):u&&(u.d(1),u=null),p===(p=c(e))&&d?d.p(e,m):(d.d(1),d=p(e),d&&(d.c(),d.m(r,null))),m&48&&o!==(o=e[4]||e[5])&&(r.disabled=o),m&64&&s!==(s=e[6]?Z.layout.fieldWidth-Z.layout.buttonWidth:Z.layout.fieldWidth/2-Z.layout.buttonWidth/2)&&f(n,"x",s)},i:xe,o:xe,d(h){h&&g(t),u&&u.d(),d.d(),l=!1,a()}}}function Lc(e,t,n){let{onBack:i}=t,{onNext:r}=t,{backLabel:o="Back"}=t,{nextLabel:s="Next"}=t,{loading:l=!1}=t,{nextDisabled:a=!1}=t,{showBackButton:u=!0}=t;return e.$$set=c=>{"onBack"in c&&n(0,i=c.onBack),"onNext"in c&&n(1,r=c.onNext),"backLabel"in c&&n(2,o=c.backLabel),"nextLabel"in c&&n(3,s=c.nextLabel),"loading"in c&&n(4,l=c.loading),"nextDisabled"in c&&n(5,a=c.nextDisabled),"showBackButton"in c&&n(6,u=c.showBackButton)},[i,r,o,s,l,a,u]}class li extends Ie{constructor(t){super(),Se(this,t,Lc,Pc,Ne,{onBack:0,onNext:1,backLabel:2,nextLabel:3,loading:4,nextDisabled:5,showBackButton:6})}}function Fc(e){let t,n,i,r,o,s,l="Choose type...",a,u="Word",c,p="Statement",d,h="Quantity",m,v,I,y,b;return v=new li({props:{onBack:e[3],onNext:e[6],nextLabel:"Continue",nextDisabled:!e[0]||e[1],showBackButton:!1}}),{c(){t=E("g"),n=E("text"),i=P(`Select Node Type
    `),r=E("foreignObject"),o=ee("select"),s=ee("option"),s.textContent=l,a=ee("option"),a.textContent=u,c=ee("option"),c.textContent=p,d=ee("option"),d.textContent=h,m=E("g"),se(v.$$.fragment),this.h()},l(x){t=N(x,"g",{});var R=w(t);n=N(R,"text",{x:!0,y:!0,class:!0});var A=w(n);i=L(A,`Select Node Type
    `),A.forEach(g),r=N(R,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var S=w(r);o=te(S,"SELECT",{class:!0});var D=w(o);s=te(D,"OPTION",{"data-svelte-h":!0}),yt(s)!=="svelte-3gv1dn"&&(s.textContent=l),a=te(D,"OPTION",{"data-svelte-h":!0}),yt(a)!=="svelte-183aq5q"&&(a.textContent=u),c=te(D,"OPTION",{"data-svelte-h":!0}),yt(c)!=="svelte-1wqksxw"&&(c.textContent=p),d=te(D,"OPTION",{"data-svelte-h":!0}),yt(d)!=="svelte-b76txe"&&(d.textContent=h),D.forEach(g),S.forEach(g),m=N(R,"g",{transform:!0});var F=w(m);ae(v.$$.fragment,F),F.forEach(g),R.forEach(g),this.h()},h(){f(n,"x",Z.layout.leftAlign),f(n,"y","0"),f(n,"class","form-label svelte-118fzwu"),s.__value="",Fe(s,s.__value),a.__value="word",Fe(a,a.__value),c.__value="statement",Fe(c,c.__value),d.__value="quantity",Fe(d,d.__value),f(o,"class","form-input"),o.disabled=e[1],e[0]===void 0&&bs(()=>e[5].call(o)),f(r,"x",Z.layout.leftAlign),f(r,"y",Z.layout.verticalSpacing.labelToInput),f(r,"width",Z.layout.fieldWidth),f(r,"height","40"),f(m,"transform","translate(0, "+Z.layout.verticalSpacing.betweenFields+")")},m(x,R){z(x,t,R),_(t,n),_(n,i),_(t,r),_(r,o),_(o,s),_(o,a),_(o,c),_(o,d),yr(o,e[0],!0),_(t,m),le(v,m,null),I=!0,y||(b=[Ee(o,"change",e[5]),Ee(o,"change",e[4])],y=!0)},p(x,[R]){(!I||R&2)&&(o.disabled=x[1]),R&1&&yr(o,x[0]);const A={};R&3&&(A.nextDisabled=!x[0]||x[1]),v.$set(A)},i(x){I||(X(v.$$.fragment,x),I=!0)},o(x){H(v.$$.fragment,x),I=!1},d(x){x&&g(t),ue(v),y=!1,Wt(b)}}}function Vc(e,t,n){let{nodeType:i=""}=t,{disabled:r=!1}=t;const o=tt(),s=()=>{};function l(){o("typeChange",{type:i})}function a(){i=Es(this),n(0,i)}const u=()=>o("proceed");return e.$$set=c=>{"nodeType"in c&&n(0,i=c.nodeType),"disabled"in c&&n(1,r=c.disabled)},[i,r,o,s,l,a,u]}class zc extends Ie{constructor(t){super(),Se(this,t,Vc,Fc,Ne,{nodeType:0,disabled:1})}}function Uc(){const{subscribe:e,set:t}=Do(null);function n(r,o){if(console.log("WordStore: Updating URL with:",{word:r,view:o}),r){const s=`/graph/${o}?word=${encodeURIComponent(r)}`,a=new URL(window.location.href).searchParams.get("word");if(console.log("WordStore: URL check:",{newUrl:s,currentWord:a,word:r,needsUpdate:a!==r}),a!==r)try{const u={word:r};window.history.replaceState(u,"",s),console.log("WordStore: URL updated successfully via history API")}catch(u){console.error("WordStore: Error updating URL:",u)}else console.log("WordStore: URL already correct")}}let i=null;return{subscribe:e,set:(r,o="word")=>{console.log("WordStore: Setting word data:",{wordData:r,view:o,currentWordId:i,newWordId:r==null?void 0:r.id,currentUrl:window.location.href}),t(r),r?(setTimeout(()=>{n(r.word,o)},0),i=r.id):i=null},reset:()=>{console.log("WordStore: Resetting word data"),i=null,t(null)},getCurrentWord:()=>{let r=null;return e(o=>{r=o})(),r}}}const ri=Uc();function lo(e){let t,n,i=(e[0]||e[1])+"",r;return{c(){t=E("g"),n=E("text"),r=P(i),this.h()},l(o){t=N(o,"g",{transform:!0});var s=w(t);n=N(s,"text",{class:!0,x:!0,y:!0,"text-anchor":!0});var l=w(n);r=L(l,i),l.forEach(g),s.forEach(g),this.h()},h(){f(n,"class","message svelte-1sqlw30"),f(n,"x",Z.layout.fieldWidth/2),f(n,"y","0"),f(n,"text-anchor","middle"),he(n,"error",e[0]),he(n,"success",e[1]),f(t,"transform","translate("+Z.layout.leftAlign+", 0)")},m(o,s){z(o,t,s),_(t,n),_(n,r)},p(o,s){s&3&&i!==(i=(o[0]||o[1])+"")&&ce(r,i),s&1&&he(n,"error",o[0]),s&2&&he(n,"success",o[1])},d(o){o&&g(t)}}}function Gc(e){let t,n=(e[0]||e[1])&&lo(e);return{c(){n&&n.c(),t=Te()},l(i){n&&n.l(i),t=Te()},m(i,r){n&&n.m(i,r),z(i,t,r)},p(i,[r]){i[0]||i[1]?n?n.p(i,r):(n=lo(i),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:xe,o:xe,d(i){i&&g(t),n&&n.d(i)}}}function Wc(e,t,n){let{errorMessage:i=null}=t,{successMessage:r=null}=t;return e.$$set=o=>{"errorMessage"in o&&n(0,i=o.errorMessage),"successMessage"in o&&n(1,r=o.successMessage)},[i,r]}class cr extends Ie{constructor(t){super(),Se(this,t,Wc,Gc,Ne,{errorMessage:0,successMessage:1})}}function uo(e){let t,n,i;return n=new cr({props:{errorMessage:e[3]}}),{c(){t=E("g"),se(n.$$.fragment),this.h()},l(r){t=N(r,"g",{transform:!0});var o=w(t);ae(n.$$.fragment,o),o.forEach(g),this.h()},h(){f(t,"transform","translate(0, "+(Z.layout.verticalSpacing.labelToInput+50)+")")},m(r,o){z(r,t,o),le(n,t,null),i=!0},p(r,o){const s={};o&8&&(s.errorMessage=r[3]),n.$set(s)},i(r){i||(X(n.$$.fragment,r),i=!0)},o(r){H(n.$$.fragment,r),i=!1},d(r){r&&g(t),ue(n)}}}function Bc(e){let t,n,i,r,o,s,l,a,u,c,p=e[3]&&uo(e);return l=new li({props:{onBack:e[7],onNext:e[5],nextLabel:e[2]?"Checking...":"Check Word",loading:e[2],nextDisabled:!e[0].trim()||e[1]}}),{c(){t=E("g"),n=E("text"),i=P(`Word
    `),r=E("foreignObject"),o=ee("input"),p&&p.c(),s=E("g"),se(l.$$.fragment),this.h()},l(d){t=N(d,"g",{});var h=w(t);n=N(h,"text",{x:!0,y:!0,class:!0});var m=w(n);i=L(m,`Word
    `),m.forEach(g),r=N(h,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var v=w(r);o=te(v,"INPUT",{type:!0,class:!0,placeholder:!0}),v.forEach(g),p&&p.l(h),s=N(h,"g",{transform:!0});var I=w(s);ae(l.$$.fragment,I),I.forEach(g),h.forEach(g),this.h()},h(){f(n,"x",Z.layout.leftAlign),f(n,"y","0"),f(n,"class","form-label svelte-1x2lj8g"),f(o,"type","text"),f(o,"class","form-input"),f(o,"placeholder","Enter important keyword for ProjectZer0"),o.disabled=e[1],he(o,"error",e[3]),f(r,"x",Z.layout.leftAlign),f(r,"y",Z.layout.verticalSpacing.labelToInput),f(r,"width",Z.layout.fieldWidth),f(r,"height","40"),f(s,"transform","translate(0, "+Z.layout.verticalSpacing.betweenFields+")")},m(d,h){z(d,t,h),_(t,n),_(n,i),_(t,r),_(r,o),Fe(o,e[0]),p&&p.m(t,null),_(t,s),le(l,s,null),a=!0,u||(c=Ee(o,"input",e[6]),u=!0)},p(d,[h]){(!a||h&2)&&(o.disabled=d[1]),h&1&&o.value!==d[0]&&Fe(o,d[0]),(!a||h&8)&&he(o,"error",d[3]),d[3]?p?(p.p(d,h),h&8&&X(p,1)):(p=uo(d),p.c(),X(p,1),p.m(t,s)):p&&(bt(),H(p,1,1,()=>{p=null}),Et());const m={};h&4&&(m.nextLabel=d[2]?"Checking...":"Check Word"),h&4&&(m.loading=d[2]),h&3&&(m.nextDisabled=!d[0].trim()||d[1]),l.$set(m)},i(d){a||(X(p),X(l.$$.fragment,d),a=!0)},o(d){H(p),H(l.$$.fragment,d),a=!1},d(d){d&&g(t),p&&p.d(),ue(l),u=!1,c()}}}function Yc(e,t,n){let{word:i=""}=t,{disabled:r=!1}=t;const o=tt();let s=!1,l=null;async function a(){if(!i.trim()){n(3,l="Please enter a word");return}n(2,s=!0),n(3,l=null);try{if((await Xe(`/nodes/word/check/${encodeURIComponent(i.trim())}`)).exists){const d=await Xe(`/nodes/word/${encodeURIComponent(i.trim())}`);n(3,l=`Word "${i.trim()}" already exists. Redirecting to word page...`),ri.set(d),setTimeout(()=>{mt("/graph/word")},2e3)}else o("proceed")}catch(p){n(3,l=p instanceof Error?p.message:"Failed to check word existence")}finally{n(2,s=!1)}}function u(){i=this.value,n(0,i)}const c=()=>o("back");return e.$$set=p=>{"word"in p&&n(0,i=p.word),"disabled"in p&&n(1,r=p.disabled)},[i,r,s,l,o,a,u,c]}class Xc extends Ie{constructor(t){super(),Se(this,t,Yc,Bc,Ne,{word:0,disabled:1})}}const qe={MAX_DEFINITION_LENGTH:280,MAX_COMMENT_LENGTH:280};function Hc(e){let t,n,i,r,o,s,l=qe.MAX_DEFINITION_LENGTH-e[0].length+"",a,u,c,p,d,h,m;return p=new li({props:{onBack:e[6],onNext:e[7],nextDisabled:e[1]||e[2]}}),{c(){t=E("g"),n=E("text"),i=P(`Definition (optional)
    `),r=E("foreignObject"),o=ee("textarea"),s=E("text"),a=P(l),u=P(` characters remaining
    `),c=E("g"),se(p.$$.fragment),this.h()},l(v){t=N(v,"g",{});var I=w(t);n=N(I,"text",{x:!0,y:!0,class:!0});var y=w(n);i=L(y,`Definition (optional)
    `),y.forEach(g),r=N(I,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var b=w(r);o=te(b,"TEXTAREA",{class:!0,placeholder:!0}),w(o).forEach(g),b.forEach(g),s=N(I,"text",{x:!0,y:!0,class:!0,"text-anchor":!0});var x=w(s);a=L(x,l),u=L(x,` characters remaining
    `),x.forEach(g),c=N(I,"g",{transform:!0});var R=w(c);ae(p.$$.fragment,R),R.forEach(g),I.forEach(g),this.h()},h(){f(n,"x",Z.layout.leftAlign),f(n,"y","-20"),f(n,"class","form-label svelte-oc3aop"),f(o,"class","form-textarea"),f(o,"placeholder","Enter your definition of this word within the context of its use in ProjectZer0."),o.disabled=e[1],he(o,"error",e[2]),f(r,"x",Z.layout.leftAlign),f(r,"y",Z.layout.verticalSpacing.labelToInput),f(r,"width",Z.layout.fieldWidth),f(r,"height","120"),f(s,"x",Z.layout.leftAlign+Z.layout.fieldWidth-90),f(s,"y",Z.layout.verticalSpacing.labelToInput+160),f(s,"class","character-count svelte-oc3aop"),f(s,"text-anchor","end"),he(s,"near-limit",e[0].length>qe.MAX_DEFINITION_LENGTH-20),he(s,"over-limit",e[2]),f(c,"transform","translate(0, "+(Z.layout.verticalSpacing.betweenFields+110)+")")},m(v,I){z(v,t,I),_(t,n),_(n,i),_(t,r),_(r,o),Fe(o,e[0]),_(t,s),_(s,a),_(s,u),_(t,c),le(p,c,null),d=!0,h||(m=[Ee(o,"input",e[5]),Ee(o,"input",e[4])],h=!0)},p(v,[I]){(!d||I&2)&&(o.disabled=v[1]),I&1&&Fe(o,v[0]),(!d||I&4)&&he(o,"error",v[2]),(!d||I&1)&&l!==(l=qe.MAX_DEFINITION_LENGTH-v[0].length+"")&&ce(a,l),(!d||I&1)&&he(s,"near-limit",v[0].length>qe.MAX_DEFINITION_LENGTH-20),(!d||I&4)&&he(s,"over-limit",v[2]);const y={};I&6&&(y.nextDisabled=v[1]||v[2]),p.$set(y)},i(v){d||(X(p.$$.fragment,v),d=!0)},o(v){H(p.$$.fragment,v),d=!1},d(v){v&&g(t),ue(p),h=!1,Wt(m)}}}function jc(e,t,n){let i,{definition:r=""}=t,{disabled:o=!1}=t;const s=tt();function l(p){const d=p.target;d.value.length>qe.MAX_DEFINITION_LENGTH&&n(0,r=d.value.slice(0,qe.MAX_DEFINITION_LENGTH))}function a(){r=this.value,n(0,r)}const u=()=>s("back"),c=()=>s("proceed");return e.$$set=p=>{"definition"in p&&n(0,r=p.definition),"disabled"in p&&n(1,o=p.disabled)},e.$$.update=()=>{e.$$.dirty&1&&n(2,i=r.length>qe.MAX_DEFINITION_LENGTH)},[r,o,i,s,l,a,u,c]}class qc extends Ie{constructor(t){super(),Se(this,t,jc,Hc,Ne,{definition:0,disabled:1})}}function $c(e){let t,n,i,r,o,s,l=qe.MAX_COMMENT_LENGTH-e[0].length+"",a,u,c,p,d,h,m;return p=new li({props:{onBack:e[7],onNext:e[8],nextLabel:"Review",nextDisabled:e[1]||e[3]}}),{c(){t=E("g"),n=E("text"),i=P(`Discussion (optional)
    `),r=E("foreignObject"),o=ee("textarea"),s=E("text"),a=P(l),u=P(` characters remaining
    `),c=E("g"),se(p.$$.fragment),this.h()},l(v){t=N(v,"g",{});var I=w(t);n=N(I,"text",{x:!0,y:!0,class:!0});var y=w(n);i=L(y,`Discussion (optional)
    `),y.forEach(g),r=N(I,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var b=w(r);o=te(b,"TEXTAREA",{class:!0,placeholder:!0}),w(o).forEach(g),b.forEach(g),s=N(I,"text",{x:!0,y:!0,class:!0,"text-anchor":!0});var x=w(s);a=L(x,l),u=L(x,` characters remaining
    `),x.forEach(g),c=N(I,"g",{transform:!0});var R=w(c);ae(p.$$.fragment,R),R.forEach(g),I.forEach(g),this.h()},h(){f(n,"x",Z.layout.leftAlign),f(n,"y","-20"),f(n,"class","form-label svelte-uicven"),f(o,"class","form-textarea"),f(o,"placeholder",e[2]),o.disabled=e[1],he(o,"error",e[3]),f(r,"x",Z.layout.leftAlign),f(r,"y",Z.layout.verticalSpacing.labelToInput),f(r,"width",Z.layout.fieldWidth),f(r,"height","120"),f(s,"x",Z.layout.leftAlign+Z.layout.fieldWidth-90),f(s,"y",Z.layout.verticalSpacing.labelToInput+160),f(s,"class","character-count svelte-uicven"),f(s,"text-anchor","end"),he(s,"near-limit",e[0].length>qe.MAX_COMMENT_LENGTH-20),he(s,"over-limit",e[3]),f(c,"transform","translate(0, "+(Z.layout.verticalSpacing.betweenFields+110)+")")},m(v,I){z(v,t,I),_(t,n),_(n,i),_(t,r),_(r,o),Fe(o,e[0]),_(t,s),_(s,a),_(s,u),_(t,c),le(p,c,null),d=!0,h||(m=[Ee(o,"input",e[6]),Ee(o,"input",e[5])],h=!0)},p(v,[I]){(!d||I&4)&&f(o,"placeholder",v[2]),(!d||I&2)&&(o.disabled=v[1]),I&1&&Fe(o,v[0]),(!d||I&8)&&he(o,"error",v[3]),(!d||I&1)&&l!==(l=qe.MAX_COMMENT_LENGTH-v[0].length+"")&&ce(a,l),(!d||I&1)&&he(s,"near-limit",v[0].length>qe.MAX_COMMENT_LENGTH-20),(!d||I&8)&&he(s,"over-limit",v[3]);const y={};I&10&&(y.nextDisabled=v[1]||v[3]),p.$set(y)},i(v){d||(X(p.$$.fragment,v),d=!0)},o(v){H(p.$$.fragment,v),d=!1},d(v){v&&g(t),ue(p),h=!1,Wt(m)}}}function Zc(e,t,n){let i,{discussion:r=""}=t,{disabled:o=!1}=t,{placeholder:s="Start a discussion around this word and its definition."}=t;const l=tt();function a(d){const h=d.target;h.value.length>qe.MAX_COMMENT_LENGTH&&n(0,r=h.value.slice(0,qe.MAX_COMMENT_LENGTH))}function u(){r=this.value,n(0,r)}const c=()=>l("back"),p=()=>l("proceed");return e.$$set=d=>{"discussion"in d&&n(0,r=d.discussion),"disabled"in d&&n(1,o=d.disabled),"placeholder"in d&&n(2,s=d.placeholder)},e.$$.update=()=>{e.$$.dirty&1&&n(3,i=r.length>qe.MAX_COMMENT_LENGTH)},[r,o,s,i,l,a,u,c,p]}class Kc extends Ie{constructor(t){super(),Se(this,t,Zc,$c,Ne,{discussion:0,disabled:1,placeholder:2})}}function fo(e){let t,n,i="Definition:",r,o,s,l;return{c(){t=ee("div"),n=ee("span"),n.textContent=i,r=de(),o=ee("div"),s=ee("span"),l=P(e[2]),this.h()},l(a){t=te(a,"DIV",{class:!0});var u=w(t);n=te(u,"SPAN",{class:!0,"data-svelte-h":!0}),yt(n)!=="svelte-9jpw1w"&&(n.textContent=i),r=ge(u),o=te(u,"DIV",{class:!0});var c=w(o);s=te(c,"SPAN",{class:!0});var p=w(s);l=L(p,e[2]),p.forEach(g),c.forEach(g),u.forEach(g),this.h()},h(){f(n,"class","label"),f(s,"class","value"),f(o,"class","scrollable-content svelte-1ss4kju"),f(t,"class","review-item")},m(a,u){z(a,t,u),_(t,n),_(t,r),_(t,o),_(o,s),_(s,l)},p(a,u){u&4&&ce(l,a[2])},d(a){a&&g(t)}}}function co(e){let t,n,i="Discussion:",r,o,s,l;return{c(){t=ee("div"),n=ee("span"),n.textContent=i,r=de(),o=ee("div"),s=ee("span"),l=P(e[3]),this.h()},l(a){t=te(a,"DIV",{class:!0});var u=w(t);n=te(u,"SPAN",{class:!0,"data-svelte-h":!0}),yt(n)!=="svelte-1gdkpap"&&(n.textContent=i),r=ge(u),o=te(u,"DIV",{class:!0});var c=w(o);s=te(c,"SPAN",{class:!0});var p=w(s);l=L(p,e[3]),p.forEach(g),c.forEach(g),u.forEach(g),this.h()},h(){f(n,"class","label"),f(s,"class","value"),f(o,"class","scrollable-content svelte-1ss4kju"),f(t,"class","review-item")},m(a,u){z(a,t,u),_(t,n),_(t,r),_(t,o),_(o,s),_(s,l)},p(a,u){u&8&&ce(l,a[3])},d(a){a&&g(t)}}}function ho(e){let t,n,i;return n=new cr({props:{errorMessage:e[7],successMessage:e[8]}}),{c(){t=E("g"),se(n.$$.fragment),this.h()},l(r){t=N(r,"g",{transform:!0});var o=w(t);ae(n.$$.fragment,o),o.forEach(g),this.h()},h(){f(t,"transform","translate(0, 240)")},m(r,o){z(r,t,o),le(n,t,null),i=!0},p(r,o){const s={};o&128&&(s.errorMessage=r[7]),o&256&&(s.successMessage=r[8]),n.$set(s)},i(r){i||(X(n.$$.fragment,r),i=!0)},o(r){H(n.$$.fragment,r),i=!1},d(r){r&&g(t),ue(n)}}}function Qc(e){let t,n,i,r,o,s="Word:",l,a,u,c,p,d,h,m,v,I,y,b="Publicly credit creation",x,R,A,S,D,F="Share on X (Twitter)",q,U,$,V,j,T,C=e[2]&&fo(e),M=e[3]&&co(e),O=(e[7]||e[8])&&ho(e);return $=new li({props:{onBack:e[14],onNext:e[10],nextLabel:e[6]?"Creating...":"Create Node",loading:e[6],nextDisabled:e[4]||e[6]}}),{c(){t=E("g"),n=E("foreignObject"),i=ee("div"),r=ee("div"),o=ee("span"),o.textContent=s,l=de(),a=ee("span"),u=P(e[1]),c=de(),C&&C.c(),p=de(),M&&M.c(),d=de(),h=ee("div"),m=ee("label"),v=ee("input"),I=de(),y=ee("span"),y.textContent=b,x=de(),R=ee("label"),A=ee("input"),S=de(),D=ee("span"),D.textContent=F,q=de(),O&&O.c(),U=E("g"),se($.$$.fragment),this.h()},l(k){t=N(k,"g",{});var G=w(t);n=N(G,"foreignObject",{x:!0,y:!0,width:!0,height:!0});var Y=w(n);i=te(Y,"DIV",{class:!0});var K=w(i);r=te(K,"DIV",{class:!0});var ne=w(r);o=te(ne,"SPAN",{class:!0,"data-svelte-h":!0}),yt(o)!=="svelte-19a2vmp"&&(o.textContent=s),l=ge(ne),a=te(ne,"SPAN",{class:!0});var pe=w(a);u=L(pe,e[1]),pe.forEach(g),ne.forEach(g),c=ge(K),C&&C.l(K),p=ge(K),M&&M.l(K),d=ge(K),h=te(K,"DIV",{class:!0});var _e=w(h);m=te(_e,"LABEL",{class:!0});var we=w(m);v=te(we,"INPUT",{type:!0}),I=ge(we),y=te(we,"SPAN",{"data-svelte-h":!0}),yt(y)!=="svelte-1kstmq"&&(y.textContent=b),we.forEach(g),x=ge(_e),R=te(_e,"LABEL",{class:!0});var me=w(R);A=te(me,"INPUT",{type:!0}),S=ge(me),D=te(me,"SPAN",{"data-svelte-h":!0}),yt(D)!=="svelte-1rqtj98"&&(D.textContent=F),me.forEach(g),_e.forEach(g),q=ge(K),K.forEach(g),Y.forEach(g),O&&O.l(G),U=N(G,"g",{transform:!0});var ve=w(U);ae($.$$.fragment,ve),ve.forEach(g),G.forEach(g),this.h()},h(){f(o,"class","label"),f(a,"class","value word-value"),f(r,"class","review-item word-item"),f(v,"type","checkbox"),v.disabled=e[6],f(m,"class","checkbox-label"),f(A,"type","checkbox"),A.disabled=e[6],f(R,"class","checkbox-label"),f(h,"class","options-grid"),f(i,"class","review-container"),f(n,"x",Z.layout.leftAlign-30),f(n,"y","-40"),f(n,"width",Z.layout.fieldWidth+60),f(n,"height","290"),f(U,"transform","translate(0, 270)")},m(k,G){z(k,t,G),_(t,n),_(n,i),_(i,r),_(r,o),_(r,l),_(r,a),_(a,u),_(i,c),C&&C.m(i,null),_(i,p),M&&M.m(i,null),_(i,d),_(i,h),_(h,m),_(m,v),v.checked=e[0],_(m,I),_(m,y),_(h,x),_(h,R),_(R,A),A.checked=e[5],_(R,S),_(R,D),_(i,q),O&&O.m(t,null),_(t,U),le($,U,null),V=!0,j||(T=[Ee(v,"change",e[12]),Ee(A,"change",e[13])],j=!0)},p(k,[G]){(!V||G&2)&&ce(u,k[1]),k[2]?C?C.p(k,G):(C=fo(k),C.c(),C.m(i,p)):C&&(C.d(1),C=null),k[3]?M?M.p(k,G):(M=co(k),M.c(),M.m(i,d)):M&&(M.d(1),M=null),(!V||G&64)&&(v.disabled=k[6]),G&1&&(v.checked=k[0]),(!V||G&64)&&(A.disabled=k[6]),G&32&&(A.checked=k[5]),k[7]||k[8]?O?(O.p(k,G),G&384&&X(O,1)):(O=ho(k),O.c(),X(O,1),O.m(t,U)):O&&(bt(),H(O,1,1,()=>{O=null}),Et());const Y={};G&64&&(Y.nextLabel=k[6]?"Creating...":"Create Node"),G&64&&(Y.loading=k[6]),G&80&&(Y.nextDisabled=k[4]||k[6]),$.$set(Y)},i(k){V||(X(O),X($.$$.fragment,k),V=!0)},o(k){H(O),H($.$$.fragment,k),V=!1},d(k){k&&g(t),C&&C.d(),M&&M.d(),O&&O.d(),ue($),j=!1,Wt(T)}}}function Jc(e,t,n){let{word:i=""}=t,{definition:r=""}=t,{discussion:o=""}=t,{publicCredit:s=!1}=t,{disabled:l=!1}=t,{userId:a=void 0}=t,u=!1,c=!1,p=null,d=null;const h=tt();async function m(){n(6,c=!0),n(7,p=null),n(8,d=null);try{const b={word:i.trim(),definition:r,discussion:o,publicCredit:s,createdBy:a,shareToX:u};Er&&console.log("Submitting word creation form:",JSON.stringify(b,null,2));const x=await Xe("/nodes/word",{method:"POST",body:JSON.stringify(b)});if(Er&&console.log("Word creation response:",JSON.stringify(x,null,2)),!(x!=null&&x.word))throw new Error("Created word data is incomplete");ri.set(x),n(8,d=`Word node "${x.word}" created successfully`),h("success",{message:d,word:x.word}),setTimeout(()=>{mt(`/graph/word?word=${encodeURIComponent(x.word)}`).catch(R=>{console.error("Navigation error:",R),n(7,p="Error navigating to new word")})},1e3)}catch(b){console.error("Error creating word:",b),console.error("Error details:",b instanceof Error?b.stack:"Unknown error"),n(7,p=b instanceof Error?b.message:"Failed to create new word node"),h("error",{message:p})}finally{n(6,c=!1)}}function v(){s=this.checked,n(0,s)}function I(){u=this.checked,n(5,u)}const y=()=>h("back");return e.$$set=b=>{"word"in b&&n(1,i=b.word),"definition"in b&&n(2,r=b.definition),"discussion"in b&&n(3,o=b.discussion),"publicCredit"in b&&n(0,s=b.publicCredit),"disabled"in b&&n(4,l=b.disabled),"userId"in b&&n(11,a=b.userId)},[s,i,r,o,l,u,c,p,d,h,m,a,v,I,y]}class eh extends Ie{constructor(t){super(),Se(this,t,Jc,Qc,Ne,{word:1,definition:2,discussion:3,publicCredit:0,disabled:4,userId:11})}}function go(e,t,n){const i=e.slice();return i[20]=t[n],i[22]=n,i}function po(e){let t,n=Tt(Array(5)),i=[];for(let r=0;r<n.length;r+=1)i[r]=_o(go(e,n,r));return{c(){t=E("g");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){t=N(r,"g",{transform:!0});var o=w(t);for(let s=0;s<i.length;s+=1)i[s].l(o);o.forEach(g),this.h()},h(){f(t,"transform","translate(0, 40)")},m(r,o){z(r,t,o);for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(t,null)},p(r,o){if(o&2){n=Tt(Array(5));let s;for(s=0;s<n.length;s+=1){const l=go(r,n,s);i[s]?i[s].p(l,o):(i[s]=_o(l),i[s].c(),i[s].m(t,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},d(r){r&&g(t),Oi(i,r)}}}function _o(e){let t;return{c(){t=E("circle"),this.h()},l(n){t=N(n,"circle",{cx:!0,cy:!0,r:!0,class:!0}),w(t).forEach(g),this.h()},h(){f(t,"cx",-40+e[22]*20),f(t,"cy","0"),f(t,"r","4"),f(t,"class","step-indicator svelte-137x9w8"),he(t,"active",e[1]>=e[22]+1)},m(n,i){z(n,t,i)},p(n,i){i&2&&he(t,"active",n[1]>=n[22]+1)},d(n){n&&g(t)}}}function th(e){let t,n;const i=[e[2],{userId:e[0].sub},{disabled:Dn}];let r={};for(let o=0;o<i.length;o+=1)r=Mo(r,i[o]);return t=new eh({props:r}),t.$on("back",e[8]),t.$on("success",e[17]),t.$on("error",e[18]),{c(){se(t.$$.fragment)},l(o){ae(t.$$.fragment,o)},m(o,s){le(t,o,s),n=!0},p(o,s){const l=s&5?Ds(i,[s&4&&ks(o[2]),s&1&&{userId:o[0].sub},s&0&&{disabled:Dn}]):{};t.$set(l)},i(o){n||(X(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){ue(t,o)}}}function nh(e){let t,n,i;function r(s){e[16](s)}let o={disabled:Dn};return e[2].discussion!==void 0&&(o.discussion=e[2].discussion),t=new Kc({props:o}),st.push(()=>mn(t,"discussion",r)),t.$on("back",e[8]),t.$on("proceed",e[9]),{c(){se(t.$$.fragment)},l(s){ae(t.$$.fragment,s)},m(s,l){le(t,s,l),i=!0},p(s,l){const a={};!n&&l&4&&(n=!0,a.discussion=s[2].discussion,_n(()=>n=!1)),t.$set(a)},i(s){i||(X(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){ue(t,s)}}}function ih(e){let t,n,i;function r(s){e[15](s)}let o={disabled:Dn};return e[2].definition!==void 0&&(o.definition=e[2].definition),t=new qc({props:o}),st.push(()=>mn(t,"definition",r)),t.$on("back",e[8]),t.$on("proceed",e[9]),{c(){se(t.$$.fragment)},l(s){ae(t.$$.fragment,s)},m(s,l){le(t,s,l),i=!0},p(s,l){const a={};!n&&l&4&&(n=!0,a.definition=s[2].definition,_n(()=>n=!1)),t.$set(a)},i(s){i||(X(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){ue(t,s)}}}function rh(e){let t,n,i;function r(s){e[13](s)}let o={disabled:Dn};return e[2].word!==void 0&&(o.word=e[2].word),t=new Xc({props:o}),st.push(()=>mn(t,"word",r)),t.$on("back",e[8]),t.$on("proceed",e[9]),t.$on("error",e[14]),{c(){se(t.$$.fragment)},l(s){ae(t.$$.fragment,s)},m(s,l){le(t,s,l),i=!0},p(s,l){const a={};!n&&l&4&&(n=!0,a.word=s[2].word,_n(()=>n=!1)),t.$set(a)},i(s){i||(X(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){ue(t,s)}}}function oh(e){let t,n,i;function r(s){e[12](s)}let o={disabled:Dn};return e[2].nodeType!==void 0&&(o.nodeType=e[2].nodeType),t=new zc({props:o}),st.push(()=>mn(t,"nodeType",r)),t.$on("proceed",e[9]),{c(){se(t.$$.fragment)},l(s){ae(t.$$.fragment,s)},m(s,l){le(t,s,l),i=!0},p(s,l){const a={};!n&&l&4&&(n=!0,a.nodeType=s[2].nodeType,_n(()=>n=!1)),t.$set(a)},i(s){i||(X(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){ue(t,s)}}}function sh(e){let t,n,i,r,o,s,l,a,u,c,p,d,h=e[6]&&po(e);o=new cr({props:{errorMessage:e[4],successMessage:e[5]}});const m=[oh,rh,ih,nh,th],v=[];function I(y,b){return y[1]===1?0:y[1]===2?1:y[1]===3?2:y[1]===4?3:y[1]===5?4:-1}return~(a=I(e))&&(u=v[a]=m[a](e)),{c(){t=E("g"),n=E("text"),i=P(e[7]),h&&h.c(),r=E("g"),se(o.$$.fragment),l=E("g"),u&&u.c(),this.h()},l(y){t=N(y,"g",{transform:!0});var b=w(t);n=N(b,"text",{class:!0,"text-anchor":!0});var x=w(n);i=L(x,e[7]),x.forEach(g),h&&h.l(b),r=N(b,"g",{transform:!0});var R=w(r);ae(o.$$.fragment,R),R.forEach(g),l=N(b,"g",{transform:!0});var A=w(l);u&&u.l(A),A.forEach(g),b.forEach(g),this.h()},h(){f(n,"class","title svelte-137x9w8"),f(n,"text-anchor","middle"),f(r,"transform",s="translate(0, "+(e[6]?70:40)+")"),f(l,"transform",c="translate(0, "+(e[6]?100:60)+")"),f(t,"transform",p="translate(0, "+(-e[19]+(e[1]===5?100:120))+")")},m(y,b){z(y,t,b),_(t,n),_(n,i),h&&h.m(t,null),_(t,r),le(o,r,null),_(t,l),~a&&v[a].m(l,null),d=!0},p(y,b){(!d||b&128)&&ce(i,y[7]),y[6]?h?h.p(y,b):(h=po(y),h.c(),h.m(t,r)):h&&(h.d(1),h=null);const x={};b&16&&(x.errorMessage=y[4]),b&32&&(x.successMessage=y[5]),o.$set(x),(!d||b&64&&s!==(s="translate(0, "+(y[6]?70:40)+")"))&&f(r,"transform",s);let R=a;a=I(y),a===R?~a&&v[a].p(y,b):(u&&(bt(),H(v[R],1,1,()=>{v[R]=null}),Et()),~a?(u=v[a],u?u.p(y,b):(u=v[a]=m[a](y),u.c()),X(u,1),u.m(l,null)):u=null),(!d||b&64&&c!==(c="translate(0, "+(y[6]?100:60)+")"))&&f(l,"transform",c),(!d||b&524290&&p!==(p="translate(0, "+(-y[19]+(y[1]===5?100:120))+")"))&&f(t,"transform",p)},i(y){d||(X(o.$$.fragment,y),X(u),d=!0)},o(y){H(o.$$.fragment,y),H(u),d=!1},d(y){y&&g(t),h&&h.d(),ue(o),~a&&v[a].d()}}}function ah(e){let t,n;return t=new ai({props:{style:e[3],$$slots:{default:[sh,({radius:i})=>({19:i}),({radius:i})=>i?524288:0]},$$scope:{ctx:e}}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,[r]){const o={};r&8&&(o.style=i[3]),r&8913143&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}let Dn=!1;function lh(e,t,n){let i,r,o,{node:s}=t,l=1,a={nodeType:"",word:"",definition:"",discussion:"",publicCredit:!1},u=null,c=null,p=0,d;function h(){l>1&&(n(1,l--,l),n(4,u=null))}function m(){l<5&&(n(1,l++,l),n(4,u=null))}er(()=>{d&&clearInterval(d)});function v(S){e.$$.not_equal(a.nodeType,S)&&(a.nodeType=S,n(2,a))}function I(S){e.$$.not_equal(a.word,S)&&(a.word=S,n(2,a))}const y=S=>n(4,u=S.detail.message);function b(S){e.$$.not_equal(a.definition,S)&&(a.definition=S,n(2,a))}function x(S){e.$$.not_equal(a.discussion,S)&&(a.discussion=S,n(2,a))}const R=S=>n(5,c=S.detail.message),A=S=>n(4,u=S.detail.message);return e.$$set=S=>{"node"in S&&n(0,s=S.node)},e.$$.update=()=>{if(e.$$.dirty&3084)if(a.nodeType===""){if(!d){const S=[{base:W.PRIMARY.BLUE,full:`${W.PRIMARY.BLUE}FF`,semi:`${W.PRIMARY.BLUE}66`,light:`${W.PRIMARY.BLUE}33`},{base:W.PRIMARY.PURPLE,full:`${W.PRIMARY.PURPLE}FF`,semi:`${W.PRIMARY.PURPLE}66`,light:`${W.PRIMARY.PURPLE}33`},{base:W.PRIMARY.TURQUOISE,full:`${W.PRIMARY.TURQUOISE}FF`,semi:`${W.PRIMARY.TURQUOISE}66`,light:`${W.PRIMARY.TURQUOISE}33`},{base:W.PRIMARY.GREEN,full:`${W.PRIMARY.GREEN}FF`,semi:`${W.PRIMARY.GREEN}66`,light:`${W.PRIMARY.GREEN}33`},{base:W.PRIMARY.YELLOW,full:`${W.PRIMARY.YELLOW}FF`,semi:`${W.PRIMARY.YELLOW}66`,light:`${W.PRIMARY.YELLOW}33`},{base:W.PRIMARY.ORANGE,full:`${W.PRIMARY.ORANGE}FF`,semi:`${W.PRIMARY.ORANGE}66`,light:`${W.PRIMARY.ORANGE}33`},{base:W.PRIMARY.RED,full:`${W.PRIMARY.RED}FF`,semi:`${W.PRIMARY.RED}66`,light:`${W.PRIMARY.RED}33`}];n(11,d=setInterval(()=>{n(10,p=(p+1)%S.length),n(3,i={...i,colors:{...i.colors,border:S[p].full,text:S[p].full,hover:S[p].full,gradient:{start:S[p].semi,end:S[p].light}}})},2e3))}}else d&&(clearInterval(d),n(11,d=void 0));e.$$.dirty&1028&&n(3,i={previewSize:B.SIZES.WORD.detail,detailSize:B.SIZES.WORD.detail,colors:a.nodeType==="word"?B.COLORS.WORD:{background:B.COLORS.WORD.background,border:B.COLORS.WORD.border,text:B.COLORS.WORD.text,hover:B.COLORS.WORD.hover,gradient:B.COLORS.WORD.gradient},padding:B.PADDING,lineHeight:B.LINE_HEIGHT,stroke:B.STROKE,highlightColor:a.nodeType==="word"?W.PRIMARY.BLUE:a.nodeType===""?[W.PRIMARY.BLUE,W.PRIMARY.PURPLE,W.PRIMARY.GREEN,W.PRIMARY.TURQUOISE,W.PRIMARY.YELLOW,W.PRIMARY.ORANGE][p]:void 0}),e.$$.dirty&2&&n(7,r=l===1?"Create New Node":l===2?"Enter Word":l===3?"Add Definition":l===4?"Start Discussion":"Review Creation"),e.$$.dirty&2&&n(6,o=l<5)},[s,l,a,i,u,c,o,r,h,m,p,d,v,I,y,b,x,R,A]}class uh extends Ie{constructor(t){super(),Se(this,t,lh,ah,Ne,{node:0})}}const fh=e=>({radius:e&4}),mo=e=>({radius:e[2]}),ch=e=>({radius:e&4}),vo=e=>({radius:e[2]}),hh=e=>({radius:e&4}),wo=e=>({radius:e[2]}),dh=e=>({radius:e&4}),yo=e=>({radius:e[2]});function gh(e){let t,n,i,r;const o=e[3].title,s=$t(o,e,e[4],yo),l=e[3].content,a=$t(l,e,e[4],wo),u=e[3].score,c=$t(u,e,e[4],vo),p=e[3].button,d=$t(p,e,e[4],mo);return{c(){s&&s.c(),t=de(),a&&a.c(),n=de(),c&&c.c(),i=de(),d&&d.c()},l(h){s&&s.l(h),t=ge(h),a&&a.l(h),n=ge(h),c&&c.l(h),i=ge(h),d&&d.l(h)},m(h,m){s&&s.m(h,m),z(h,t,m),a&&a.m(h,m),z(h,n,m),c&&c.m(h,m),z(h,i,m),d&&d.m(h,m),r=!0},p(h,m){s&&s.p&&(!r||m&20)&&Zt(s,o,h,h[4],r?Qt(o,h[4],m,dh):Kt(h[4]),yo),a&&a.p&&(!r||m&20)&&Zt(a,l,h,h[4],r?Qt(l,h[4],m,hh):Kt(h[4]),wo),c&&c.p&&(!r||m&20)&&Zt(c,u,h,h[4],r?Qt(u,h[4],m,ch):Kt(h[4]),vo),d&&d.p&&(!r||m&20)&&Zt(d,p,h,h[4],r?Qt(p,h[4],m,fh):Kt(h[4]),mo)},i(h){r||(X(s,h),X(a,h),X(c,h),X(d,h),r=!0)},o(h){H(s,h),H(a,h),H(c,h),H(d,h),r=!1},d(h){h&&(g(t),g(n),g(i)),s&&s.d(h),a&&a.d(h),c&&c.d(h),d&&d.d(h)}}}function ph(e){let t,n;return t=new fs({props:{style:e[0],transform:e[1],$$slots:{default:[gh]},$$scope:{ctx:e}}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,[r]){const o={};r&1&&(o.style=i[0]),r&2&&(o.transform=i[1]),r&20&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function _h(e,t,n){let i,{$$slots:r={},$$scope:o}=t,{style:s}=t,{transform:l}=t;return e.$$set=a=>{"style"in a&&n(0,s=a.style),"transform"in a&&n(1,l=a.transform),"$$scope"in a&&n(4,o=a.$$scope)},e.$$.update=()=>{e.$$.dirty&1&&n(2,i=s.previewSize/2)},[s,l,i,r,o]}class hs extends Ie{constructor(t){super(),Se(this,t,_h,ph,Ne,{style:0,transform:1})}}function bo(e){let t,n;return{c(){t=E("text"),n=P(e[0]),this.h()},l(i){t=N(i,"text",{y:!0,class:!0});var r=w(t);n=L(r,e[0]),r.forEach(g),this.h()},h(){f(t,"y","20"),f(t,"class","button-text svelte-1j2tcq6"),re(t,"font-family",B.FONTS.hover.family),re(t,"font-size",B.FONTS.hover.size),re(t,"font-weight",B.FONTS.hover.weight)},m(i,r){z(i,t,r),_(t,n)},p(i,r){r&1&&ce(n,i[0])},d(i){i&&g(t)}}}function mh(e){let t,n,i,r,o,s,l,a,u,c,p,d,h,m,v=`scale(${e[3]})`,I,y,b,x=e[2]&&bo(e);return{c(){t=E("g"),n=E("defs"),i=E("filter"),r=E("feGaussianBlur"),o=E("feFlood"),s=E("feComposite"),l=E("feGaussianBlur"),a=E("feFlood"),u=E("feComposite"),c=E("feMerge"),p=E("feMergeNode"),d=E("feMergeNode"),h=E("feMergeNode"),m=E("circle"),x&&x.c(),this.h()},l(R){t=N(R,"g",{class:!0,transform:!0});var A=w(t);n=N(A,"defs",{});var S=w(n);i=N(S,"filter",{id:!0,x:!0,y:!0,width:!0,height:!0});var D=w(i);r=N(D,"feGaussianBlur",{in:!0,stdDeviation:!0,result:!0}),w(r).forEach(g),o=N(D,"feFlood",{"flood-color":!0,"flood-opacity":!0,result:!0}),w(o).forEach(g),s=N(D,"feComposite",{in:!0,in2:!0,operator:!0,result:!0}),w(s).forEach(g),l=N(D,"feGaussianBlur",{in:!0,stdDeviation:!0,result:!0}),w(l).forEach(g),a=N(D,"feFlood",{"flood-color":!0,"flood-opacity":!0,result:!0}),w(a).forEach(g),u=N(D,"feComposite",{in:!0,in2:!0,operator:!0,result:!0}),w(u).forEach(g),c=N(D,"feMerge",{});var F=w(c);p=N(F,"feMergeNode",{in:!0}),w(p).forEach(g),d=N(F,"feMergeNode",{in:!0}),w(d).forEach(g),h=N(F,"feMergeNode",{in:!0}),w(h).forEach(g),F.forEach(g),D.forEach(g),S.forEach(g),m=N(A,"circle",{r:!0,class:!0}),w(m).forEach(g),x&&x.l(A),A.forEach(g),this.h()},h(){f(r,"in","SourceAlpha"),f(r,"stdDeviation","2"),f(r,"result","blur1"),f(o,"flood-color","#FFFFFF"),f(o,"flood-opacity","0.6"),f(o,"result","color1"),f(s,"in","color1"),f(s,"in2","blur1"),f(s,"operator","in"),f(s,"result","glow1"),f(l,"in","SourceAlpha"),f(l,"stdDeviation","1"),f(l,"result","blur2"),f(a,"flood-color","#FFFFFF"),f(a,"flood-opacity","0.8"),f(a,"result","color2"),f(u,"in","color2"),f(u,"in2","blur2"),f(u,"operator","in"),f(u,"result","glow2"),f(p,"in","glow1"),f(d,"in","glow2"),f(h,"in","SourceGraphic"),f(i,"id",e[5]),f(i,"x","-50%"),f(i,"y","-50%"),f(i,"width","200%"),f(i,"height","200%"),f(m,"r","8"),f(m,"class","button-circle svelte-1j2tcq6"),re(m,"transform",v),re(m,"filter",e[2]?`url(#${e[5]})`:"none"),f(t,"class","mode-button svelte-1j2tcq6"),f(t,"transform",I="translate(0, "+e[1]+")")},m(R,A){z(R,t,A),_(t,n),_(n,i),_(i,r),_(i,o),_(i,s),_(i,l),_(i,a),_(i,u),_(i,c),_(c,p),_(c,d),_(c,h),_(t,m),x&&x.m(t,null),y||(b=[Ee(t,"mouseenter",e[7]),Ee(t,"mouseleave",e[8]),Ee(t,"click",e[6])],y=!0)},p(R,[A]){A&8&&v!==(v=`scale(${R[3]})`)&&re(m,"transform",v),A&4&&re(m,"filter",R[2]?`url(#${R[5]})`:"none"),R[2]?x?x.p(R,A):(x=bo(R),x.c(),x.m(t,null)):x&&(x.d(1),x=null),A&2&&I!==(I="translate(0, "+R[1]+")")&&f(t,"transform",I)},i:xe,o:xe,d(R){R&&g(t),x&&x.d(),y=!1,Wt(b)}}}function vh(e,t,n){let i,{mode:r}=t,{y:o=0}=t;const s=tt();let l=!1;const a=us(1,{stiffness:.3,damping:.6});Ut(e,a,h=>n(3,i=h));const u=`button-glow-${Math.random().toString(36).slice(2)}`;function c(){s("click"),s("modeChange",{mode:r==="expand"?"detail":"preview"})}const p=()=>n(2,l=!0),d=()=>n(2,l=!1);return e.$$set=h=>{"mode"in h&&n(0,r=h.mode),"y"in h&&n(1,o=h.y)},e.$$.update=()=>{e.$$.dirty&5&&(r==="expand"?a.set(l?1.5:1):a.set(l?1:1.5))},[r,o,l,i,a,u,c,p,d]}class Pi extends Ie{constructor(t){super(),Se(this,t,vh,mh,Ne,{mode:0,y:1})}}function wh(e){let t,n,i;return{c(){t=E("text"),n=P("Word"),this.h()},l(r){t=N(r,"text",{y:!0,class:!0});var o=w(t);n=L(o,"Word"),o.forEach(g),this.h()},h(){f(t,"y",i=-e[1].previewSize/4-15),f(t,"class","title svelte-h5j0qi"),re(t,"font-family",B.FONTS.title.family),re(t,"font-size",B.FONTS.title.size),re(t,"font-weight",B.FONTS.title.weight)},m(r,o){z(r,t,o),_(t,n)},p(r,o){o&2&&i!==(i=-r[1].previewSize/4-15)&&f(t,"y",i)},d(r){r&&g(t)}}}function yh(e){let t,n=e[0].word+"",i,r;return{c(){t=E("text"),i=P(n),this.h()},l(o){t=N(o,"text",{y:!0,class:!0});var s=w(t);i=L(s,n),s.forEach(g),this.h()},h(){f(t,"y",r=-e[1].previewSize/4+40),f(t,"class","content svelte-h5j0qi"),re(t,"font-family",B.FONTS.word.family),re(t,"font-size",B.FONTS.word.size),re(t,"font-weight",B.FONTS.word.weight)},m(o,s){z(o,t,s),_(t,i)},p(o,s){s&1&&n!==(n=o[0].word+"")&&ce(i,n),s&2&&r!==(r=-o[1].previewSize/4+40)&&f(t,"y",r)},d(o){o&&g(t)}}}function bh(e){let t,n,i;return{c(){t=E("text"),n=P(e[3]),this.h()},l(r){t=N(r,"text",{y:!0,class:!0});var o=w(t);n=L(o,e[3]),o.forEach(g),this.h()},h(){f(t,"y",i=e[1].previewSize/4+10),f(t,"class","score svelte-h5j0qi"),re(t,"font-family",B.FONTS.word.family),re(t,"font-size",B.FONTS.value.size),re(t,"font-weight",B.FONTS.value.weight)},m(r,o){z(r,t,o),_(t,n)},p(r,o){o&8&&ce(n,r[3]),o&2&&i!==(i=r[1].previewSize/4+10)&&f(t,"y",i)},d(r){r&&g(t)}}}function Eh(e){let t,n;return t=new Pi({props:{mode:"expand",y:e[9]}}),t.$on("click",e[4]),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,r){const o={};r&512&&(o.y=i[9]),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function Nh(e){let t,n;return t=new hs({props:{style:e[1],transform:e[2],$$slots:{button:[Eh,({radius:i})=>({9:i}),({radius:i})=>i?512:0],score:[bh],content:[yh],title:[wh]},$$scope:{ctx:e}}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,[r]){const o={};r&2&&(o.style=i[1]),r&4&&(o.transform=i[2]),r&1547&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}const Eo=3,Ih=1e3;function _i(e){return e&&typeof e=="object"&&"low"in e?Number(e.low):Number(e||0)}function Sh(e,t,n){let i;Ut(e,wn,d=>n(6,i=d));let{data:r}=t,{style:o}=t,{transform:s=""}=t,l=0,a="0";const u=tt();function c(){u("modeChange",{mode:"detail"})}async function p(d=0){if(i)try{const h=await Xe(`/nodes/word/${r.word}/vote`);if(!h)throw new Error("No response from vote status endpoint");console.log("[WordPreview] Vote status response:",h);const m=_i(h.positiveVotes),v=_i(h.negativeVotes);console.log("[WordPreview] Parsed vote numbers:",{posVotes:m,negVotes:v}),n(0,r.positiveVotes=m,r),n(0,r.negativeVotes=v,r),n(5,l=m-v),console.log("[WordPreview] Updated state:",{positiveVotes:r.positiveVotes,negativeVotes:r.negativeVotes,netVotes:l,currentScoreDisplay:a})}catch(h){console.error("[WordPreview] Error fetching vote status:",h),d<Eo&&(console.log(`[WordPreview] Retrying vote status fetch (attempt ${d+1}/${Eo})`),await new Promise(m=>setTimeout(m,Ih)),await p(d+1))}}return en(async()=>{console.warn(" [WordPreview] MOUNT:",{word:r.word,initialPositiveVotes:r.positiveVotes,initialNegativeVotes:r.negativeVotes});const d=_i(r.positiveVotes),h=_i(r.negativeVotes);n(5,l=d-h),console.warn(" [WordPreview] INITIAL CALCS:",{initialPos:d,initialNeg:h,netVotes:l,scoreDisplay:a}),await p()}),e.$$set=d=>{"data"in d&&n(0,r=d.data),"style"in d&&n(1,o=d.style),"transform"in d&&n(2,s=d.transform)},e.$$.update=()=>{if(e.$$.dirty&40){const d=a;n(3,a=l>0?`+${l}`:l.toString()),console.warn(" [WordPreview] SCORE UPDATE:",{netVotes:l,oldScoreDisplay:d,newScoreDisplay:a})}},[r,o,s,a,c,l]}class ds extends Ie{constructor(t){super(),Se(this,t,Sh,Nh,Ne,{data:0,style:1,transform:2})}}async function Rh(e){try{return await Xe(`/users/${e}/details`)}catch(t){return console.error(`Error fetching user details for ${e}:`,t),null}}function Gi(e){return typeof e=="number"?e:xh(e)?e.low:0}function Wi(e){if("positiveVotes"in e&&"negativeVotes"in e){const t=Gi(e.positiveVotes),n=Gi(e.negativeVotes);return t-n}return Gi(e.votes)}function Ti(e,t,n=!1){return n?"Anonymous":e==="FreeDictionaryAPI"?"Free Dictionary API":(t==null?void 0:t.preferred_username)||(t==null?void 0:t.name)||"User"}function xh(e){return typeof e=="object"&&e!==null&&"low"in e&&typeof e.low=="number"}function Ah(e){let t,n,i,r,o,s,l=e[0].word+"",a,u,c,p,d,h,m,v,I,y,b,x,R,A,S,D,F,q,U,$,V,j,T,C,M,O,k,G,Y,K,ne,pe,_e,we,me,ve,Me,Oe,Ve,Bt,ze,tn,Ue,It=e[0].positiveVotes+"",$e,Ce,at,lt,ut,ft,Ze,St=e[0].negativeVotes+"",Ke,Pe,ct,ht,dt,gt,Qe,Mt,ke,Ge,nn,We,rn,Be,Dt,Je,Le,pt,_t,kt=Ti(e[0].createdBy,e[3],!e[0].publicCredit)+"",nt,Ct,Pt,De,ye,on,Yt;return De=new Pi({props:{mode:"collapse",y:e[17]}}),De.$on("click",e[9]),{c(){t=E("text"),n=P("Word"),r=de(),o=E("g"),s=E("text"),a=P(l),c=de(),p=E("g"),d=E("text"),h=P(`Please vote on whether to include this keyword in 
            `),m=E("text"),v=P(`ProjectZer0 or not.
            `),I=E("text"),y=P("You can always change your vote using the buttons below."),b=de(),x=E("g"),R=E("foreignObject"),A=ee("div"),S=ee("button"),D=P("Agree"),F=de(),q=E("foreignObject"),U=ee("div"),$=ee("button"),V=P("No Vote"),j=de(),T=E("foreignObject"),C=ee("div"),M=ee("button"),O=P("Disagree"),k=de(),G=E("g"),Y=E("text"),K=P(`Vote Data:
            `),ne=E("g"),pe=E("text"),_e=P(e[6]),we=E("text"),me=P(`=
                `),ve=E("text"),Me=P(e[4]),Oe=E("g"),Ve=E("text"),Bt=P(`Total Agree
                `),ze=E("text"),tn=P(`=
                `),Ue=E("text"),$e=P(It),Ce=E("g"),at=E("text"),lt=P(`Total Disagree
                `),ut=E("text"),ft=P(`=
                `),Ze=E("text"),Ke=P(St),Pe=E("g"),ct=E("text"),ht=P(`Net 
                `),dt=E("text"),gt=P(`=
                `),Qe=E("text"),Mt=P(e[2]),ke=E("g"),Ge=E("text"),nn=P(`Word Status
                `),We=E("text"),rn=P(`=
                `),Be=E("text"),Dt=P(e[7]),Je=de(),Le=E("g"),pt=E("text"),_t=P("created by: "),nt=P(kt),Pt=de(),se(De.$$.fragment),this.h()},l(Q){t=N(Q,"text",{y:!0,class:!0});var fe=w(t);n=L(fe,"Word"),fe.forEach(g),r=ge(Q),o=N(Q,"g",{class:!0,transform:!0});var Rt=w(o);s=N(Rt,"text",{class:!0});var it=w(s);a=L(it,l),it.forEach(g),Rt.forEach(g),c=ge(Q),p=N(Q,"g",{transform:!0});var be=w(p);d=N(be,"text",{x:!0,class:!0});var bn=w(d);h=L(bn,`Please vote on whether to include this keyword in 
            `),bn.forEach(g),m=N(be,"text",{x:!0,y:!0,class:!0});var kn=w(m);v=L(kn,`ProjectZer0 or not.
            `),kn.forEach(g),I=N(be,"text",{x:!0,y:!0,class:!0});var J=w(I);y=L(J,"You can always change your vote using the buttons below."),J.forEach(g),be.forEach(g),b=ge(Q),x=N(Q,"g",{transform:!0});var oe=w(x);R=N(oe,"foreignObject",{x:!0,width:!0,height:!0});var Xt=w(R);A=te(Xt,"DIV",{class:!0});var En=w(A);S=te(En,"BUTTON",{class:!0});var sn=w(S);D=L(sn,"Agree"),sn.forEach(g),F=ge(En),En.forEach(g),Xt.forEach(g),q=N(oe,"foreignObject",{x:!0,width:!0,height:!0});var Nn=w(q);U=te(Nn,"DIV",{class:!0});var In=w(U);$=te(In,"BUTTON",{class:!0});var an=w($);V=L(an,"No Vote"),an.forEach(g),j=ge(In),In.forEach(g),Nn.forEach(g),T=N(oe,"foreignObject",{x:!0,width:!0,height:!0});var Cn=w(T);C=te(Cn,"DIV",{class:!0});var Pn=w(C);M=te(Pn,"BUTTON",{class:!0});var Ln=w(M);O=L(Ln,"Disagree"),Ln.forEach(g),Pn.forEach(g),Cn.forEach(g),oe.forEach(g),k=ge(Q),G=N(Q,"g",{transform:!0});var rt=w(G);Y=N(rt,"text",{x:!0,class:!0});var Fn=w(Y);K=L(Fn,`Vote Data:
            `),Fn.forEach(g),ne=N(rt,"g",{transform:!0});var Ht=w(ne);pe=N(Ht,"text",{x:!0,class:!0});var Vn=w(pe);_e=L(Vn,e[6]),Vn.forEach(g),we=N(Ht,"text",{x:!0,class:!0});var zn=w(we);me=L(zn,`=
                `),zn.forEach(g),ve=N(Ht,"text",{x:!0,class:!0});var Sn=w(ve);Me=L(Sn,e[4]),Sn.forEach(g),Ht.forEach(g),Oe=N(rt,"g",{transform:!0});var ln=w(Oe);Ve=N(ln,"text",{x:!0,class:!0});var Un=w(Ve);Bt=L(Un,`Total Agree
                `),Un.forEach(g),ze=N(ln,"text",{x:!0,class:!0});var Gn=w(ze);tn=L(Gn,`=
                `),Gn.forEach(g),Ue=N(ln,"text",{x:!0,class:!0});var Wn=w(Ue);$e=L(Wn,It),Wn.forEach(g),ln.forEach(g),Ce=N(rt,"g",{transform:!0});var ot=w(Ce);at=N(ot,"text",{x:!0,class:!0});var Bn=w(at);lt=L(Bn,`Total Disagree
                `),Bn.forEach(g),ut=N(ot,"text",{x:!0,class:!0});var un=w(ut);ft=L(un,`=
                `),un.forEach(g),Ze=N(ot,"text",{x:!0,class:!0});var Yn=w(Ze);Ke=L(Yn,St),Yn.forEach(g),ot.forEach(g),Pe=N(rt,"g",{transform:!0});var fn=w(Pe);ct=N(fn,"text",{x:!0,class:!0});var Xn=w(ct);ht=L(Xn,`Net 
                `),Xn.forEach(g),dt=N(fn,"text",{x:!0,class:!0});var cn=w(dt);gt=L(cn,`=
                `),cn.forEach(g),Qe=N(fn,"text",{x:!0,class:!0});var Hn=w(Qe);Mt=L(Hn,e[2]),Hn.forEach(g),fn.forEach(g),ke=N(rt,"g",{transform:!0});var hn=w(ke);Ge=N(hn,"text",{x:!0,class:!0});var jn=w(Ge);nn=L(jn,`Word Status
                `),jn.forEach(g),We=N(hn,"text",{x:!0,class:!0});var dn=w(We);rn=L(dn,`=
                `),dn.forEach(g),Be=N(hn,"text",{x:!0,class:!0});var qn=w(Be);Dt=L(qn,e[7]),qn.forEach(g),hn.forEach(g),rt.forEach(g),Je=ge(Q),Le=N(Q,"g",{transform:!0});var $n=w(Le);pt=N($n,"text",{class:!0});var Rn=w(pt);_t=L(Rn,"created by: "),nt=L(Rn,kt),Rn.forEach(g),$n.forEach(g),Pt=ge(Q),ae(De.$$.fragment,Q),this.h()},h(){f(t,"y",i=-e[17]+40),f(t,"class","title svelte-lowxag"),re(t,"font-family",B.FONTS.title.family),re(t,"font-size",B.FONTS.title.size),re(t,"font-weight",B.FONTS.title.weight),f(s,"class","word main-word svelte-lowxag"),re(s,"font-family",B.FONTS.word.family),re(s,"font-weight",B.FONTS.word.weight),f(o,"class","word-display"),f(o,"transform",u="translate(0, "+-e[17]/2+")"),f(d,"x",e[8].labelX),f(d,"class","context-text left-align svelte-lowxag"),f(m,"x",e[8].labelX),f(m,"y","25"),f(m,"class","context-text left-align svelte-lowxag"),f(I,"x",e[8].labelX),f(I,"y","60"),f(I,"class","context-text left-align svelte-lowxag"),f(p,"transform","translate(0, -100)"),f(S,"class","vote-button agree"),S.disabled=e[5],he(S,"active",e[4]==="agree"),f(A,"class","button-wrapper"),f(R,"x",-160),f(R,"width","100"),f(R,"height","45"),f($,"class","vote-button no-vote"),$.disabled=e[5],he($,"active",e[4]==="none"),f(U,"class","button-wrapper"),f(q,"x",-50),f(q,"width","100"),f(q,"height","45"),f(M,"class","vote-button disagree"),M.disabled=e[5],he(M,"active",e[4]==="disagree"),f(C,"class","button-wrapper"),f(T,"x",60),f(T,"width","100"),f(T,"height","45"),f(x,"transform","translate(0, -10)"),f(Y,"x",e[8].labelX),f(Y,"class","stats-label left-align svelte-lowxag"),f(pe,"x",e[8].labelX),f(pe,"class","stats-text left-align svelte-lowxag"),f(we,"x",e[8].equalsX),f(we,"class","stats-text svelte-lowxag"),f(ve,"x",e[8].valueX),f(ve,"class","stats-value left-align svelte-lowxag"),f(ne,"transform","translate(0, 30)"),f(Ve,"x",e[8].labelX),f(Ve,"class","stats-text left-align svelte-lowxag"),f(ze,"x",e[8].equalsX),f(ze,"class","stats-text svelte-lowxag"),f(Ue,"x",e[8].valueX),f(Ue,"class","stats-value left-align svelte-lowxag"),f(Oe,"transform","translate(0, 55)"),f(at,"x",e[8].labelX),f(at,"class","stats-text left-align svelte-lowxag"),f(ut,"x",e[8].equalsX),f(ut,"class","stats-text svelte-lowxag"),f(Ze,"x",e[8].valueX),f(Ze,"class","stats-value left-align svelte-lowxag"),f(Ce,"transform","translate(0, 80)"),f(ct,"x",e[8].labelX),f(ct,"class","stats-text left-align svelte-lowxag"),f(dt,"x",e[8].equalsX),f(dt,"class","stats-text svelte-lowxag"),f(Qe,"x",e[8].valueX),f(Qe,"class","stats-value left-align svelte-lowxag"),f(Pe,"transform","translate(0, 105)"),f(Ge,"x",e[8].labelX),f(Ge,"class","stats-text left-align svelte-lowxag"),f(We,"x",e[8].equalsX),f(We,"class","stats-text svelte-lowxag"),f(Be,"x",e[8].valueX),f(Be,"class","stats-value left-align svelte-lowxag"),f(ke,"transform","translate(0, 130)"),f(G,"transform","translate(0, 60)"),f(pt,"class","creator-label svelte-lowxag"),f(Le,"transform",Ct="translate(0, "+(e[17]-55)+")")},m(Q,fe){z(Q,t,fe),_(t,n),z(Q,r,fe),z(Q,o,fe),_(o,s),_(s,a),z(Q,c,fe),z(Q,p,fe),_(p,d),_(d,h),_(p,m),_(m,v),_(p,I),_(I,y),z(Q,b,fe),z(Q,x,fe),_(x,R),_(R,A),_(A,S),_(S,D),_(A,F),_(x,q),_(q,U),_(U,$),_($,V),_(U,j),_(x,T),_(T,C),_(C,M),_(M,O),z(Q,k,fe),z(Q,G,fe),_(G,Y),_(Y,K),_(G,ne),_(ne,pe),_(pe,_e),_(ne,we),_(we,me),_(ne,ve),_(ve,Me),_(G,Oe),_(Oe,Ve),_(Ve,Bt),_(Oe,ze),_(ze,tn),_(Oe,Ue),_(Ue,$e),_(G,Ce),_(Ce,at),_(at,lt),_(Ce,ut),_(ut,ft),_(Ce,Ze),_(Ze,Ke),_(G,Pe),_(Pe,ct),_(ct,ht),_(Pe,dt),_(dt,gt),_(Pe,Qe),_(Qe,Mt),_(G,ke),_(ke,Ge),_(Ge,nn),_(ke,We),_(We,rn),_(ke,Be),_(Be,Dt),z(Q,Je,fe),z(Q,Le,fe),_(Le,pt),_(pt,_t),_(pt,nt),z(Q,Pt,fe),le(De,Q,fe),ye=!0,on||(Yt=[Ee(S,"click",e[12]),Ee($,"click",e[13]),Ee(M,"click",e[14])],on=!0)},p(Q,fe){(!ye||fe&131072&&i!==(i=-Q[17]+40))&&f(t,"y",i),(!ye||fe&1)&&l!==(l=Q[0].word+"")&&ce(a,l),(!ye||fe&131072&&u!==(u="translate(0, "+-Q[17]/2+")"))&&f(o,"transform",u),(!ye||fe&32)&&(S.disabled=Q[5]),(!ye||fe&16)&&he(S,"active",Q[4]==="agree"),(!ye||fe&32)&&($.disabled=Q[5]),(!ye||fe&16)&&he($,"active",Q[4]==="none"),(!ye||fe&32)&&(M.disabled=Q[5]),(!ye||fe&16)&&he(M,"active",Q[4]==="disagree"),(!ye||fe&64)&&ce(_e,Q[6]),(!ye||fe&16)&&ce(Me,Q[4]),(!ye||fe&1)&&It!==(It=Q[0].positiveVotes+"")&&ce($e,It),(!ye||fe&1)&&St!==(St=Q[0].negativeVotes+"")&&ce(Ke,St),(!ye||fe&4)&&ce(Mt,Q[2]),(!ye||fe&128)&&ce(Dt,Q[7]),(!ye||fe&9)&&kt!==(kt=Ti(Q[0].createdBy,Q[3],!Q[0].publicCredit)+"")&&ce(nt,kt),(!ye||fe&131072&&Ct!==(Ct="translate(0, "+(Q[17]-55)+")"))&&f(Le,"transform",Ct);const Rt={};fe&131072&&(Rt.y=Q[17]),De.$set(Rt)},i(Q){ye||(X(De.$$.fragment,Q),ye=!0)},o(Q){H(De.$$.fragment,Q),ye=!1},d(Q){Q&&(g(t),g(r),g(o),g(c),g(p),g(b),g(x),g(k),g(G),g(Je),g(Le),g(Pt)),ue(De,Q),on=!1,Wt(Yt)}}}function Th(e){let t,n;return t=new ai({props:{style:e[1],$$slots:{default:[Ah,({radius:i})=>({17:i}),({radius:i})=>i?131072:0]},$$scope:{ctx:e}}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,[r]){const o={};r&2&&(o.style=i[1]),r&393469&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}const No=3,Oh=1e3;function xt(e){return e&&typeof e=="object"&&"low"in e?Number(e.low):Number(e||0)}function Mh(e,t,n){let i;Ut(e,wn,R=>n(11,i=R));let{data:r}=t,{style:o}=t;const s=tt(),l={labelX:-200,equalsX:0,valueX:30};let a=null,u="none",c=!1,p,d,h;async function m(R=0){if(i)try{const A=await Xe(`/nodes/word/${r.word}/vote`);if(!A)throw new Error("No response from vote status endpoint");n(4,u=A.status||"none"),n(0,r.positiveVotes=xt(A.positiveVotes),r),n(0,r.negativeVotes=xt(A.negativeVotes),r)}catch(A){console.error("Error fetching vote status:",A),R<No&&(console.log(`Retrying vote status fetch (attempt ${R+1}/${No})`),await new Promise(S=>setTimeout(S,Oh)),await m(R+1))}}function v(){s("modeChange",{mode:"preview"})}async function I(R){if(!i||c)return;n(5,c=!0);const A=u;try{if(n(4,u=R),R==="none"){const S=await Xe(`/nodes/word/${r.word}/vote/remove`,{method:"POST"});n(0,r.positiveVotes=xt(S.positiveVotes),r),n(0,r.negativeVotes=xt(S.negativeVotes),r)}else{const S=await Xe(`/nodes/word/${r.word}/vote`,{method:"POST",body:JSON.stringify({isPositive:R==="agree"})});n(0,r.positiveVotes=xt(S.positiveVotes),r),n(0,r.negativeVotes=xt(S.negativeVotes),r)}}catch(S){console.error("Error voting:",S),n(4,u=A),await m()}finally{n(5,c=!1)}}en(async()=>{r.createdBy&&r.createdBy!=="FreeDictionaryAPI"&&n(3,a=await Rh(r.createdBy)),n(0,r.positiveVotes=xt(r.positiveVotes),r),n(0,r.negativeVotes=xt(r.negativeVotes),r),await m()});const y=()=>I("agree"),b=()=>I("none"),x=()=>I("disagree");return e.$$set=R=>{"data"in R&&n(0,r=R.data),"style"in R&&n(1,o=R.style)},e.$$.update=()=>{e.$$.dirty&2048&&n(6,p=(i==null?void 0:i.preferred_username)||(i==null?void 0:i.name)||"Anonymous"),e.$$.dirty&1&&n(2,d=xt(r.positiveVotes)-xt(r.negativeVotes)),e.$$.dirty&4&&n(7,h=d>0?"agreed":d<0?"disagreed":"undecided")},[r,o,d,a,u,c,p,h,l,v,I,i,y,b,x]}class Dh extends Ie{constructor(t){super(),Se(this,t,Mh,Th,Ne,{data:0,style:1})}}function Io(e,t,n){const i=e.slice();return i[17]=t[n],i[19]=n,i}function kh(e){let t,n=e[0]==="live"?"Live Definition":"Alternative Definition",i,r;return{c(){t=E("text"),i=P(n),this.h()},l(o){t=N(o,"text",{y:!0,class:!0});var s=w(t);i=L(s,n),s.forEach(g),this.h()},h(){f(t,"y",r=-e[1].previewSize/4-50),f(t,"class","title centered svelte-1723qqz"),re(t,"font-family",B.FONTS.title.family),re(t,"font-size","12px"),re(t,"font-weight",B.FONTS.title.weight)},m(o,s){z(o,t,s),_(t,i)},p(o,s){s&1&&n!==(n=o[0]==="live"?"Live Definition":"Alternative Definition")&&ce(i,n),s&2&&r!==(r=-o[1].previewSize/4-50)&&f(t,"y",r)},d(o){o&&g(t)}}}function So(e){let t,n=e[17]+"",i,r;return{c(){t=E("tspan"),i=P(n),this.h()},l(o){t=N(o,"tspan",{x:!0,dy:!0});var s=w(t);i=L(s,n),s.forEach(g),this.h()},h(){f(t,"x",r=-e[1].previewSize/2+40),f(t,"dy",e[19]===0?0:"1.2em")},m(o,s){z(o,t,s),_(t,i)},p(o,s){s&16&&n!==(n=o[17]+"")&&ce(i,n),s&2&&r!==(r=-o[1].previewSize/2+40)&&f(t,"x",r)},d(o){o&&g(t)}}}function Ch(e){let t,n,i,r=Tt(e[4]),o=[];for(let s=0;s<r.length;s+=1)o[s]=So(Io(e,r,s));return{c(){t=E("text");for(let s=0;s<o.length;s+=1)o[s].c();this.h()},l(s){t=N(s,"text",{y:!0,x:!0,class:!0});var l=w(t);for(let a=0;a<o.length;a+=1)o[a].l(l);l.forEach(g),this.h()},h(){f(t,"y",n=-e[1].previewSize/4+20),f(t,"x",i=-e[1].previewSize/2+35),f(t,"class","content left-aligned svelte-1723qqz"),re(t,"font-family",B.FONTS.word.family),re(t,"font-size",B.FONTS.word.size),re(t,"font-weight",B.FONTS.word.weight)},m(s,l){z(s,t,l);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(t,null)},p(s,l){if(l&18){r=Tt(s[4]);let a;for(a=0;a<r.length;a+=1){const u=Io(s,r,a);o[a]?o[a].p(u,l):(o[a]=So(u),o[a].c(),o[a].m(t,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=r.length}l&2&&n!==(n=-s[1].previewSize/4+20)&&f(t,"y",n),l&2&&i!==(i=-s[1].previewSize/2+35)&&f(t,"x",i)},d(s){s&&g(t),Oi(o,s)}}}function Ph(e){let t,n,i;return{c(){t=E("text"),n=P(e[3]),this.h()},l(r){t=N(r,"text",{y:!0,class:!0});var o=w(t);n=L(o,e[3]),o.forEach(g),this.h()},h(){f(t,"y",i=e[1].previewSize/4+10),f(t,"class","score svelte-1723qqz"),re(t,"font-family",B.FONTS.word.family),re(t,"font-size",B.FONTS.value.size),re(t,"font-weight",B.FONTS.value.weight)},m(r,o){z(r,t,o),_(t,n)},p(r,o){o&8&&ce(n,r[3]),o&2&&i!==(i=r[1].previewSize/4+10)&&f(t,"y",i)},d(r){r&&g(t)}}}function Lh(e){let t,n;return t=new Pi({props:{mode:"expand",y:e[16]}}),t.$on("click",e[5]),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,r){const o={};r&65536&&(o.y=i[16]),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function Fh(e){let t,n;return t=new hs({props:{style:e[1],transform:e[2],$$slots:{button:[Lh,({radius:i})=>({16:i}),({radius:i})=>i?65536:0],score:[Ph],content:[Ch],title:[kh]},$$scope:{ctx:e}}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,[r]){const o={};r&2&&(o.style=i[1]),r&4&&(o.transform=i[2]),r&1114139&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}const Ro=3,Vh=1e3;function mi(e){return e&&typeof e=="object"&&"low"in e?Number(e.low):Number(e||0)}function zh(e,t,n){let i,r,o,s,l;Ut(e,wn,b=>n(12,l=b));let{definition:a}=t,{type:u}=t,{style:c}=t,{transform:p=""}=t,{word:d}=t,h=0,m="0";const v=tt();function I(){v("modeChange",{mode:"detail"})}async function y(b=0){if(l)try{const x=await Xe(`/definitions/${a.id}/vote`);if(!x)throw new Error("No response from vote status endpoint");console.log("[DefinitionPreview] Vote status response:",x);const R=mi(x.positiveVotes),A=mi(x.negativeVotes);console.log("[DefinitionPreview] Parsed vote numbers:",{posVotes:R,negVotes:A}),n(6,a.positiveVotes=R,a),n(6,a.negativeVotes=A,a),n(8,h=R-A),console.log("[DefinitionPreview] Updated state:",{positiveVotes:a.positiveVotes,negativeVotes:a.negativeVotes,netVotes:h,currentScoreDisplay:m})}catch(x){console.error("[DefinitionPreview] Error fetching vote status:",x),b<Ro&&(console.log(`[DefinitionPreview] Retrying vote status fetch (attempt ${b+1}/${Ro})`),await new Promise(R=>setTimeout(R,Vh)),await y(b+1))}}return en(async()=>{console.warn(" [DefinitionPreview] MOUNT:",{id:a.id,initialPositiveVotes:a.positiveVotes,initialNegativeVotes:a.negativeVotes});const b=mi(a.positiveVotes),x=mi(a.negativeVotes);n(8,h=b-x),console.warn(" [DefinitionPreview] INITIAL CALCS:",{initialPos:b,initialNeg:x,netVotes:h,scoreDisplay:m}),await y()}),e.$$set=b=>{"definition"in b&&n(6,a=b.definition),"type"in b&&n(0,u=b.type),"style"in b&&n(1,c=b.style),"transform"in b&&n(2,p=b.transform),"word"in b&&n(7,d=b.word)},e.$$.update=()=>{if(e.$$.dirty&2&&n(11,i=c.previewSize-c.padding.preview*2-45),e.$$.dirty&2048&&n(9,r=Math.floor(i/8)),e.$$.dirty&192&&n(10,o=`${d}: ${a.text}`),e.$$.dirty&1536&&n(4,s=o.split(" ").reduce((b,x)=>{const R=b[b.length-1]||"",A=R+(R?" ":"")+x;return!R||A.length<=r?b[b.length-1]=A:b.push(x),b},[""])),e.$$.dirty&264){const b=m;n(3,m=h>0?`+${h}`:h.toString()),console.warn(" [DefinitionPreview] SCORE UPDATE:",{netVotes:h,oldScoreDisplay:b,newScoreDisplay:m})}},[u,c,p,m,s,I,a,d,h,r,o,i]}class Uh extends Ie{constructor(t){super(),Se(this,t,zh,Fh,Ne,{definition:6,type:0,style:1,transform:2,word:7})}}const ie={DASHBOARD:"dashboard",CREATE_NODE:"create-node",EDIT_PROFILE:"edit-profile",EXPLORE:"explore",NETWORK:"network",INTERACTIONS:"interactions",CREATIONS:"creations",LOGOUT:"logout",ALTERNATIVE_DEFINITIONS:"alternative-definitions",CREATE_ALTERNATIVE:"create-alternative",DISCUSS:"discuss"};function Bi(e){const t=Ns(ri);if(t){const n=`${e}?word=${encodeURIComponent(t.word)}`;mt(n,{replaceState:!0,keepFocus:!0})}}const Gh={[ie.DASHBOARD]:()=>mt("/graph/dashboard"),[ie.CREATE_NODE]:()=>mt("/graph/create-node"),[ie.EDIT_PROFILE]:()=>mt("/graph/edit-profile"),[ie.EXPLORE]:()=>mt("/explore"),[ie.NETWORK]:()=>mt("/network"),[ie.INTERACTIONS]:()=>mt("/interactions"),[ie.CREATIONS]:()=>mt("/creations"),[ie.LOGOUT]:()=>vs(),[ie.ALTERNATIVE_DEFINITIONS]:()=>Bi("/graph/alternative-definitions"),[ie.CREATE_ALTERNATIVE]:()=>Bi("/graph/create-alternative"),[ie.DISCUSS]:()=>Bi("/graph/discuss")},Vt={DASHBOARD:"dashboard",CREATE_NODE:"create-node",EXPLORE:"explore",WORD:"word",EDIT_PROFILE:"edit-profile"},Wh={[ie.EXPLORE]:"Language",[ie.CREATE_NODE]:"add_circle",[ie.NETWORK]:"network_node",[ie.LOGOUT]:"logout",[ie.EDIT_PROFILE]:"settings",[ie.INTERACTIONS]:"compare_arrows",[ie.CREATIONS]:"stars",[ie.DASHBOARD]:"home",[ie.ALTERNATIVE_DEFINITIONS]:"format_list_bulleted",[ie.CREATE_ALTERNATIVE]:"playlist_add_circle",[ie.DISCUSS]:"forum"},Bh={[Vt.DASHBOARD]:[ie.EXPLORE,ie.CREATE_NODE,ie.NETWORK,ie.LOGOUT,ie.EDIT_PROFILE,ie.INTERACTIONS,ie.CREATIONS],[Vt.EDIT_PROFILE]:[ie.EXPLORE,ie.CREATE_NODE,ie.NETWORK,ie.LOGOUT,ie.DASHBOARD,ie.INTERACTIONS,ie.CREATIONS],[Vt.CREATE_NODE]:[ie.EXPLORE,ie.DASHBOARD,ie.NETWORK,ie.LOGOUT,ie.EDIT_PROFILE,ie.INTERACTIONS,ie.CREATIONS],[Vt.EXPLORE]:[],[Vt.WORD]:[ie.EXPLORE,ie.DASHBOARD,ie.LOGOUT,ie.CREATE_NODE,ie.ALTERNATIVE_DEFINITIONS,ie.CREATE_ALTERNATIVE,ie.DISCUSS]};function Yh(e){const t=Gh[e];t?t():console.warn(`No handler defined for navigation option: ${e}`)}function Xh(e){const t=Bh[e];return t?t.map(n=>({id:n,label:n.replace("-"," "),icon:Wh[n]})):(console.warn(`No navigation configuration found for context: ${e}`),[])}function Hh(e){let t,n=e[2]==="live"?"Live Definition":"Alternative Definition",i,r,o,s,l,a,u,c,p,d,h,m=e[0].text+"",v,I,y,b,x,R,A,S,D,F,q,U,$,V,j,T,C,M,O,k,G,Y,K,ne,pe,_e,we,me,ve,Me,Oe,Ve,Bt,ze,tn,Ue,It,$e,Ce,at,lt,ut,ft,Ze=(e[0].positiveVotes||0)+"",St,Ke,Pe,ct,ht,dt,gt,Qe=(e[0].negativeVotes||0)+"",Mt,ke,Ge,nn,We,rn,Be,Dt,Je,Le,pt,_t,kt,nt,Ct,Pt,De,ye,on,Yt=Ti(e[0].createdBy,null,!1)+"",Q,fe,Rt,it,be,bn,kn;return it=new Pi({props:{mode:"collapse",y:e[18]}}),it.$on("click",e[10]),{c(){t=E("text"),i=P(n),o=de(),s=E("g"),l=E("foreignObject"),a=ee("div"),u=ee("span"),c=P(e[1]),p=P(":"),d=de(),h=ee("span"),v=P(m),y=de(),b=E("g"),x=E("text"),R=P(`Please vote on whether you agree with this definition 
            `),A=E("text"),S=P(`for this word within the context of ProjectZer0.
            `),D=E("text"),F=P("You can always change your vote using the buttons below."),q=de(),U=E("g"),$=E("foreignObject"),V=ee("div"),j=ee("button"),T=P("Agree"),C=de(),M=E("foreignObject"),O=ee("div"),k=ee("button"),G=P("No Vote"),Y=de(),K=E("foreignObject"),ne=ee("div"),pe=ee("button"),_e=P("Disagree"),we=de(),me=E("g"),ve=E("text"),Me=P(`Vote Data:
    `),Oe=E("g"),Ve=E("text"),Bt=P(e[8]),ze=E("text"),tn=P(`=
        `),Ue=E("text"),It=P(e[4]),$e=E("g"),Ce=E("text"),at=P(`Total Agree
        `),lt=E("text"),ut=P(`=
        `),ft=E("text"),St=P(Ze),Ke=E("g"),Pe=E("text"),ct=P(`Total Disagree
        `),ht=E("text"),dt=P(`=
        `),gt=E("text"),Mt=P(Qe),ke=E("g"),Ge=E("text"),nn=P(`Net 
        `),We=E("text"),rn=P(`=
        `),Be=E("text"),Dt=P(e[5]),Je=E("g"),Le=E("text"),pt=P(`Definition Status
        `),_t=E("text"),kt=P(`=
        `),nt=E("text"),Ct=P(e[6]),Pt=de(),De=E("g"),ye=E("text"),on=P("defined by: "),Q=P(Yt),Rt=de(),se(it.$$.fragment),this.h()},l(J){t=N(J,"text",{y:!0,class:!0});var oe=w(t);i=L(oe,n),oe.forEach(g),o=ge(J),s=N(J,"g",{class:!0,transform:!0});var Xt=w(s);l=N(Xt,"foreignObject",{x:!0,width:!0,height:!0});var En=w(l);a=te(En,"DIV",{class:!0});var sn=w(a);u=te(sn,"SPAN",{class:!0});var Nn=w(u);c=L(Nn,e[1]),p=L(Nn,":"),Nn.forEach(g),d=ge(sn),h=te(sn,"SPAN",{class:!0});var In=w(h);v=L(In,m),In.forEach(g),sn.forEach(g),En.forEach(g),Xt.forEach(g),y=ge(J),b=N(J,"g",{transform:!0});var an=w(b);x=N(an,"text",{x:!0,class:!0});var Cn=w(x);R=L(Cn,`Please vote on whether you agree with this definition 
            `),Cn.forEach(g),A=N(an,"text",{x:!0,y:!0,class:!0});var Pn=w(A);S=L(Pn,`for this word within the context of ProjectZer0.
            `),Pn.forEach(g),D=N(an,"text",{x:!0,y:!0,class:!0});var Ln=w(D);F=L(Ln,"You can always change your vote using the buttons below."),Ln.forEach(g),an.forEach(g),q=ge(J),U=N(J,"g",{transform:!0});var rt=w(U);$=N(rt,"foreignObject",{x:!0,width:!0,height:!0});var Fn=w($);V=te(Fn,"DIV",{class:!0});var Ht=w(V);j=te(Ht,"BUTTON",{class:!0});var Vn=w(j);T=L(Vn,"Agree"),Vn.forEach(g),C=ge(Ht),Ht.forEach(g),Fn.forEach(g),M=N(rt,"foreignObject",{x:!0,width:!0,height:!0});var zn=w(M);O=te(zn,"DIV",{class:!0});var Sn=w(O);k=te(Sn,"BUTTON",{class:!0});var ln=w(k);G=L(ln,"No Vote"),ln.forEach(g),Y=ge(Sn),Sn.forEach(g),zn.forEach(g),K=N(rt,"foreignObject",{x:!0,width:!0,height:!0});var Un=w(K);ne=te(Un,"DIV",{class:!0});var Gn=w(ne);pe=te(Gn,"BUTTON",{class:!0});var Wn=w(pe);_e=L(Wn,"Disagree"),Wn.forEach(g),Gn.forEach(g),Un.forEach(g),rt.forEach(g),we=ge(J),me=N(J,"g",{transform:!0});var ot=w(me);ve=N(ot,"text",{x:!0,class:!0});var Bn=w(ve);Me=L(Bn,`Vote Data:
    `),Bn.forEach(g),Oe=N(ot,"g",{transform:!0});var un=w(Oe);Ve=N(un,"text",{x:!0,class:!0});var Yn=w(Ve);Bt=L(Yn,e[8]),Yn.forEach(g),ze=N(un,"text",{x:!0,class:!0});var fn=w(ze);tn=L(fn,`=
        `),fn.forEach(g),Ue=N(un,"text",{x:!0,class:!0});var Xn=w(Ue);It=L(Xn,e[4]),Xn.forEach(g),un.forEach(g),$e=N(ot,"g",{transform:!0});var cn=w($e);Ce=N(cn,"text",{x:!0,class:!0});var Hn=w(Ce);at=L(Hn,`Total Agree
        `),Hn.forEach(g),lt=N(cn,"text",{x:!0,class:!0});var hn=w(lt);ut=L(hn,`=
        `),hn.forEach(g),ft=N(cn,"text",{x:!0,class:!0});var jn=w(ft);St=L(jn,Ze),jn.forEach(g),cn.forEach(g),Ke=N(ot,"g",{transform:!0});var dn=w(Ke);Pe=N(dn,"text",{x:!0,class:!0});var qn=w(Pe);ct=L(qn,`Total Disagree
        `),qn.forEach(g),ht=N(dn,"text",{x:!0,class:!0});var $n=w(ht);dt=L($n,`=
        `),$n.forEach(g),gt=N(dn,"text",{x:!0,class:!0});var Rn=w(gt);Mt=L(Rn,Qe),Rn.forEach(g),dn.forEach(g),ke=N(ot,"g",{transform:!0});var ui=w(ke);Ge=N(ui,"text",{x:!0,class:!0});var hr=w(Ge);nn=L(hr,`Net 
        `),hr.forEach(g),We=N(ui,"text",{x:!0,class:!0});var dr=w(We);rn=L(dr,`=
        `),dr.forEach(g),Be=N(ui,"text",{x:!0,class:!0});var gr=w(Be);Dt=L(gr,e[5]),gr.forEach(g),ui.forEach(g),Je=N(ot,"g",{transform:!0});var fi=w(Je);Le=N(fi,"text",{x:!0,class:!0});var pr=w(Le);pt=L(pr,`Definition Status
        `),pr.forEach(g),_t=N(fi,"text",{x:!0,class:!0});var _r=w(_t);kt=L(_r,`=
        `),_r.forEach(g),nt=N(fi,"text",{x:!0,class:!0});var mr=w(nt);Ct=L(mr,e[6]),mr.forEach(g),fi.forEach(g),ot.forEach(g),Pt=ge(J),De=N(J,"g",{transform:!0});var vr=w(De);ye=N(vr,"text",{class:!0});var Li=w(ye);on=L(Li,"defined by: "),Q=L(Li,Yt),Li.forEach(g),vr.forEach(g),Rt=ge(J),ae(it.$$.fragment,J),this.h()},h(){f(t,"y",r=-e[18]+40),f(t,"class","title svelte-iygazu"),re(t,"font-family",B.FONTS.title.family),re(t,"font-size",B.FONTS.title.size),re(t,"font-weight",B.FONTS.title.weight),f(u,"class","word-text"),f(h,"class","definition-text svelte-iygazu"),f(a,"class","definition-line"),f(l,"x",e[9].labelX),f(l,"width",Math.abs(e[9].labelX)*2),f(l,"height","100"),f(s,"class","definition-display"),f(s,"transform",I="translate(0, "+(-e[18]/2-40)+")"),f(x,"x",e[9].labelX),f(x,"class","context-text left-align svelte-iygazu"),f(A,"x",e[9].labelX),f(A,"y","25"),f(A,"class","context-text left-align svelte-iygazu"),f(D,"x",e[9].labelX),f(D,"y","60"),f(D,"class","context-text left-align svelte-iygazu"),f(b,"transform","translate(0, -100)"),f(j,"class","vote-button agree"),j.disabled=e[7],he(j,"active",e[4]==="agree"),f(V,"class","button-wrapper"),f($,"x",-160),f($,"width","100"),f($,"height","45"),f(k,"class","vote-button no-vote"),k.disabled=e[7],he(k,"active",e[4]==="none"),f(O,"class","button-wrapper"),f(M,"x",-50),f(M,"width","100"),f(M,"height","45"),f(pe,"class","vote-button disagree"),pe.disabled=e[7],he(pe,"active",e[4]==="disagree"),f(ne,"class","button-wrapper"),f(K,"x",60),f(K,"width","100"),f(K,"height","45"),f(U,"transform","translate(0, -10)"),f(ve,"x",e[9].labelX),f(ve,"class","stats-label left-align svelte-iygazu"),f(Ve,"x",e[9].labelX),f(Ve,"class","stats-text left-align svelte-iygazu"),f(ze,"x",e[9].equalsX),f(ze,"class","stats-text svelte-iygazu"),f(Ue,"x",e[9].valueX),f(Ue,"class","stats-value left-align svelte-iygazu"),f(Oe,"transform","translate(0, 30)"),f(Ce,"x",e[9].labelX),f(Ce,"class","stats-text left-align svelte-iygazu"),f(lt,"x",e[9].equalsX),f(lt,"class","stats-text svelte-iygazu"),f(ft,"x",e[9].valueX),f(ft,"class","stats-value left-align svelte-iygazu"),f($e,"transform","translate(0, 55)"),f(Pe,"x",e[9].labelX),f(Pe,"class","stats-text left-align svelte-iygazu"),f(ht,"x",e[9].equalsX),f(ht,"class","stats-text svelte-iygazu"),f(gt,"x",e[9].valueX),f(gt,"class","stats-value left-align svelte-iygazu"),f(Ke,"transform","translate(0, 80)"),f(Ge,"x",e[9].labelX),f(Ge,"class","stats-text left-align svelte-iygazu"),f(We,"x",e[9].equalsX),f(We,"class","stats-text svelte-iygazu"),f(Be,"x",e[9].valueX),f(Be,"class","stats-value left-align svelte-iygazu"),f(ke,"transform","translate(0, 105)"),f(Le,"x",e[9].labelX),f(Le,"class","stats-text left-align svelte-iygazu"),f(_t,"x",e[9].equalsX),f(_t,"class","stats-text svelte-iygazu"),f(nt,"x",e[9].valueX),f(nt,"class","stats-value left-align svelte-iygazu"),f(Je,"transform","translate(0, 130)"),f(me,"transform","translate(0, 60)"),f(ye,"class","creator-label svelte-iygazu"),f(De,"transform",fe="translate(0, "+(e[18]-55)+")")},m(J,oe){z(J,t,oe),_(t,i),z(J,o,oe),z(J,s,oe),_(s,l),_(l,a),_(a,u),_(u,c),_(u,p),_(a,d),_(a,h),_(h,v),z(J,y,oe),z(J,b,oe),_(b,x),_(x,R),_(b,A),_(A,S),_(b,D),_(D,F),z(J,q,oe),z(J,U,oe),_(U,$),_($,V),_(V,j),_(j,T),_(V,C),_(U,M),_(M,O),_(O,k),_(k,G),_(O,Y),_(U,K),_(K,ne),_(ne,pe),_(pe,_e),z(J,we,oe),z(J,me,oe),_(me,ve),_(ve,Me),_(me,Oe),_(Oe,Ve),_(Ve,Bt),_(Oe,ze),_(ze,tn),_(Oe,Ue),_(Ue,It),_(me,$e),_($e,Ce),_(Ce,at),_($e,lt),_(lt,ut),_($e,ft),_(ft,St),_(me,Ke),_(Ke,Pe),_(Pe,ct),_(Ke,ht),_(ht,dt),_(Ke,gt),_(gt,Mt),_(me,ke),_(ke,Ge),_(Ge,nn),_(ke,We),_(We,rn),_(ke,Be),_(Be,Dt),_(me,Je),_(Je,Le),_(Le,pt),_(Je,_t),_(_t,kt),_(Je,nt),_(nt,Ct),z(J,Pt,oe),z(J,De,oe),_(De,ye),_(ye,on),_(ye,Q),z(J,Rt,oe),le(it,J,oe),be=!0,bn||(kn=[Ee(j,"click",e[13]),Ee(k,"click",e[14]),Ee(pe,"click",e[15])],bn=!0)},p(J,oe){(!be||oe&4)&&n!==(n=J[2]==="live"?"Live Definition":"Alternative Definition")&&ce(i,n),(!be||oe&262144&&r!==(r=-J[18]+40))&&f(t,"y",r),(!be||oe&2)&&ce(c,J[1]),(!be||oe&1)&&m!==(m=J[0].text+"")&&ce(v,m),(!be||oe&262144&&I!==(I="translate(0, "+(-J[18]/2-40)+")"))&&f(s,"transform",I),(!be||oe&128)&&(j.disabled=J[7]),(!be||oe&16)&&he(j,"active",J[4]==="agree"),(!be||oe&128)&&(k.disabled=J[7]),(!be||oe&16)&&he(k,"active",J[4]==="none"),(!be||oe&128)&&(pe.disabled=J[7]),(!be||oe&16)&&he(pe,"active",J[4]==="disagree"),(!be||oe&256)&&ce(Bt,J[8]),(!be||oe&16)&&ce(It,J[4]),(!be||oe&1)&&Ze!==(Ze=(J[0].positiveVotes||0)+"")&&ce(St,Ze),(!be||oe&1)&&Qe!==(Qe=(J[0].negativeVotes||0)+"")&&ce(Mt,Qe),(!be||oe&32)&&ce(Dt,J[5]),(!be||oe&64)&&ce(Ct,J[6]),(!be||oe&1)&&Yt!==(Yt=Ti(J[0].createdBy,null,!1)+"")&&ce(Q,Yt),(!be||oe&262144&&fe!==(fe="translate(0, "+(J[18]-55)+")"))&&f(De,"transform",fe);const Xt={};oe&262144&&(Xt.y=J[18]),it.$set(Xt)},i(J){be||(X(it.$$.fragment,J),be=!0)},o(J){H(it.$$.fragment,J),be=!1},d(J){J&&(g(t),g(o),g(s),g(y),g(b),g(q),g(U),g(we),g(me),g(Pt),g(De),g(Rt)),ue(it,J),bn=!1,Wt(kn)}}}function jh(e){let t,n;return t=new ai({props:{style:e[3],$$slots:{default:[Hh,({radius:i})=>({18:i}),({radius:i})=>i?262144:0]},$$scope:{ctx:e}}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,[r]){const o={};r&8&&(o.style=i[3]),r&786935&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}const xo=3,qh=1e3;function jt(e){return e&&typeof e=="object"&&"low"in e?Number(e.low):Number(e||0)}function $h(e,t,n){let i;Ut(e,wn,A=>n(12,i=A));let{data:r}=t,{word:o}=t,{type:s}=t,{style:l}=t;const a={labelX:-200,equalsX:0,valueX:30};let u="none",c=!1,p,d,h;const m=tt();function v(){m("modeChange",{mode:"preview"})}async function I(A=0){if(i)try{console.log("[DefinitionDetail] Fetching vote status for definition:",r.id);const S=await Xe(`/definitions/${r.id}/vote`);if(!S)throw new Error("No response from vote status endpoint");console.log("[DefinitionDetail] Vote status response:",S),n(4,u=S.status||"none"),n(0,r.positiveVotes=jt(S.positiveVotes),r),n(0,r.negativeVotes=jt(S.negativeVotes),r),console.log("[DefinitionDetail] Updated vote status:",{userVoteStatus:u,positiveVotes:r.positiveVotes,negativeVotes:r.negativeVotes})}catch(S){console.error("[DefinitionDetail] Error fetching vote status:",S),A<xo&&(console.log(`[DefinitionDetail] Retrying vote status fetch (attempt ${A+1}/${xo})`),await new Promise(D=>setTimeout(D,qh)),await I(A+1))}}async function y(A){if(!i||c)return;n(7,c=!0);const S=u;try{if(console.log("[DefinitionDetail] Processing vote:",{definitionId:r.id,voteType:A,currentStatus:u}),n(4,u=A),A==="none"){const D=await Xe(`/definitions/${r.id}/vote/remove`,{method:"POST"});n(0,r.positiveVotes=jt(D.positiveVotes),r),n(0,r.negativeVotes=jt(D.negativeVotes),r),console.log("[DefinitionDetail] Vote removed:",D)}else{const D=await Xe(`/definitions/${r.id}/vote`,{method:"POST",body:JSON.stringify({isPositive:A==="agree"})});n(0,r.positiveVotes=jt(D.positiveVotes),r),n(0,r.negativeVotes=jt(D.negativeVotes),r),console.log("[DefinitionDetail] Vote recorded:",D)}}catch(D){console.error("[DefinitionDetail] Error processing vote:",D),n(4,u=S),await I()}finally{n(7,c=!1)}}en(async()=>{console.log("[DefinitionDetail] Mounting with definition:",r),n(0,r.positiveVotes=jt(r.positiveVotes),r),n(0,r.negativeVotes=jt(r.negativeVotes),r),await I()});const b=()=>y("agree"),x=()=>y("none"),R=()=>y("disagree");return e.$$set=A=>{"data"in A&&n(0,r=A.data),"word"in A&&n(1,o=A.word),"type"in A&&n(2,s=A.type),"style"in A&&n(3,l=A.style)},e.$$.update=()=>{e.$$.dirty&4096&&n(8,p=(i==null?void 0:i.preferred_username)||(i==null?void 0:i.name)||"Anonymous"),e.$$.dirty&1&&n(5,d=(r.positiveVotes||0)-(r.negativeVotes||0)),e.$$.dirty&32&&n(6,h=d>0?"agreed":d<0?"disagreed":"undecided"),e.$$.dirty&113&&console.log("[DefinitionDetail] Vote state updated:",{userVoteStatus:u,netVotes:d,definitionStatus:h,positiveVotes:r.positiveVotes,negativeVotes:r.negativeVotes})},[r,o,s,l,u,d,h,c,p,a,v,y,i,b,x,R]}class Zh extends Ie{constructor(t){super(),Se(this,t,$h,jh,Ne,{data:0,word:1,type:2,style:3})}}const Ao={explore:W.PRIMARY.BLUE,"create-node":W.PRIMARY.YELLOW,network:W.PRIMARY.PURPLE,creations:W.PRIMARY.GREEN,interactions:W.PRIMARY.TURQUOISE,"edit-profile":W.PRIMARY.ORANGE,logout:W.PRIMARY.RED,dashboard:W.PRIMARY.BLUE,"alternative-definitions":W.PRIMARY.PURPLE,"create-alternative":W.PRIMARY.PURPLE,discuss:W.PRIMARY.TURQUOISE};function Kh(e){return Ao[e]||Ao.explore}function To(e){let t,n,i;return{c(){t=E("line"),this.h()},l(r){t=N(r,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),w(t).forEach(g),this.h()},h(){f(t,"class","connection-line svelte-xtjlke"),f(t,"x1","0"),f(t,"y1","0"),f(t,"x2",n=-e[3]*.55),f(t,"y2",i=-e[4]*.55),f(t,"stroke",`${e[5]}50`),f(t,"stroke-width","1.5")},m(r,o){z(r,t,o)},p(r,o){o&8&&n!==(n=-r[3]*.55)&&f(t,"x2",n),o&16&&i!==(i=-r[4]*.55)&&f(t,"y2",i)},d(r){r&&g(t)}}}function Oo(e){let t,n=e[1].label+"",i;return{c(){t=E("text"),i=P(n),this.h()},l(r){t=N(r,"text",{class:!0,dy:!0});var o=w(t);i=L(o,n),o.forEach(g),this.h()},h(){f(t,"class","label svelte-xtjlke"),f(t,"dy","30"),re(t,"fill",e[5])},m(r,o){z(r,t,o),_(t,i)},p(r,o){o&2&&n!==(n=r[1].label+"")&&ce(i,n)},d(r){r&&g(t)}}}function Qh(e){let t,n,i,r,o,s,l,a,u,c,p,d,h,m,v,I,y,b,x,R,A=e[1].icon+"",S,D,F,q,U=e[0]&&To(e),$=[{class:"icon-wrapper"},{xmlns:"http://www.w3.org/1999/xhtml"}],V={};for(let T=0;T<$.length;T+=1)V=Mo(V,$[T]);let j=e[0]&&Oo(e);return{c(){t=E("g"),n=E("defs"),i=E("filter"),r=E("feGaussianBlur"),o=E("feFlood"),s=E("feComposite"),l=E("feGaussianBlur"),a=E("feFlood"),u=E("feComposite"),c=E("feGaussianBlur"),p=E("feFlood"),d=E("feComposite"),h=E("feMerge"),m=E("feMergeNode"),v=E("feMergeNode"),I=E("feMergeNode"),y=E("feMergeNode"),U&&U.c(),b=E("foreignObject"),x=ee("div"),R=ee("span"),S=P(A),D=de(),j&&j.c(),this.h()},l(T){t=N(T,"g",{class:!0,transform:!0});var C=w(t);n=N(C,"defs",{});var M=w(n);i=N(M,"filter",{id:!0,x:!0,y:!0,width:!0,height:!0});var O=w(i);r=N(O,"feGaussianBlur",{in:!0,stdDeviation:!0,result:!0}),w(r).forEach(g),o=N(O,"feFlood",{"flood-color":!0,"flood-opacity":!0,result:!0}),w(o).forEach(g),s=N(O,"feComposite",{in:!0,in2:!0,operator:!0,result:!0}),w(s).forEach(g),l=N(O,"feGaussianBlur",{in:!0,stdDeviation:!0,result:!0}),w(l).forEach(g),a=N(O,"feFlood",{"flood-color":!0,"flood-opacity":!0,result:!0}),w(a).forEach(g),u=N(O,"feComposite",{in:!0,in2:!0,operator:!0,result:!0}),w(u).forEach(g),c=N(O,"feGaussianBlur",{in:!0,stdDeviation:!0,result:!0}),w(c).forEach(g),p=N(O,"feFlood",{"flood-color":!0,"flood-opacity":!0,result:!0}),w(p).forEach(g),d=N(O,"feComposite",{in:!0,in2:!0,operator:!0,result:!0}),w(d).forEach(g),h=N(O,"feMerge",{});var k=w(h);m=N(k,"feMergeNode",{in:!0}),w(m).forEach(g),v=N(k,"feMergeNode",{in:!0}),w(v).forEach(g),I=N(k,"feMergeNode",{in:!0}),w(I).forEach(g),y=N(k,"feMergeNode",{in:!0}),w(y).forEach(g),k.forEach(g),O.forEach(g),M.forEach(g),U&&U.l(C),b=N(C,"foreignObject",{x:!0,y:!0,width:!0,height:!0,class:!0});var G=w(b);x=te(G,"DIV",{class:!0});var Y=w(x);R=te(Y,"SPAN",{class:!0});var K=w(R);S=L(K,A),K.forEach(g),D=ge(Y),Y.forEach(g),G.forEach(g),j&&j.l(C),C.forEach(g),this.h()},h(){f(r,"in","SourceAlpha"),f(r,"stdDeviation","18"),f(r,"result","blur1"),f(o,"flood-color",e[5]),f(o,"flood-opacity","0.6"),f(o,"result","color1"),f(s,"in","color1"),f(s,"in2","blur1"),f(s,"operator","in"),f(s,"result","shadow1"),f(l,"in","SourceAlpha"),f(l,"stdDeviation","10"),f(l,"result","blur2"),f(a,"flood-color",e[5]),f(a,"flood-opacity","0.8"),f(a,"result","color2"),f(u,"in","color2"),f(u,"in2","blur2"),f(u,"operator","in"),f(u,"result","shadow2"),f(c,"in","SourceAlpha"),f(c,"stdDeviation","6"),f(c,"result","blur3"),f(p,"flood-color",e[5]),f(p,"flood-opacity","1"),f(p,"result","color3"),f(d,"in","color3"),f(d,"in2","blur3"),f(d,"operator","in"),f(d,"result","shadow3"),f(m,"in","shadow1"),f(v,"in","shadow2"),f(I,"in","shadow3"),f(y,"in","SourceGraphic"),f(i,"id",e[6]),f(i,"x","-100%"),f(i,"y","-100%"),f(i,"width","300%"),f(i,"height","300%"),f(R,"class","material-symbols-outlined"),re(R,"color",e[0]?e[5]:"white"),Is(x,V),he(x,"svelte-xtjlke",!0),f(b,"x","-16"),f(b,"y","-16"),f(b,"width","32"),f(b,"height","32"),f(b,"class","icon-container svelte-xtjlke"),re(b,"filter",e[0]?`url(#${e[6]})`:"none"),f(t,"class","navigation-node svelte-xtjlke"),f(t,"transform",e[2])},m(T,C){z(T,t,C),_(t,n),_(n,i),_(i,r),_(i,o),_(i,s),_(i,l),_(i,a),_(i,u),_(i,c),_(i,p),_(i,d),_(i,h),_(h,m),_(h,v),_(h,I),_(h,y),U&&U.m(t,null),_(t,b),_(b,x),_(x,R),_(R,S),_(x,D),j&&j.m(t,null),F||(q=[Ee(t,"mouseenter",e[8]),Ee(t,"mouseleave",e[9]),Ee(t,"click",e[7])],F=!0)},p(T,[C]){T[0]?U?U.p(T,C):(U=To(T),U.c(),U.m(t,b)):U&&(U.d(1),U=null),C&2&&A!==(A=T[1].icon+"")&&ce(S,A),C&1&&re(R,"color",T[0]?T[5]:"white"),he(x,"svelte-xtjlke",!0),C&1&&re(b,"filter",T[0]?`url(#${T[6]})`:"none"),T[0]?j?j.p(T,C):(j=Oo(T),j.c(),j.m(t,null)):j&&(j.d(1),j=null),C&4&&f(t,"transform",T[2])},i:xe,o:xe,d(T){T&&g(t),U&&U.d(),j&&j.d(),F=!1,Wt(q)}}}function Jh(e,t,n){const i=tt();let{option:r}=t,{transform:o}=t,{isHovered:s=!1}=t;const l=Kh(r.id),a=`nav-glow-${Math.random().toString(36).slice(2)}`;let u=[],c=0,p=0;function d(){Yh(r.id)}function h(){i("hover",{isHovered:!0}),n(0,s=!0)}function m(){i("hover",{isHovered:!1}),n(0,s=!1)}return e.$$set=v=>{"option"in v&&n(1,r=v.option),"transform"in v&&n(2,o=v.transform),"isHovered"in v&&n(0,s=v.isHovered)},e.$$.update=()=>{if(e.$$.dirty&1028){const v=o.match(/translate\(([-\d.e+-]+),\s*([-\d.e+-]+)\)/);v?(n(10,u=[parseFloat(v[1]),parseFloat(v[2])]),n(3,[c,p]=u,c,(n(4,p),n(2,o),n(10,u)))):(n(10,u=[0,0]),n(3,[c,p]=u,c,(n(4,p),n(2,o),n(10,u))))}},[s,r,o,c,p,l,a,d,h,m,u]}class ed extends Ie{constructor(t){super(),Se(this,t,Jh,Qh,Ne,{option:1,transform:2,isHovered:0})}}const td=e=>e.type==="dashboard",nd=e=>e.type==="edit-profile",id=e=>e.type==="create-node",rd=e=>e.type==="navigation",od=e=>e.type==="word",sd=e=>e.type==="definition";function ad(e){let t,n,i={data:e[0],isPreviewMode:e[8],viewType:e[9],$$slots:{default:[Ed,({node:r,transform:o})=>({32:r,33:o}),({node:r,transform:o})=>[0,(r?2:0)|(o?4:0)]]},$$scope:{ctx:e}};return t=new tc({props:i}),e[27](t),t.$on("modeChange",e[28]),{c(){se(t.$$.fragment)},l(r){ae(t.$$.fragment,r)},m(r,o){le(t,r,o),n=!0},p(r,o){const s={};o[0]&1&&(s.data=r[0]),o[0]&256&&(s.isPreviewMode=r[8]),o[0]&512&&(s.viewType=r[9]),o[0]&170|o[1]&14&&(s.$$scope={dirty:o,ctx:r}),t.$set(s)},i(r){n||(X(t.$$.fragment,r),n=!0)},o(r){H(t.$$.fragment,r),n=!1},d(r){e[27](null),ue(t,r)}}}function ld(e){let t,n='<div class="loading-text svelte-1nfodeq">Authentication required</div>';return{c(){t=ee("div"),t.innerHTML=n,this.h()},l(i){t=te(i,"DIV",{class:!0,"data-svelte-h":!0}),yt(t)!=="svelte-1ixvscs"&&(t.innerHTML=n),this.h()},h(){f(t,"class","loading-container svelte-1nfodeq")},m(i,r){z(i,t,r)},p:xe,i:xe,o:xe,d(i){i&&g(t)}}}function ud(e){let t,n='<div class="loading-spinner svelte-1nfodeq"></div> <span class="loading-text svelte-1nfodeq">Initializing...</span>';return{c(){t=ee("div"),t.innerHTML=n,this.h()},l(i){t=te(i,"DIV",{class:!0,"data-svelte-h":!0}),yt(t)!=="svelte-9xy0vl"&&(t.innerHTML=n),this.h()},h(){f(t,"class","loading-container svelte-1nfodeq")},m(i,r){z(i,t,r)},p:xe,i:xe,o:xe,d(i){i&&g(t)}}}function fd(e){let t,n,i,r,o;const s=[md,_d],l=[];function a(u,c){return c[0]&128|c[1]&2&&(t=null),t==null&&(t=u[7].get(u[32].id)==="detail"),t?0:1}return n=a(e,[-1,-1]),i=l[n]=s[n](e),{c(){i.c(),r=Te()},l(u){i.l(u),r=Te()},m(u,c){l[n].m(u,c),z(u,r,c),o=!0},p(u,c){let p=n;n=a(u,c),n===p?l[n].p(u,c):(bt(),H(l[p],1,1,()=>{l[p]=null}),Et(),i=l[n],i?i.p(u,c):(i=l[n]=s[n](u),i.c()),X(i,1),i.m(r.parentNode,r))},i(u){o||(X(i),o=!0)},o(u){H(i),o=!1},d(u){u&&g(r),l[n].d(u)}}}function cd(e){let t,n,i,r;const o=[wd,vd],s=[];function l(a,u){return a[32].group==="central"?0:1}return t=l(e),n=s[t]=o[t](e),{c(){n.c(),i=Te()},l(a){n.l(a),i=Te()},m(a,u){s[t].m(a,u),z(a,i,u),r=!0},p(a,u){let c=t;t=l(a),t===c?s[t].p(a,u):(bt(),H(s[c],1,1,()=>{s[c]=null}),Et(),n=s[t],n?n.p(a,u):(n=s[t]=o[t](a),n.c()),X(n,1),n.m(i.parentNode,i))},i(a){r||(X(n),r=!0)},o(a){H(n),r=!1},d(a){a&&g(i),s[t].d(a)}}}function hd(e){let t,n;return t=new ed({props:{option:e[32].data,transform:e[33].toString()}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,r){const o={};r[1]&2&&(o.option=i[32].data),r[1]&4&&(o.transform=i[33].toString()),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function dd(e){let t,n;return t=new uh({props:{node:e[32].data}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,r){const o={};r[1]&2&&(o.node=i[32].data),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function gd(e){let t,n;return t=new Dc({props:{node:e[32].data}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,r){const o={};r[1]&2&&(o.node=i[32].data),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function pd(e){let t,n;return t=new dc({props:{node:e[32].data,userActivity:e[5]}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,r){const o={};r[1]&2&&(o.node=i[32].data),r[0]&32&&(o.userActivity=i[5]),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function _d(e){let t,n;function i(...r){return e[26](e[32],...r)}return t=new Uh({props:{word:e[1].word,definition:e[32].data,type:e[32].group==="live-definition"?"live":"alternative",style:e[32].group==="live-definition"?e[11]:e[12],transform:e[33].toString()}}),t.$on("modeChange",i),{c(){se(t.$$.fragment)},l(r){ae(t.$$.fragment,r)},m(r,o){le(t,r,o),n=!0},p(r,o){e=r;const s={};o[0]&2&&(s.word=e[1].word),o[1]&2&&(s.definition=e[32].data),o[1]&2&&(s.type=e[32].group==="live-definition"?"live":"alternative"),o[1]&2&&(s.style=e[32].group==="live-definition"?e[11]:e[12]),o[1]&4&&(s.transform=e[33].toString()),t.$set(s)},i(r){n||(X(t.$$.fragment,r),n=!0)},o(r){H(t.$$.fragment,r),n=!1},d(r){ue(t,r)}}}function md(e){let t,n;function i(...r){return e[25](e[32],...r)}return t=new Zh({props:{word:e[1].word,data:e[32].data,type:e[32].group==="live-definition"?"live":"alternative",style:e[32].group==="live-definition"?e[11]:e[12]}}),t.$on("modeChange",i),{c(){se(t.$$.fragment)},l(r){ae(t.$$.fragment,r)},m(r,o){le(t,r,o),n=!0},p(r,o){e=r;const s={};o[0]&2&&(s.word=e[1].word),o[1]&2&&(s.data=e[32].data),o[1]&2&&(s.type=e[32].group==="live-definition"?"live":"alternative"),o[1]&2&&(s.style=e[32].group==="live-definition"?e[11]:e[12]),t.$set(s)},i(r){n||(X(t.$$.fragment,r),n=!0)},o(r){H(t.$$.fragment,r),n=!1},d(r){ue(t,r)}}}function vd(e){let t,n;return t=new ds({props:{data:e[32].data,style:e[10],transform:e[33].toString()}}),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,r){const o={};r[1]&2&&(o.data=i[32].data),r[1]&4&&(o.transform=i[33].toString()),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function wd(e){let t,n,i,r;const o=[bd,yd],s=[];function l(a,u){return a[3]==="preview"?0:1}return t=l(e),n=s[t]=o[t](e),{c(){n.c(),i=Te()},l(a){n.l(a),i=Te()},m(a,u){s[t].m(a,u),z(a,i,u),r=!0},p(a,u){let c=t;t=l(a),t===c?s[t].p(a,u):(bt(),H(s[c],1,1,()=>{s[c]=null}),Et(),n=s[t],n?n.p(a,u):(n=s[t]=o[t](a),n.c()),X(n,1),n.m(i.parentNode,i))},i(a){r||(X(n),r=!0)},o(a){H(n),r=!1},d(a){a&&g(i),s[t].d(a)}}}function yd(e){let t,n;return t=new Dh({props:{data:e[32].data,style:e[10]}}),t.$on("modeChange",e[13]),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,r){const o={};r[1]&2&&(o.data=i[32].data),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function bd(e){let t,n;return t=new ds({props:{data:e[32].data,style:e[10],transform:e[33].toString()}}),t.$on("modeChange",e[13]),{c(){se(t.$$.fragment)},l(i){ae(t.$$.fragment,i)},m(i,r){le(t,i,r),n=!0},p(i,r){const o={};r[1]&2&&(o.data=i[32].data),r[1]&4&&(o.transform=i[33].toString()),t.$set(o)},i(i){n||(X(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){ue(t,i)}}}function Ed(e){let t,n,i,r,o,s,l,a,u,c;const p=[pd,gd,dd,hd,cd,fd],d=[];function h(m,v){return v[1]&2&&(t=null),v[1]&2&&(n=null),v[1]&2&&(i=null),v[1]&2&&(r=null),v[1]&2&&(o=null),v[0]&2|v[1]&2&&(s=null),t==null&&(t=!!td(m[32])),t?0:(n==null&&(n=!!nd(m[32])),n?1:(i==null&&(i=!!id(m[32])),i?2:(r==null&&(r=!!rd(m[32])),r?3:(o==null&&(o=!!od(m[32])),o?4:(s==null&&(s=!!(sd(m[32])&&m[1])),s?5:-1)))))}return~(l=h(e,[-1,-1]))&&(a=d[l]=p[l](e)),{c(){a&&a.c(),u=Te()},l(m){a&&a.l(m),u=Te()},m(m,v){~l&&d[l].m(m,v),z(m,u,v),c=!0},p(m,v){let I=l;l=h(m,v),l===I?~l&&d[l].p(m,v):(a&&(bt(),H(d[I],1,1,()=>{d[I]=null}),Et()),~l?(a=d[l],a?a.p(m,v):(a=d[l]=p[l](m),a.c()),X(a,1),a.m(u.parentNode,u)):a=null)},i(m){c||(X(a),c=!0)},o(m){H(a),c=!1},d(m){m&&g(u),~l&&d[l].d(m)}}}function Nd(e){let t,n,i,r;const o=[ud,ld,ad],s=[];function l(a,u){return a[2]?a[4]?2:1:0}return t=l(e),n=s[t]=o[t](e),{c(){n.c(),i=Te()},l(a){n.l(a),i=Te()},m(a,u){s[t].m(a,u),z(a,i,u),r=!0},p(a,u){let c=t;t=l(a),t===c?s[t].p(a,u):(bt(),H(s[c],1,1,()=>{s[c]=null}),Et(),n=s[t],n?n.p(a,u):(n=s[t]=o[t](a),n.c()),X(n,1),n.m(i.parentNode,i))},i(a){r||(X(n),r=!0)},o(a){H(n),r=!1},d(a){a&&g(i),s[t].d(a)}}}function Id(e,t,n){let i,r,o,s,l,a,u,c,p,d,h,m,v,I;Ut(e,wn,O=>n(4,m=O)),Ut(e,ri,O=>n(23,v=O)),Ut(e,Rs,O=>n(24,I=O));let{data:y}=t,b=!1,x=!1,R,A,S=new Map;const D={previewSize:B.SIZES.WORD.preview,detailSize:B.SIZES.WORD.detail,colors:B.COLORS.WORD,padding:B.PADDING,lineHeight:B.LINE_HEIGHT,stroke:B.STROKE,highlightColor:W.PRIMARY.BLUE},F={previewSize:B.SIZES.DEFINITION.live.preview,detailSize:B.SIZES.DEFINITION.live.detail,colors:B.COLORS.DEFINITION.live,padding:B.PADDING,lineHeight:B.LINE_HEIGHT,stroke:B.STROKE,highlightColor:W.PRIMARY.BLUE},q={previewSize:B.SIZES.DEFINITION.alternative.preview,detailSize:B.SIZES.DEFINITION.alternative.detail,colors:B.COLORS.DEFINITION.alternative,padding:B.PADDING,lineHeight:B.LINE_HEIGHT,stroke:B.STROKE,highlightColor:W.PRIMARY.PURPLE};async function U(){console.log("Starting initializeData");try{await ws();const O=await ys();if(console.log("Auth check complete:",{hasUser:!!O}),!O){console.log("No user found, redirecting to login"),wr();return}if(n(16,b=!0),wn.set(O),n(5,R=await Fs()),s==="word"){const k=new URL(window.location.href).searchParams.get("word");if(k){const G=await Lo(k);G&&ri.set(G)}}n(17,x=!0),console.log("Data initialization complete",{hasUser:!!O,hasActivity:!!R,view:s})}catch(O){console.error("Error in initializeData:",O),wr()}}en(U);function $(O){console.log("Word node mode change:",O.detail),n(3,r=O.detail.mode)}function V(O,k){console.log("Definition mode change:",{nodeId:k,newMode:O.detail.mode}),S.set(k,O.detail.mode),n(7,S=new Map(S))}const j=(O,k)=>V(k,O.id),T=(O,k)=>V(k,O.id);function C(O){st[O?"unshift":"push"](()=>{A=O,n(6,A)})}function M(O){Ss.call(this,e,O)}return e.$$set=O=>{"data"in O&&n(15,y=O.data)},e.$$.update=()=>{e.$$.dirty[0]&16777216&&n(19,s=I.params.view),e.$$.dirty[0]&524288&&n(9,i=s),e.$$.dirty[0]&753680&&console.log("Auth State:",{authInitialized:b,dataInitialized:x,hasUser:!!m,view:s,data:y}),e.$$.dirty[0]&16777216&&n(3,r=I&&I.params.view==="word"?"detail":"preview"),e.$$.dirty[0]&524296&&n(8,o=s==="alternative-definitions"||s==="word"?r==="preview":!1),e.$$.dirty[0]&524288&&n(22,l=s==="word"||s==="alternative-definitions"),e.$$.dirty[0]&12582912&&n(1,a=l?v:null),e.$$.dirty[0]&196608&&n(2,u=b&&x),e.$$.dirty[0]&4718614&&n(18,c=u&&m&&(l&&a?{id:a.id,type:"word",data:a,group:"central"}:{id:m.sub,type:s,data:m,group:"central"})),e.$$.dirty[0]&4718592&&n(21,p=s==="dashboard"?Vt.DASHBOARD:s==="create-node"?Vt.CREATE_NODE:l?Vt.WORD:Vt.EDIT_PROFILE),e.$$.dirty[0]&2097152&&n(20,d=Xh(p).map(O=>({id:O.id,type:"navigation",data:O,group:"navigation"}))),e.$$.dirty[0]&1835010&&n(0,h=c?(()=>{const O=[c,...d];if(a&&a.definitions.length>0){const k=[...a.definitions].sort((G,Y)=>Wi(Y)-Wi(G));if(s==="word"){const G=k.map((K,ne)=>({id:K.id,type:"definition",data:K,group:ne===0?"live-definition":"alternative-definition"})),Y=k.map((K,ne)=>({source:c.id,target:K.id,type:ne===0?"live":"alternative",value:1+Math.abs(Wi(K))}));return{nodes:[...O,...G],links:Y}}}return{nodes:O,links:[]}})():{nodes:[],links:[]}),e.$$.dirty[0]&1&&h.nodes,e.$$.dirty[0]&1&&h.links},[h,a,u,r,m,R,A,S,o,i,D,F,q,$,V,y,b,x,c,s,d,p,l,v,I,j,T,C,M]}class kd extends Ie{constructor(t){super(),Se(this,t,Id,Nd,Ne,{data:15},null,[-1,-1])}}export{kd as component,Dd as universal};
